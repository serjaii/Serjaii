<!doctype html><html lang=es dir=ltr><head><meta charset=utf-8><meta name=viewport content='width=device-width,initial-scale=1'><meta name=description content="Guía Cooperativa de Instalación y Configuración de Bases de Datos Este documento recoge el trabajo realizado para la puesta en marcha de diversos sistemas gestores de bases de datos en Debian 13. A continuación se detallan los pasos para cada uno de ellos.\nEsta práctica ha sido realizada por los alumnos Sergio Jiménez, José María Oteo y David Dorante.\nInstalación de Oracle 21c sobre Debian 13 1.Configuración previa y dependencias En primer lugar actualizaremos los paquetes del sistema, para evitar posibles conflictos de distintas versiones de paquetes durante la instalación de las dependencias de Oracle. serjaii@db:~$ sudo apt update && sudo apt upgrade -y Instalamos las dependencias de Oracle en nuestro sistema. serjaii@db:~$ sudo apt policy libaio1t64 libaio-dev unixodbc rlwrap alien net-tools unzip bc ksh Usaje de cada dependencia\n"><title>Práctica Cooperativa: Despliegue Completo de Motores de Base de Datos</title><link rel=canonical href=http://sergiojimenez.org/post/practica-cooperativa-instalaciones/><link rel=stylesheet href=/scss/style.min.b0e76e98cdd4f7082d1fc36f7af7e0843a81201db2197c03ca426751dc923735.css><meta property='og:title' content="Práctica Cooperativa: Despliegue Completo de Motores de Base de Datos"><meta property='og:description' content="Guía Cooperativa de Instalación y Configuración de Bases de Datos Este documento recoge el trabajo realizado para la puesta en marcha de diversos sistemas gestores de bases de datos en Debian 13. A continuación se detallan los pasos para cada uno de ellos.\nEsta práctica ha sido realizada por los alumnos Sergio Jiménez, José María Oteo y David Dorante.\nInstalación de Oracle 21c sobre Debian 13 1.Configuración previa y dependencias En primer lugar actualizaremos los paquetes del sistema, para evitar posibles conflictos de distintas versiones de paquetes durante la instalación de las dependencias de Oracle. serjaii@db:~$ sudo apt update && sudo apt upgrade -y Instalamos las dependencias de Oracle en nuestro sistema. serjaii@db:~$ sudo apt policy libaio1t64 libaio-dev unixodbc rlwrap alien net-tools unzip bc ksh Usaje de cada dependencia\n"><meta property='og:url' content='http://sergiojimenez.org/post/practica-cooperativa-instalaciones/'><meta property='og:site_name' content='SerjAii'><meta property='og:type' content='article'><meta property='article:section' content='Post'><meta property='article:tag' content='oracle'><meta property='article:tag' content='mysql'><meta property='article:tag' content='postgresql'><meta property='article:tag' content='mongodb'><meta property='article:tag' content='neo4j'><meta property='article:tag' content='redis'><meta property='article:tag' content='cassandra'><meta property='article:tag' content='memcached'><meta property='article:tag' content='couchdb'><meta property='article:published_time' content='2025-12-09T00:00:00+00:00'><meta property='article:modified_time' content='2025-12-09T00:00:00+00:00'><meta property='og:image' content='http://sergiojimenez.org/post/practica-cooperativa-instalaciones/cover.png'><meta name=twitter:title content="Práctica Cooperativa: Despliegue Completo de Motores de Base de Datos"><meta name=twitter:description content="Guía Cooperativa de Instalación y Configuración de Bases de Datos Este documento recoge el trabajo realizado para la puesta en marcha de diversos sistemas gestores de bases de datos en Debian 13. A continuación se detallan los pasos para cada uno de ellos.\nEsta práctica ha sido realizada por los alumnos Sergio Jiménez, José María Oteo y David Dorante.\nInstalación de Oracle 21c sobre Debian 13 1.Configuración previa y dependencias En primer lugar actualizaremos los paquetes del sistema, para evitar posibles conflictos de distintas versiones de paquetes durante la instalación de las dependencias de Oracle. serjaii@db:~$ sudo apt update && sudo apt upgrade -y Instalamos las dependencias de Oracle en nuestro sistema. serjaii@db:~$ sudo apt policy libaio1t64 libaio-dev unixodbc rlwrap alien net-tools unzip bc ksh Usaje de cada dependencia\n"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content='http://sergiojimenez.org/post/practica-cooperativa-instalaciones/cover.png'><link rel="shortcut icon" href=/img/mi-logo.jpg></head><body class=article-page><script>(function(){const e="StackColorScheme";localStorage.getItem(e)||localStorage.setItem(e,"auto")})()</script><script>(function(){const t="StackColorScheme",e=localStorage.getItem(t),n=window.matchMedia("(prefers-color-scheme: dark)").matches===!0;e=="dark"||e==="auto"&&n?document.documentElement.dataset.scheme="dark":document.documentElement.dataset.scheme="light"})()</script><div class="container main-container flex on-phone--column extended"><aside class="sidebar left-sidebar sticky"><button class="hamburger hamburger--spin" type=button id=toggle-menu aria-label="Ocultar menú">
<span class=hamburger-box><span class=hamburger-inner></span></span></button><header><figure class=site-avatar><a href=/><img src=/img/mi-logo_hu_f9e78d550823d191.jpg width=300 height=300 class=site-logo loading=lazy alt=Avatar></a></figure><div class=site-meta><h1 class=site-name><a href=/>SerjAii</a></h1><h2 class=site-description>Sys and Network Admin</h2></div></header><ol class=menu id=main-menu><li><a href=/><svg class="icon icon-tabler icon-tabler-home" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><polyline points="5 12 3 12 12 3 21 12 19 12"/><path d="M5 12v7a2 2 0 002 2h10a2 2 0 002-2v-7"/><path d="M9 21v-6a2 2 0 012-2h2a2 2 0 012 2v6"/></svg>
<span>Inicio</span></a></li><li><a href=/about/><svg class="icon icon-tabler icon-tabler-user" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="12" cy="7" r="4"/><path d="M6 21v-2a4 4 0 014-4h4a4 4 0 014 4v2"/></svg>
<span>Sobre Mí</span></a></li><li><a href=/proyectos/><svg class="icon icon-tabler icon-tabler-archive" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><rect x="3" y="4" width="18" height="4" rx="2"/><path d="M5 8v10a2 2 0 002 2h10a2 2 0 002-2V8"/><line x1="10" y1="12" x2="14" y2="12"/></svg>
<span>Proyectos</span></a></li><li><a href=/search/><svg class="icon icon-tabler icon-tabler-search" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="10" cy="10" r="7"/><line x1="21" y1="21" x2="15" y2="15"/></svg>
<span>Buscar</span></a></li><li class=menu-bottom-section><ol class=menu><li id=i18n-switch><a href=/en/post/practica-cooperativa-instalaciones/ title=English><svg class="icon icon-tabler icon-tabler-language" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M4 5h7"/><path d="M9 3v2c0 4.418-2.239 8-5 8"/><path d="M5 9c-.003 2.144 2.952 3.908 6.7 4"/><path d="M12 20l4-9 4 9"/><path d="M19.1 18h-6.2"/></svg>
<span>EN</span></a></li><li id=dark-mode-toggle><svg class="icon icon-tabler icon-tabler-toggle-left" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="8" cy="12" r="2"/><rect x="2" y="6" width="20" height="12" rx="6"/></svg>
<svg class="icon icon-tabler icon-tabler-toggle-right" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="16" cy="12" r="2"/><rect x="2" y="6" width="20" height="12" rx="6"/></svg>
<span>Modo oscuro</span></li></ol></li></ol></aside><aside class="sidebar right-sidebar sticky"><section class="widget archives"><div class=widget-icon><svg class="icon icon-tabler icon-tabler-hash" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><line x1="5" y1="9" x2="19" y2="9"/><line x1="5" y1="15" x2="19" y2="15"/><line x1="11" y1="4" x2="7" y2="20"/><line x1="17" y1="4" x2="13" y2="20"/></svg></div><h2 class="widget-title section-title">Tabla de contenido</h2><div class=widget--toc><nav id=TableOfContents><ul><li><a href=#instalación-de-oracle-21c-sobre-debian-13>Instalación de Oracle 21c sobre Debian 13</a><ul><li><a href=#1configuración-previa-y-dependencias>1.Configuración previa y dependencias</a></li><li><a href=#2instalación-del-servidor>2.Instalación del servidor</a></li><li><a href=#3crear-usuario-y-conceder-permisos-en-oracle-21c>3.Crear usuario y conceder permisos en Oracle 21c.</a></li><li><a href=#4configuración-del-servidor-oracle-para-la-conexión-remota>4.Configuración del servidor Oracle para la conexión remota.</a></li><li><a href=#5instalación-y-configuración-del-cliente-de-oracle-sqlplus>5.Instalación y configuración del cliente de Oracle (SQL*Plus).</a></li><li><a href=#6creación-de-base-de-datos-con-tablas-y-datos-en-oracle>6.Creación de base de datos con tablas y datos en Oracle.</a></li></ul></li><li><a href=#instalación-servidor-postgresql-en-debian-13>Instalación Servidor PostgreSQL en Debian 13.</a><ul><li><a href=#1configuración-previa-y-dependencias-1>1.Configuración previa y dependencias</a></li><li><a href=#2instalación-del-servidor-1>2.Instalación del servidor</a></li><li><a href=#3configuración-del-servidor-postgresql-para-la-conexión>3.Configuración del servidor PostgreSQL para la conexión</a></li><li><a href=#4crear-base-de-datos-usuario-y-conceder-permisos-en>4.Crear base de datos, usuario y conceder permisos en</a></li><li><a href=#5instalación-y-configuración-del-cliente-de-postgresql>5.Instalación y configuración del cliente de PostgreSQL.</a></li><li><a href=#6creación-de-base-de-datos-con-tablas-y-datos-en-postgresql>6.Creación de base de datos con tablas y datos en PostgreSQL.</a></li></ul></li><li><a href=#instalación-servidor-mysql-en-debian-13>Instalación Servidor MySQL en Debian 13.</a><ul><li><a href=#1instalación-del-servidor>1.Instalación del servidor</a></li><li><a href=#2configuración-del-servidor-mysql-para-la-conexión-remota>2.Configuración del servidor MySQL para la conexión remota.</a></li><li><a href=#3crear-base-de-datos-de-prueba-usuario-y-conceder-permisos>3.Crear base de datos de prueba, usuario y conceder permisos</a></li><li><a href=#4instalación-y-configuración-del-cliente-de-mysql>4.Instalación y configuración del cliente de MySQL.</a></li><li><a href=#5creación-de-base-de-datos-con-tablas-y-datos-en-mysql>5.Creación de base de datos con tablas y datos en MySQL.</a></li></ul></li><li><a href=#instalación-servidor-mongodb-en-debian-13>Instalación Servidor MongoDB en Debian 13.</a><ul><li><a href=#1dependencias-y-configuración-previa>1.Dependencias y configuración previa</a></li><li><a href=#2instalación-del-servidor-2>2.Instalación del servidor</a></li><li><a href=#3configuración-del-servidor-mongodb-para-la-conexión>3.Configuración del servidor MongoDB para la conexión</a></li><li><a href=#4crear-base-de-datos-de-prueba-usuario-y-conceder-permisos>4.Crear base de datos de prueba, usuario y conceder permisos</a></li><li><a href=#5instalación-y-configuración-del-cliente-de-mongodb>5.Instalación y configuración del cliente de MongoDB.</a></li><li><a href=#6creación-de-usuario-base-de-datos-con-tablas-y-datos-en>6.Creación de usuario, base de datos con tablas y datos en</a></li></ul></li><li><a href=#instalación-servidor-neo4j-en-debian-13>Instalación Servidor Neo4J en Debian 13.</a><ul><li><a href=#1instalación-de-dependencias>1.Instalación de dependencias</a></li><li><a href=#2instalación-del-servidor-3>2.Instalación del servidor</a></li><li><a href=#3configuración-del-servidor-neo4j-en-debian-13-para-la>3.Configuración del Servidor Neo4J en Debian 13 para la</a></li><li><a href=#4instalación-y-configuración-del-cliente-de-neo4j-en-debian-13>4.Instalación y configuración del cliente de Neo4j en Debian 13.</a></li><li><a href=#5creación-de-usuario-base-de-datos-con-nodos-e-inserción-de>5.Creación de usuario, base de datos con nodos e inserción de</a></li></ul></li><li><a href=#instalación-servidor-redis-en-debian-13>Instalación Servidor Redis en Debian 13</a><ul><li><a href=#1dependencias-y-configuración-previa-1>1.Dependencias y configuración previa</a></li><li><a href=#2instalación-del-servidor-4>2.Instalación del servidor</a></li><li><a href=#3configuración-del-servidor-redis-para-acceso-remoto>3.Configuración del servidor Redis para acceso remoto</a></li><li><a href=#4configuración-del-cliente-redis-cli-para-acceso-remoto>4.Configuración del cliente Redis-cli para acceso remoto</a></li><li><a href=#5creación-de-usuariobase-de-datos-e-inserción-de-datos>5.Creación de usuario,base de datos e inserción de datos</a></li><li><a href=#6pruebas-de-funcionamiento>6.Pruebas de funcionamiento</a></li></ul></li><li><a href=#instalación-servidor-cassandra-en-debian-13>Instalación Servidor Cassandra en Debian 13</a><ul><li><a href=#1dependencias-y-configuración-previa-2>1.Dependencias y configuración previa</a></li><li><a href=#2instalación-del-servidor-5>2.Instalación del servidor</a></li><li><a href=#3configuración-del-servidor-cassandra-para-acceso-remoto>3.Configuración del servidor Cassandra para acceso remoto</a></li><li><a href=#4configuración-del-cliente-cassandra-para-acceso-remoto>4.Configuración del cliente Cassandra para acceso remoto</a></li><li><a href=#5funcionamiento-básico-de-cassandra>5.Funcionamiento básico de Cassandra</a></li></ul></li><li><a href=#aplicación-web-que-conecte-con-el-servidor>Aplicación Web que conecte con el servidor</a></li><li><a href=#aplicación-web-que-conecte-con-el-servidor-1>Aplicación Web que conecte con el servidor</a></li><li><a href=#aplicación-web-que-conecte-con-el-servidor-2>Aplicación Web que conecte con el servidor</a><ul><li><a href=#1cambios-realizados-sobre-mi-aplicación-web-para-hacerla>1.Cambios realizados sobre mi aplicación web para hacerla</a></li><li><a href=#2tipos-de-ataques-sql-injection-sobre-mi-aplicación-web>2.Tipos de ataques SQL Injection sobre mi aplicación web.</a></li><li><a href=#3cambios-realizados-para-que-mi-aplicación-no-sea-vulnerable>3.Cambios realizados para que mi aplicación no sea vulnerable.</a></li><li><a href=#1-reemplazar-todas-las-consultas-que-concatenan-directamente-valores-de-entrada>1. Reemplazar todas las consultas que concatenan directamente valores de entrada</a></li><li><a href=#2-usar-un-usuario-de-aplicación-app-user-con-permisos-mínimos-en-la-base-de>2. Usar un usuario de aplicación (app user) con permisos mínimos en la base de</a></li><li><a href=#3-quitar-consolelog-que-imprime-consultas-con-valores-sensibles-en-entornos>3. Quitar “console.log” que imprime consultas con valores sensibles en entornos</a></li><li><a href=#4comprobación-de-que-mi-aplicación-no-sea-vulnerable>4.Comprobación de que mi aplicación no sea vulnerable.</a></li></ul></li><li><a href=#instalación-servidor-memcached-en-debian-13>Instalación Servidor Memcached en Debian 13</a><ul><li><a href=#1instalación-de-paquetes>1.Instalación de Paquetes</a></li><li><a href=#2memcached-en-un-servidor-web>2.Memcached en un Servidor Web</a></li><li><a href=#3implementación-en-flask>3.Implementación en Flask</a></li><li><a href=#1instalación-de-dependencias-y-servidor-de-couchdb>1.Instalación de dependencias y servidor de CouchDB.</a></li><li><a href=#2-configuración-para-conexión-remota>2. Configuración para conexión remota.</a></li><li><a href=#3-instalación-del-cliente-de-couchdb>3. Instalación del Cliente de CouchDB.</a></li><li><a href=#4-uso-básico-de-couchdb>4. Uso básico de CouchDB.</a></li><li><a href=#5-funcionamiento-interno-de-couchdb>5. Funcionamiento interno de CouchDB.</a></li><li><a href=#1instalación-de-java-17>1.Instalación de Java 17</a></li><li><a href=#2descarga-sql-developer-desde-oracle>2.Descarga SQL Developer desde Oracle</a></li></ul></li></ul></nav></div></section></aside><main class="main full-width"><article class="has-image main-article"><header class=article-header><div class=article-image><a href=/post/practica-cooperativa-instalaciones/><img src=/post/practica-cooperativa-instalaciones/cover_hu_ba692d4f02ffb9d2.png srcset="/post/practica-cooperativa-instalaciones/cover_hu_ba692d4f02ffb9d2.png 800w, /post/practica-cooperativa-instalaciones/cover_hu_b4185a07ab742766.png 1600w" width=800 height=800 loading=lazy alt="Featured image of post Práctica Cooperativa: Despliegue Completo de Motores de Base de Datos"></a></div><div class=article-details><header class=article-category><a href=/categories/base-de-datos/>Base De Datos
</a><a href=/categories/oracle/>Oracle
</a><a href=/categories/mariadb/>MariaDB
</a><a href=/categories/postgresql/>PostgreSQL
</a><a href=/categories/mongodb/>MongoDB
</a><a href=/categories/devops/>DevOps</a></header><div class=article-title-wrapper><h2 class=article-title><a href=/post/practica-cooperativa-instalaciones/>Práctica Cooperativa: Despliegue Completo de Motores de Base de Datos</a></h2></div><footer class=article-time><div><svg class="icon icon-tabler icon-tabler-calendar-time" width="56" height="56" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><path d="M11.795 21H5a2 2 0 01-2-2V7a2 2 0 012-2h12a2 2 0 012 2v4"/><circle cx="18" cy="18" r="4"/><path d="M15 3v4"/><path d="M7 3v4"/><path d="M3 11h16"/><path d="M18 16.496V18l1 1"/></svg>
<time class=article-time--published datetime=2025-12-09T00:00:00Z>09 dic. 2025</time></div><div><svg class="icon icon-tabler icon-tabler-clock" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="12" cy="12" r="9"/><polyline points="12 7 12 12 15 15"/></svg>
<time class=article-time--reading>Tiempo de lectura 63 minutos</time></div></footer><footer class=article-translations><svg class="icon icon-tabler icon-tabler-language" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M4 5h7"/><path d="M9 3v2c0 4.418-2.239 8-5 8"/><path d="M5 9c-.003 2.144 2.952 3.908 6.7 4"/><path d="M12 20l4-9 4 9"/><path d="M19.1 18h-6.2"/></svg><div><a href=http://sergiojimenez.org/en/post/practica-cooperativa-instalaciones/ class=link>English</a></div></footer></div></header><section class=article-content><h1 id=guía-cooperativa-de-instalación-y-configuración-de-bases-de-datos>Guía Cooperativa de Instalación y Configuración de Bases de Datos</h1><p>Este documento recoge el trabajo realizado para la puesta en marcha de diversos sistemas gestores de bases de datos en <strong>Debian 13</strong>. A continuación se detallan los pasos para cada uno de ellos.</p><p>Esta práctica ha sido realizada por los alumnos Sergio Jiménez, José María Oteo y David Dorante.</p><h2 id=instalación-de-oracle-21c-sobre-debian-13>Instalación de Oracle 21c sobre Debian 13</h2><h3 id=1configuración-previa-y-dependencias>1.Configuración previa y dependencias</h3><ul><li>En primer lugar actualizaremos los paquetes del sistema, para evitar posibles
conflictos de distintas versiones de paquetes durante la instalación de las
dependencias de Oracle.</li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-bash data-lang=bash><span style=display:flex><span>serjaii@db:~$ sudo apt update <span style=color:#f92672>&amp;&amp;</span> sudo apt upgrade -y
</span></span></code></pre></div><ul><li>Instalamos las dependencias de Oracle en nuestro sistema.</li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-bash data-lang=bash><span style=display:flex><span>serjaii@db:~$ sudo apt policy libaio1t64 libaio-dev unixodbc rlwrap alien net-tools unzip bc ksh
</span></span></code></pre></div><ul><li><p>Usaje de cada dependencia</p></li><li><p><strong>libaio1t64</strong>: dependencia de Entrada/Salida Asíncrona, obligatoria para
Oracle.</p></li><li><p><strong>libaio-dev</strong>: contiene los archivos de cabecera y enlaces simbólicos para
que los desarrolladores puedan compilar programas que usen la librería
libaio.</p></li><li><p><strong>unixodbc</strong>: librerías ODBC necesarias para Oracle.</p></li><li><p><strong>rlwrap</strong>: mejora la experiencia de SQL*Plus en terminal.</p></li><li><p><strong>bc</strong>: cálculos usados por scripts de Oracle.</p></li><li><p><strong>ksh</strong>: KornShell, requerida por algunos scripts de instalación.</p></li><li><p><strong>alien</strong>: convierte paquete .rpm a .deb.</p></li><li><p><strong>not-tools</strong>: incluye netstat, usado por Oracle.</p></li><li><p><strong>unzip</strong>: para SQL*Plus más tarde.</p></li><li><p>Configuramos una ip estática para facilitar futuras conexiones remotas.</p></li><li><p>En el hosts añadiremos una entrada apuntando hacia nuestra dirección privada.</p></li><li><p>Oracle y SQL*Plus, necesitan la librería libaio.so.1, que no se encuentra en el
sistema ya que en Debian 13 ha cambiado el nombre del paquete y de la
librería, y por tanto para que no nos de error al intentar entrar en Oracle,
crearemos un enlace simbólico a partir de la librería libaio1t64 con nombre
libaio.so1, para que Oracle reconozca la librería.
Comprobación:</p></li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-bash data-lang=bash><span style=display:flex><span>serjaii@db:~$ ls -l /usr/lib/x86_64-linux-gnu/libaio.so.1
</span></span><span style=display:flex><span>lrwxrwxrwx <span style=color:#ae81ff>1</span> root root <span style=color:#ae81ff>40</span> oct <span style=color:#ae81ff>8</span> 20:22 /usr/lib/x86_64-linuxgnu/libaio.so.1 -&gt; /usr/lib/x86_64-linux-gnu/libaio.so.1t64
</span></span></code></pre></div><h3 id=2instalación-del-servidor>2.Instalación del servidor</h3><ul><li><p>Posible Error: El proceso alien puede que requiera de más de 2GB de espacio
en /tmp, si no disponemos de ellos deberemos aumentar dicho tamaño</p></li><li><p>Usamos el comando “alien” para convertir el paquete .rpm que acabamos de
descargarnos de Oracle 21c, a formato .deb, que es el formato de paquetes que
ejecuta Debian.</p></li><li><p>Tras haber modificado la extensión del archivo a .deb, instalamos dicho
paquete de oracle manualmente.</p></li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-bash data-lang=bash><span style=display:flex><span>serjaii@db:~$ sudo dpkg -i oracle-database-ee-21c_1.02_amd64.deb
</span></span></code></pre></div><ul><li>Ejecutamos el script de configuración creado por Oracle.</li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-bash data-lang=bash><span style=display:flex><span>serjaii@db:~$ sudo /etc/init.d/oracledb_ORCLCDB-21c configure
</span></span></code></pre></div><ul><li>Para evitar que nos pida usuario y contraseña al entrar oracle, tendremos que
añadir nuestro usuario, en mi caso, sergio, al grupo dba.</li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-bash data-lang=bash><span style=display:flex><span>serjaii@db:~$ sudo usermod -aG dba $USER
</span></span></code></pre></div><ul><li>Una vez que hemos instalado Oracle, tendremos que añadir las siguientes
variables de entorno en el bashrc de nuestra máquina donde hemos instalado el
servidor de Oracle.</li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-bash data-lang=bash><span style=display:flex><span>serjaii@db:~$ grep <span style=color:#e6db74>&#39;^export&#39;</span> ~/.bashrc 
</span></span><span style=display:flex><span>export ORACLE_HOME<span style=color:#f92672>=</span>/opt/oracle/product/21c/dbhome_1 
</span></span><span style=display:flex><span>export ORACLE_SID<span style=color:#f92672>=</span>ORCLCDB 
</span></span><span style=display:flex><span>export ORACLE_BASE<span style=color:#f92672>=</span>/opt/oracle 
</span></span><span style=display:flex><span>export LD_LIBRARY_PATH<span style=color:#f92672>=</span>$ORACLE_HOME/lib:$LD_LIBRARY_PATH 
</span></span><span style=display:flex><span>export PATH<span style=color:#f92672>=</span>$ORACLE_HOME/bin:$PATH 
</span></span><span style=display:flex><span>export NLS_LANG<span style=color:#f92672>=</span>SPANISH_SPAIN.AL32UTF8
</span></span><span style=display:flex><span>serjaii@db:~$ alias alias sqlplus<span style=color:#f92672>=</span><span style=color:#e6db74>&#39;rlwrap sqlplus&#39;</span>
</span></span></code></pre></div><ul><li>Una vez añadida las variables de entorno, tendremos que recargar bashrc, para
que se apliquen las variables de entorno que acabamos de añadir.</li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-bash data-lang=bash><span style=display:flex><span>serjaii@db:~$ source ~/.bashrc
</span></span></code></pre></div><ul><li>Comprobamos que podemos acceder como administrador a la base de datos.</li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-bash data-lang=bash><span style=display:flex><span>serjaii@db:~$ sqlplus / as sysdba
</span></span></code></pre></div><h3 id=3crear-usuario-y-conceder-permisos-en-oracle-21c>3.Crear usuario y conceder permisos en Oracle 21c.</h3><ul><li>Realizamos la siguiente configuración inicial para permitir la creación de
usuarios en Oracle.</li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-bash data-lang=bash><span style=display:flex><span>SQL&gt; STARTUP;
</span></span><span style=display:flex><span>SQL&gt; ALTER SESSION SET <span style=color:#e6db74>&#34;_ORACLE_SCRIPT&#34;</span><span style=color:#f92672>=</span>true;
</span></span></code></pre></div><ul><li>Nos creamos un usuario con el cuál vamos a probar a conectarnos después y le
aplicamos los permisos que consideremos al mismo.</li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-bash data-lang=bash><span style=display:flex><span>SQL&gt; CREATE USER sergio IDENTIFIED BY sergio;
</span></span><span style=display:flex><span>SQL&gt; GRANT ALL PRIVILEGES TO sergio;
</span></span></code></pre></div><ul><li>Para iniciar el servicio automáticamente al reiniciar vamos a modificar el
crontab (programador de tareas de linux).</li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-bash data-lang=bash><span style=display:flex><span>serjaii@db:~$ sudo crontab -e
</span></span></code></pre></div><ul><li>Accedemos a la base de datos con el usuario que acabamos de crear.</li></ul><h3 id=4configuración-del-servidor-oracle-para-la-conexión-remota>4.Configuración del servidor Oracle para la conexión remota.</h3><ul><li>Oracle por defecto, suele escuchar por localhost, por lo tanto vamos a modificar
el parámetro host del fichero listener.ora, para que escuche todas las peticiones
incluidas las peticiones remotas o externas.</li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-bash data-lang=bash><span style=display:flex><span>serjaii@db:~$ sudo nano /opt/oracle/homes/OraDBHome21cEE/network/admin/listener.ora
</span></span></code></pre></div><ul><li>También vamos a modificar el fichero tnsnames.ora, ya que es el que va a
indicar al cliente como conectarse a Oracle. En este caso, vamos a modificar el
valor “HOST” de “ORCLCDB”.</li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-bash data-lang=bash><span style=display:flex><span>serjaii@db:~$ sudo nano /opt/oracle/homes/OraDBHome21cEE/network/admin/tnsnames.ora
</span></span></code></pre></div><ul><li>Reiniciamos la máquina para aplicar los cambios.</li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-bash data-lang=bash><span style=display:flex><span>serjaii@db:~$ sudo reboot
</span></span></code></pre></div><h3 id=5instalación-y-configuración-del-cliente-de-oracle-sqlplus>5.Instalación y configuración del cliente de Oracle (SQL*Plus).</h3><ul><li>Lo primero que vamos a hacer es actualizar los paquetes del sistema, para
evitar posibles conflictos de versiones de paquetes durante la instalación de las
dependencias de SQL*Plus.</li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-bash data-lang=bash><span style=display:flex><span>serjaii@db:~$ sudo apt update
</span></span></code></pre></div><ul><li>Instalamos las dependencias necesarias que requiere la instalación del cliente
de Oracle.</li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-bash data-lang=bash><span style=display:flex><span>serjaii@db:~$ sudo apt install libaio1t64 libaio-dev rlwrap wget p7zip-full -y -
</span></span></code></pre></div><ul><li><p><strong>libaio1t64</strong>: librería de I/O asíncrona, que lo necesita Oracle en tiempo
de ejecución.</p></li><li><p><strong>libaio-dev</strong>: cabeceras y enlaces simbólicos para compilación.</p></li><li><p><strong>rlwrap</strong>: permite usar historial y edición de comandos en sqlplus.
wget: para descargar los paquetes desde la web de Oracle.
p7zip-full: descomprime los .zip de Oracle.</p></li><li><p>Al igual que en la instalación del servidor volveremos a crear el enlace
simbólico para ayudar a Debian a reconocer el paquete.</p></li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-bash data-lang=bash><span style=display:flex><span>serjaii@db:~$ sudo ln -s /usr/lib/x86_64-linux-gnu/libaio.so.1t64 /usr/lib/x86_64-linux-gnu/libaio.so.1
</span></span></code></pre></div><ul><li>Creamos una carpeta que vamos a usar para trabajar con el cliente de Oracle.</li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-bash data-lang=bash><span style=display:flex><span>serjaii@db:~$ mkdir oracle
</span></span><span style=display:flex><span>serjaii@db:~$ cd oracle
</span></span></code></pre></div><ul><li>Descargamos los paquetes para poder trabajar con el cliente de Oracle, que son
Basic y SQL*Plus.</li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-bash data-lang=bash><span style=display:flex><span>serjaii@db:~$ wget https://download.oracle.com/otn_software/linux/instantclient/2119000/instantclient-basic-linux.x64-21.19.0.0.0dbru.zip
</span></span><span style=display:flex><span>serjaii@db:~$ wget https://download.oracle.com/otn_software/linux/instantclient/2119000/instantclient-sqlplus-linux.x64-21.19.0.0.0dbru.zip
</span></span></code></pre></div><ul><li>Comprobamos que se han descargado correctamente los paquetes y los
descomprimimos.</li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-bash data-lang=bash><span style=display:flex><span>serjaii@db:~$ ls
</span></span><span style=display:flex><span>serjaii@db:~$ 7z x instantclient-basic-linux.x64-21.19.0.0.0dbru.zip
</span></span><span style=display:flex><span>serjaii@db:~$ 7z x instantclient-sqlplus-linux.x64-21.19.0.0.0dbru.zip
</span></span></code></pre></div><ul><li>Añadimos las siguientes variables de entorno para que funcione correctamente
el cliente de Oracle.</li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-bash data-lang=bash><span style=display:flex><span>serjaii@db:~$ sudo nano ~/.bashrc
</span></span></code></pre></div><ul><li>Ejecutamos el siguiente comando para aplicar los cambios que acabamos de
realizar en .bashrc.</li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-bash data-lang=bash><span style=display:flex><span>serjaii@db:~$ source ~/.bashrc
</span></span></code></pre></div><ul><li>Nos conectamos desde el cliente al servidor Oracle.</li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-bash data-lang=bash><span style=display:flex><span>serjaii@db:~$ sqlplus sergio/sergio@//192.168.122.79:1521/ORCLCDB
</span></span></code></pre></div><h3 id=6creación-de-base-de-datos-con-tablas-y-datos-en-oracle>6.Creación de base de datos con tablas y datos en Oracle.</h3><ul><li>Accedemos a la base de datos desde el servidor y accedemos como
administrador para poder crear la base de datos.</li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-bash data-lang=bash><span style=display:flex><span>serjaii@db:~$ sqlplus / as sysdba 
</span></span><span style=display:flex><span>SQL&gt; ALTER SESSION SET <span style=color:#e6db74>&#34;_ORACLE_SCRIPT&#34;</span><span style=color:#f92672>=</span>true;
</span></span></code></pre></div><ul><li>Creamos la base de datos y le damos los privilegios necesarios.</li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-bash data-lang=bash><span style=display:flex><span>SQL&gt; CREATE USER hotel IDENTIFIED BY hotel123;
</span></span><span style=display:flex><span>SQL&gt; GRANT ALL PRIVILEGES TO hotel;
</span></span></code></pre></div><ul><li>Accedemos desde el cliente a la base de datos que acabamos de crear en
Oracle.</li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-bash data-lang=bash><span style=display:flex><span>serjaii@db:~$ sqlplus hotel/hotel123@//192.168.122.79:1521/ORCLCDB
</span></span></code></pre></div><ul><li>Creamos las tablas que van a componer la base de datos ‘hotel’, para permitir
la gestión de un sistema de reservas de un hotel.</li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-sql data-lang=sql><span style=display:flex><span><span style=color:#66d9ef>CREATE</span> <span style=color:#66d9ef>TABLE</span> clientes(
</span></span><span style=display:flex><span>    id INT,
</span></span><span style=display:flex><span>    nombre VARCHAR(<span style=color:#ae81ff>15</span>) <span style=color:#66d9ef>NOT</span> <span style=color:#66d9ef>NULL</span>,
</span></span><span style=display:flex><span>    apellidos VARCHAR(<span style=color:#ae81ff>30</span>) <span style=color:#66d9ef>NOT</span> <span style=color:#66d9ef>NULL</span>,
</span></span><span style=display:flex><span>    email VARCHAR(<span style=color:#ae81ff>50</span>),
</span></span><span style=display:flex><span>    telefono NUMBER(<span style=color:#ae81ff>9</span>),
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>CONSTRAINT</span> pk_idCliente <span style=color:#66d9ef>PRIMARY</span> <span style=color:#66d9ef>KEY</span> (id),
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>CONSTRAINT</span> uq_email <span style=color:#66d9ef>UNIQUE</span> (email)
</span></span><span style=display:flex><span>);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>CREATE</span> <span style=color:#66d9ef>TABLE</span> habitaciones(
</span></span><span style=display:flex><span>    id INT,
</span></span><span style=display:flex><span>    numero INT <span style=color:#66d9ef>NOT</span> <span style=color:#66d9ef>NULL</span>,
</span></span><span style=display:flex><span>    tipo VARCHAR(<span style=color:#ae81ff>20</span>) <span style=color:#66d9ef>NOT</span> <span style=color:#66d9ef>NULL</span>,
</span></span><span style=display:flex><span>    precio DECIMAL(<span style=color:#ae81ff>10</span>,<span style=color:#ae81ff>2</span>) <span style=color:#66d9ef>NOT</span> <span style=color:#66d9ef>NULL</span>,
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>CONSTRAINT</span> pk_idHabitacion <span style=color:#66d9ef>PRIMARY</span> <span style=color:#66d9ef>KEY</span> (id),
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>CONSTRAINT</span> uq_numero <span style=color:#66d9ef>UNIQUE</span> (numero),
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>CONSTRAINT</span> ck_tipoHabitacion <span style=color:#66d9ef>CHECK</span> (tipo <span style=color:#66d9ef>IN</span> (<span style=color:#e6db74>&#39;Individual&#39;</span>, <span style=color:#e6db74>&#39;Doble&#39;</span>, <span style=color:#e6db74>&#39;Suite&#39;</span>, <span style=color:#e6db74>&#39;Familiar&#39;</span>))
</span></span><span style=display:flex><span>);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>CREATE</span> <span style=color:#66d9ef>TABLE</span> reservas(
</span></span><span style=display:flex><span>    id INT,
</span></span><span style=display:flex><span>    idCliente INT <span style=color:#66d9ef>NOT</span> <span style=color:#66d9ef>NULL</span>,
</span></span><span style=display:flex><span>    idHabitacion INT <span style=color:#66d9ef>NOT</span> <span style=color:#66d9ef>NULL</span>,
</span></span><span style=display:flex><span>    fecha_entrada DATE <span style=color:#66d9ef>NOT</span> <span style=color:#66d9ef>NULL</span>,
</span></span><span style=display:flex><span>    fecha_salida DATE <span style=color:#66d9ef>NOT</span> <span style=color:#66d9ef>NULL</span>,
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>CONSTRAINT</span> pk_idReservas <span style=color:#66d9ef>PRIMARY</span> <span style=color:#66d9ef>KEY</span> (id),
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>CONSTRAINT</span> fk_idCliente <span style=color:#66d9ef>FOREIGN</span> <span style=color:#66d9ef>KEY</span> (idCliente) <span style=color:#66d9ef>REFERENCES</span> clientes(id),
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>CONSTRAINT</span> fk_idHabitacion <span style=color:#66d9ef>FOREIGN</span> <span style=color:#66d9ef>KEY</span> (idHabitacion) <span style=color:#66d9ef>REFERENCES</span> habitaciones(id)
</span></span><span style=display:flex><span>);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>CREATE</span> <span style=color:#66d9ef>TABLE</span> pagos(
</span></span><span style=display:flex><span>    id INT,
</span></span><span style=display:flex><span>    idReserva INT <span style=color:#66d9ef>NOT</span> <span style=color:#66d9ef>NULL</span>,
</span></span><span style=display:flex><span>    metodoPago VARCHAR(<span style=color:#ae81ff>20</span>) <span style=color:#66d9ef>NOT</span> <span style=color:#66d9ef>NULL</span>,
</span></span><span style=display:flex><span>    precio DECIMAL(<span style=color:#ae81ff>10</span>,<span style=color:#ae81ff>2</span>) <span style=color:#66d9ef>NOT</span> <span style=color:#66d9ef>NULL</span>,
</span></span><span style=display:flex><span>    fechaPago DATE <span style=color:#66d9ef>NOT</span> <span style=color:#66d9ef>NULL</span>,
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>CONSTRAINT</span> pk_idPagos <span style=color:#66d9ef>PRIMARY</span> <span style=color:#66d9ef>KEY</span> (id),
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>CONSTRAINT</span> fk_idReserva <span style=color:#66d9ef>FOREIGN</span> <span style=color:#66d9ef>KEY</span> (idReserva) <span style=color:#66d9ef>REFERENCES</span> reservas(id),
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>CONSTRAINT</span> ck_metodoPago <span style=color:#66d9ef>CHECK</span> (metodoPago <span style=color:#66d9ef>IN</span> (<span style=color:#e6db74>&#39;Tarjeta&#39;</span>,<span style=color:#e6db74>&#39;Efectivo&#39;</span>,<span style=color:#e6db74>&#39;PayPal&#39;</span>))
</span></span><span style=display:flex><span>);
</span></span></code></pre></div><ul><li>Introducimos datos a la base de datos que acabamos de crear.
Datos Tabla clientes:</li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-sql data-lang=sql><span style=display:flex><span><span style=color:#75715e>-- Datos Tabla clientes:
</span></span></span><span style=display:flex><span><span style=color:#66d9ef>INSERT</span> <span style=color:#66d9ef>INTO</span> clientes (id, nombre, apellidos, email, telefono) <span style=color:#66d9ef>VALUES</span> (<span style=color:#ae81ff>1</span>, <span style=color:#e6db74>&#39;David&#39;</span>, <span style=color:#e6db74>&#39;Dorado López&#39;</span>, <span style=color:#e6db74>&#39;davidd@gmail.com&#39;</span>, <span style=color:#ae81ff>600111222</span>);
</span></span><span style=display:flex><span><span style=color:#66d9ef>INSERT</span> <span style=color:#66d9ef>INTO</span> clientes (id, nombre, apellidos, email, telefono) <span style=color:#66d9ef>VALUES</span> (<span style=color:#ae81ff>2</span>, <span style=color:#e6db74>&#39;María&#39;</span>, <span style=color:#e6db74>&#39;Gómez Pérez&#39;</span>, <span style=color:#e6db74>&#39;mariagom@gmail.com&#39;</span>, <span style=color:#ae81ff>600333444</span>);
</span></span><span style=display:flex><span><span style=color:#66d9ef>INSERT</span> <span style=color:#66d9ef>INTO</span> clientes (id, nombre, apellidos, email, telefono) <span style=color:#66d9ef>VALUES</span> (<span style=color:#ae81ff>3</span>, <span style=color:#e6db74>&#39;Jorge&#39;</span>, <span style=color:#e6db74>&#39;Santos Díaz&#39;</span>, <span style=color:#e6db74>&#39;jogesantos@gmail.com&#39;</span>, <span style=color:#ae81ff>600555666</span>);
</span></span><span style=display:flex><span><span style=color:#66d9ef>INSERT</span> <span style=color:#66d9ef>INTO</span> clientes (id, nombre, apellidos, email, telefono) <span style=color:#66d9ef>VALUES</span> (<span style=color:#ae81ff>4</span>, <span style=color:#e6db74>&#39;Lucía&#39;</span>, <span style=color:#e6db74>&#39;Romero García&#39;</span>, <span style=color:#e6db74>&#39;luciarom@yahoot.es&#39;</span>, <span style=color:#ae81ff>600777888</span>);
</span></span><span style=display:flex><span><span style=color:#66d9ef>INSERT</span> <span style=color:#66d9ef>INTO</span> clientes (id, nombre, apellidos, email, telefono) <span style=color:#66d9ef>VALUES</span> (<span style=color:#ae81ff>5</span>, <span style=color:#e6db74>&#39;Pablo&#39;</span>, <span style=color:#e6db74>&#39;Ruiz Torres&#39;</span>, <span style=color:#e6db74>&#39;pablo@gmail.com&#39;</span>, <span style=color:#ae81ff>600999000</span>);
</span></span><span style=display:flex><span><span style=color:#66d9ef>INSERT</span> <span style=color:#66d9ef>INTO</span> clientes (id, nombre, apellidos, email, telefono) <span style=color:#66d9ef>VALUES</span> (<span style=color:#ae81ff>6</span>, <span style=color:#e6db74>&#39;Sofía&#39;</span>, <span style=color:#e6db74>&#39;Martínez León&#39;</span>, <span style=color:#e6db74>&#39;sofleon@yahoot.es&#39;</span>, <span style=color:#ae81ff>601111222</span>);
</span></span><span style=display:flex><span><span style=color:#66d9ef>INSERT</span> <span style=color:#66d9ef>INTO</span> clientes (id, nombre, apellidos, email, telefono) <span style=color:#66d9ef>VALUES</span> (<span style=color:#ae81ff>7</span>, <span style=color:#e6db74>&#39;Alberto&#39;</span>, <span style=color:#e6db74>&#39;Navas Cruz&#39;</span>, <span style=color:#e6db74>&#39;albertonavas@yahoot.es&#39;</span>, <span style=color:#ae81ff>601333444</span>);
</span></span><span style=display:flex><span><span style=color:#66d9ef>INSERT</span> <span style=color:#66d9ef>INTO</span> clientes (id, nombre, apellidos, email, telefono) <span style=color:#66d9ef>VALUES</span> (<span style=color:#ae81ff>8</span>, <span style=color:#e6db74>&#39;Marta&#39;</span>, <span style=color:#e6db74>&#39;López Gil&#39;</span>, <span style=color:#e6db74>&#39;marta@gmail.com&#39;</span>, <span style=color:#ae81ff>601555666</span>);
</span></span><span style=display:flex><span><span style=color:#66d9ef>INSERT</span> <span style=color:#66d9ef>INTO</span> clientes (id, nombre, apellidos, email, telefono) <span style=color:#66d9ef>VALUES</span> (<span style=color:#ae81ff>9</span>, <span style=color:#e6db74>&#39;Raúl&#39;</span>, <span style=color:#e6db74>&#39;Castro Vega&#39;</span>, <span style=color:#e6db74>&#39;raulcastro@gmail.com&#39;</span>, <span style=color:#ae81ff>601777888</span>);
</span></span><span style=display:flex><span><span style=color:#66d9ef>INSERT</span> <span style=color:#66d9ef>INTO</span> clientes (id, nombre, apellidos, email, telefono) <span style=color:#66d9ef>VALUES</span> (<span style=color:#ae81ff>10</span>, <span style=color:#e6db74>&#39;Laura&#39;</span>, <span style=color:#e6db74>&#39;Morales Cano&#39;</span>, <span style=color:#e6db74>&#39;laura@gmail.com&#39;</span>, <span style=color:#ae81ff>601999000</span>);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>-- Datos tabla habitaciones:
</span></span></span><span style=display:flex><span><span style=color:#66d9ef>INSERT</span> <span style=color:#66d9ef>INTO</span> habitaciones (id, numero, tipo, precio) <span style=color:#66d9ef>VALUES</span> (<span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>101</span>, <span style=color:#e6db74>&#39;Individual&#39;</span>, <span style=color:#ae81ff>50</span>);
</span></span><span style=display:flex><span><span style=color:#66d9ef>INSERT</span> <span style=color:#66d9ef>INTO</span> habitaciones (id, numero, tipo, precio) <span style=color:#66d9ef>VALUES</span> (<span style=color:#ae81ff>2</span>, <span style=color:#ae81ff>102</span>, <span style=color:#e6db74>&#39;Doble&#39;</span>, <span style=color:#ae81ff>80</span>);
</span></span><span style=display:flex><span><span style=color:#66d9ef>INSERT</span> <span style=color:#66d9ef>INTO</span> habitaciones (id, numero, tipo, precio) <span style=color:#66d9ef>VALUES</span> (<span style=color:#ae81ff>3</span>, <span style=color:#ae81ff>103</span>, <span style=color:#e6db74>&#39;Suite&#39;</span>, <span style=color:#ae81ff>150</span>);
</span></span><span style=display:flex><span><span style=color:#66d9ef>INSERT</span> <span style=color:#66d9ef>INTO</span> habitaciones (id, numero, tipo, precio) <span style=color:#66d9ef>VALUES</span> (<span style=color:#ae81ff>4</span>, <span style=color:#ae81ff>104</span>, <span style=color:#e6db74>&#39;Individual&#39;</span>, <span style=color:#ae81ff>50</span>);
</span></span><span style=display:flex><span><span style=color:#66d9ef>INSERT</span> <span style=color:#66d9ef>INTO</span> habitaciones (id, numero, tipo, precio) <span style=color:#66d9ef>VALUES</span> (<span style=color:#ae81ff>5</span>, <span style=color:#ae81ff>105</span>, <span style=color:#e6db74>&#39;Doble&#39;</span>, <span style=color:#ae81ff>80</span>);
</span></span><span style=display:flex><span><span style=color:#66d9ef>INSERT</span> <span style=color:#66d9ef>INTO</span> habitaciones (id, numero, tipo, precio) <span style=color:#66d9ef>VALUES</span> (<span style=color:#ae81ff>6</span>, <span style=color:#ae81ff>106</span>, <span style=color:#e6db74>&#39;Suite&#39;</span>, <span style=color:#ae81ff>150</span>);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>-- Datos tabla reservas:
</span></span></span><span style=display:flex><span><span style=color:#66d9ef>INSERT</span> <span style=color:#66d9ef>INTO</span> reservas (id, idCliente, idHabitacion, fecha_entrada, fecha_salida) <span style=color:#66d9ef>VALUES</span> (<span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>1</span>, TO_DATE(<span style=color:#e6db74>&#39;2025-10-01&#39;</span>, <span style=color:#e6db74>&#39;YYYY-MM-DD&#39;</span>), TO_DATE(<span style=color:#e6db74>&#39;2025-10-05&#39;</span>, <span style=color:#e6db74>&#39;YYYY-MM-DD&#39;</span>));
</span></span><span style=display:flex><span><span style=color:#66d9ef>INSERT</span> <span style=color:#66d9ef>INTO</span> reservas (id, idCliente, idHabitacion, fecha_entrada, fecha_salida) <span style=color:#66d9ef>VALUES</span> (<span style=color:#ae81ff>2</span>, <span style=color:#ae81ff>2</span>, <span style=color:#ae81ff>2</span>, TO_DATE(<span style=color:#e6db74>&#39;2025-10-03&#39;</span>, <span style=color:#e6db74>&#39;YYYY-MM-DD&#39;</span>), TO_DATE(<span style=color:#e6db74>&#39;2025-10-06&#39;</span>, <span style=color:#e6db74>&#39;YYYY-MM-DD&#39;</span>));
</span></span><span style=display:flex><span><span style=color:#66d9ef>INSERT</span> <span style=color:#66d9ef>INTO</span> reservas (id, idCliente, idHabitacion, fecha_entrada, fecha_salida) <span style=color:#66d9ef>VALUES</span> (<span style=color:#ae81ff>3</span>, <span style=color:#ae81ff>3</span>, <span style=color:#ae81ff>3</span>, TO_DATE(<span style=color:#e6db74>&#39;2025-10-02&#39;</span>, <span style=color:#e6db74>&#39;YYYY-MM-DD&#39;</span>), TO_DATE(<span style=color:#e6db74>&#39;2025-10-04&#39;</span>, <span style=color:#e6db74>&#39;YYYY-MM-DD&#39;</span>));
</span></span><span style=display:flex><span><span style=color:#66d9ef>INSERT</span> <span style=color:#66d9ef>INTO</span> reservas (id, idCliente, idHabitacion, fecha_entrada, fecha_salida) <span style=color:#66d9ef>VALUES</span> (<span style=color:#ae81ff>4</span>, <span style=color:#ae81ff>4</span>, <span style=color:#ae81ff>4</span>, TO_DATE(<span style=color:#e6db74>&#39;2025-10-05&#39;</span>, <span style=color:#e6db74>&#39;YYYY-MM-DD&#39;</span>), TO_DATE(<span style=color:#e6db74>&#39;2025-10-10&#39;</span>, <span style=color:#e6db74>&#39;YYYY-MM-DD&#39;</span>));
</span></span><span style=display:flex><span><span style=color:#66d9ef>INSERT</span> <span style=color:#66d9ef>INTO</span> reservas (id, idCliente, idHabitacion, fecha_entrada, fecha_salida) <span style=color:#66d9ef>VALUES</span> (<span style=color:#ae81ff>5</span>, <span style=color:#ae81ff>5</span>, <span style=color:#ae81ff>5</span>, TO_DATE(<span style=color:#e6db74>&#39;2025-10-07&#39;</span>, <span style=color:#e6db74>&#39;YYYY-MM-DD&#39;</span>), TO_DATE(<span style=color:#e6db74>&#39;2025-10-12&#39;</span>, <span style=color:#e6db74>&#39;YYYY-MM-DD&#39;</span>));
</span></span><span style=display:flex><span><span style=color:#66d9ef>INSERT</span> <span style=color:#66d9ef>INTO</span> reservas (id, idCliente, idHabitacion, fecha_entrada, fecha_salida) <span style=color:#66d9ef>VALUES</span> (<span style=color:#ae81ff>6</span>, <span style=color:#ae81ff>6</span>, <span style=color:#ae81ff>6</span>, TO_DATE(<span style=color:#e6db74>&#39;2025-10-01&#39;</span>, <span style=color:#e6db74>&#39;YYYY-MM-DD&#39;</span>), TO_DATE(<span style=color:#e6db74>&#39;2025-10-03&#39;</span>, <span style=color:#e6db74>&#39;YYYY-MM-DD&#39;</span>));
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>-- Datos tabla pagos:
</span></span></span><span style=display:flex><span><span style=color:#66d9ef>INSERT</span> <span style=color:#66d9ef>INTO</span> pagos (id, idReserva, metodoPago, precio, fechaPago) <span style=color:#66d9ef>VALUES</span> (<span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>1</span>, <span style=color:#e6db74>&#39;Tarjeta&#39;</span>, <span style=color:#ae81ff>200</span>, TO_DATE(<span style=color:#e6db74>&#39;2025-10-01&#39;</span>, <span style=color:#e6db74>&#39;YYYY-MM-DD&#39;</span>));
</span></span><span style=display:flex><span><span style=color:#66d9ef>INSERT</span> <span style=color:#66d9ef>INTO</span> pagos (id, idReserva, metodoPago, precio, fechaPago) <span style=color:#66d9ef>VALUES</span> (<span style=color:#ae81ff>2</span>, <span style=color:#ae81ff>2</span>, <span style=color:#e6db74>&#39;Efectivo&#39;</span>, <span style=color:#ae81ff>240</span>, TO_DATE(<span style=color:#e6db74>&#39;2025-10-03&#39;</span>, <span style=color:#e6db74>&#39;YYYY-MM-DD&#39;</span>));
</span></span><span style=display:flex><span><span style=color:#66d9ef>INSERT</span> <span style=color:#66d9ef>INTO</span> pagos (id, idReserva, metodoPago, precio, fechaPago) <span style=color:#66d9ef>VALUES</span> (<span style=color:#ae81ff>3</span>, <span style=color:#ae81ff>3</span>, <span style=color:#e6db74>&#39;PayPal&#39;</span>, <span style=color:#ae81ff>300</span>, TO_DATE(<span style=color:#e6db74>&#39;2025-10-02&#39;</span>, <span style=color:#e6db74>&#39;YYYY-MM-DD&#39;</span>));
</span></span><span style=display:flex><span><span style=color:#66d9ef>INSERT</span> <span style=color:#66d9ef>INTO</span> pagos (id, idReserva, metodoPago, precio, fechaPago) <span style=color:#66d9ef>VALUES</span> (<span style=color:#ae81ff>4</span>, <span style=color:#ae81ff>4</span>, <span style=color:#e6db74>&#39;Tarjeta&#39;</span>, <span style=color:#ae81ff>400</span>, TO_DATE(<span style=color:#e6db74>&#39;2025-10-05&#39;</span>, <span style=color:#e6db74>&#39;YYYY-MM-DD&#39;</span>));
</span></span><span style=display:flex><span><span style=color:#66d9ef>INSERT</span> <span style=color:#66d9ef>INTO</span> pagos (id, idReserva, metodoPago, precio, fechaPago) <span style=color:#66d9ef>VALUES</span> (<span style=color:#ae81ff>5</span>, <span style=color:#ae81ff>5</span>, <span style=color:#e6db74>&#39;Efectivo&#39;</span>, <span style=color:#ae81ff>320</span>, TO_DATE(<span style=color:#e6db74>&#39;2025-10-07&#39;</span>, <span style=color:#e6db74>&#39;YYYY-MM-DD&#39;</span>));
</span></span><span style=display:flex><span><span style=color:#66d9ef>INSERT</span> <span style=color:#66d9ef>INTO</span> pagos (id, idReserva, metodoPago, precio, fechaPago) <span style=color:#66d9ef>VALUES</span> (<span style=color:#ae81ff>6</span>, <span style=color:#ae81ff>6</span>, <span style=color:#e6db74>&#39;PayPal&#39;</span>, <span style=color:#ae81ff>150</span>, TO_DATE(<span style=color:#e6db74>&#39;2025-10-01&#39;</span>, <span style=color:#e6db74>&#39;YYYY-MM-DD&#39;</span>));
</span></span></code></pre></div><ul><li>Comprobamos que todo se ha creado correctamente.</li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-bash data-lang=bash><span style=display:flex><span>SELECT * FROM clientes;
</span></span></code></pre></div><p>Las interrogaciones que aparecen se deben a las tildes, ya que las base de datos
no entienden bien las tildes.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-bash data-lang=bash><span style=display:flex><span>SELECT * FROM habitaciones;
</span></span><span style=display:flex><span>SELECT * FROM reservas;
</span></span><span style=display:flex><span>SELECT * FROM pagos;
</span></span></code></pre></div><h2 id=instalación-servidor-postgresql-en-debian-13>Instalación Servidor PostgreSQL en Debian 13.</h2><h3 id=1configuración-previa-y-dependencias-1>1.Configuración previa y dependencias</h3><ul><li>Antes de comenzar con la instalación de PostgreSQL, tendremos que actualizar
los paquetes del sistema.</li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-bash data-lang=bash><span style=display:flex><span>serjaii@db:~$ sudo apt update
</span></span></code></pre></div><h3 id=2instalación-del-servidor-1>2.Instalación del servidor</h3><ul><li>Instalamos el paquete de postgresql.</li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-bash data-lang=bash><span style=display:flex><span>serjaii@db:~$ sudo apt install postgresql -y
</span></span></code></pre></div><ul><li>Comprobamos que se ha instalado el servidor revisando el estado de
PostgreSQL.</li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-bash data-lang=bash><span style=display:flex><span>serjaii@db:~$ systemctl status postgresql
</span></span></code></pre></div><ul><li>Vamos a configurar postgreSQL para que se inicie siempre automáticamente al
iniciar el sistema. Para ello, ejecutaremos el siguiente comando.</li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-bash data-lang=bash><span style=display:flex><span>serjaii@db:~$ sudo systemctl enable postgresql
</span></span></code></pre></div><ul><li>Comprobamos que podemos acceder al servidor postgres desde la propia
máquina donde está instalado.</li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-bash data-lang=bash><span style=display:flex><span>serjaii@db:~$ sudo -u postgres psql
</span></span></code></pre></div><h3 id=3configuración-del-servidor-postgresql-para-la-conexión>3.Configuración del servidor PostgreSQL para la conexión</h3><p>remota.</p><ul><li>Modificamos el fichero “/etc/postgresql/17/main/postgresql.conf”, para permitir
conexiones remotas al servidor postgresql, descomentando la línea
“listen_addresses” en “CONNECTIONS AND AUTHENTICATION”, y
sustituyendo “localhost” por “*”, para permitir todas las conexiones. Una vez
realizado estos cambios, guardamos los cambios en el fichero y salimos.</li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-bash data-lang=bash><span style=display:flex><span>serjaii@db:~$ sudo nano /etc/postgresql/17/main/postgresql.conf
</span></span></code></pre></div><p>Como vemos también podemos modificar el número máximo de conexiones. Por
defecto, PostgreSQL suele permitir la conexión de 100 dispositivos.</p><ul><li>Modificamos el fichero “/etc/postgresql/17/main/pg_hba.conf”, agregando la
siguiente línea final, para configurar permisos y permitir conexiones remotas.</li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-bash data-lang=bash><span style=display:flex><span>serjaii@db:~$ sudo nano /etc/postgresql/17/main/pg_hba.conf
</span></span></code></pre></div><ul><li>Reiniciamos el servicio de postgresql, ejecutando el siguiente comando.</li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-bash data-lang=bash><span style=display:flex><span>serjaii@db:~$ sudo systemctl restart postgresql
</span></span></code></pre></div><h3 id=4crear-base-de-datos-usuario-y-conceder-permisos-en>4.Crear base de datos, usuario y conceder permisos en</h3><p>PostgreSQL.</p><ul><li>Accedemos a la base de datos como usuario privilegiado.</li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-bash data-lang=bash><span style=display:flex><span>serjaii@db:~$ sudo -u postgres psql
</span></span></code></pre></div><ul><li>Con el siguiente comando vamos a crear una base de datos.</li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-bash data-lang=bash><span style=display:flex><span>postgres<span style=color:#f92672>=</span><span style=color:#75715e># CREATE DATABASE prueba_db;</span>
</span></span></code></pre></div><ul><li>Creamos un usuario con contraseña.</li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-bash data-lang=bash><span style=display:flex><span>postgres<span style=color:#f92672>=</span><span style=color:#75715e># CREATE ROLE sergio WITH LOGIN PASSWORD &#39;sergio&#39;;</span>
</span></span></code></pre></div><ul><li>Le damos los privilegios que consideremos necesarios. En mi caso le voy a dar
todos los privilegios.</li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-bash data-lang=bash><span style=display:flex><span>postgres<span style=color:#f92672>=</span><span style=color:#75715e># GRANT ALL PRIVILEGES ON DATABASE</span>
</span></span><span style=display:flex><span>prueba_db TO sergio;
</span></span><span style=display:flex><span>postgres<span style=color:#f92672>=</span><span style=color:#75715e># GRANT ALL PRIVILEGES ON ALL TABLES IN</span>
</span></span><span style=display:flex><span>SCHEMA public TO sergio;
</span></span><span style=display:flex><span>postgres<span style=color:#f92672>=</span><span style=color:#75715e># GRANT ALL PRIVILEGES ON ALL</span>
</span></span><span style=display:flex><span>SEQUENCES IN SCHEMA public TO sergio;
</span></span></code></pre></div><ul><li>Intentamos conectarnos a la base de datos que acabamos de crear desde nuestra
máquina local.</li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-bash data-lang=bash><span style=display:flex><span>serjaii@db:~$ psql -h localhost -p <span style=color:#ae81ff>5432</span> -U sergio -d prueba_db
</span></span></code></pre></div><h3 id=5instalación-y-configuración-del-cliente-de-postgresql>5.Instalación y configuración del cliente de PostgreSQL.</h3><ul><li>Actualizamos los paquetes del sistema para evitar posibles conflictos durante la
instalación del cliente de PostgreSQL.</li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-bash data-lang=bash><span style=display:flex><span>serjaii@db:~$ sudo apt update
</span></span></code></pre></div><ul><li>Una vez actualizados los paquetes del sistema, vamos a ejecutar el siguiente
comando, para instalar el cliente de postgreSQL.</li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-bash data-lang=bash><span style=display:flex><span>serjaii@db:~$ sudo apt install postgresql-client -y
</span></span></code></pre></div><ul><li>Comprobamos que podemos acceder al servidor de PostgreSQL remotamente.</li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-bash data-lang=bash><span style=display:flex><span>serjaii@db:~$ psql -h 192.168.122.79 -p <span style=color:#ae81ff>5432</span> -U sergio -d prueba_db
</span></span></code></pre></div><h3 id=6creación-de-base-de-datos-con-tablas-y-datos-en-postgresql>6.Creación de base de datos con tablas y datos en PostgreSQL.</h3><ul><li>Accedemos al servidor de PostgreSQL desde la misma máquina donde se
encuentra instalado, accediendo como superusuario a la base de datos.</li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-bash data-lang=bash><span style=display:flex><span>serjaii@db:~$ sudo -u postgres psql
</span></span></code></pre></div><ul><li>Creamos la base de datos, el usuario con el vamos a acceder a la base de datos
y dotamos de los privilegios necesarios para que ese usuario pueda acceder a
los datos de la base de datos.</li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-bash data-lang=bash><span style=display:flex><span>postgres<span style=color:#f92672>=</span><span style=color:#75715e># CREATE DATABASE hotel;</span>
</span></span><span style=display:flex><span>postgres<span style=color:#f92672>=</span><span style=color:#75715e># CREATE USER sergio WITH PASSWORD</span>
</span></span><span style=display:flex><span><span style=color:#e6db74>&#39;sergio&#39;</span>;
</span></span><span style=display:flex><span>postgres<span style=color:#f92672>=</span><span style=color:#75715e># GRANT ALL PRIVILEGES ON DATABASE</span>
</span></span><span style=display:flex><span>hotel TO sergio;
</span></span><span style=display:flex><span>hotel<span style=color:#f92672>=</span><span style=color:#75715e># GRANT ALL PRIVILEGES ON ALL TABLES IN</span>
</span></span><span style=display:flex><span>SCHEMA public TO sergio;
</span></span><span style=display:flex><span>hotel<span style=color:#f92672>=</span><span style=color:#75715e># GRANT ALL PRIVILEGES ON ALL SEQUENCES IN</span>
</span></span><span style=display:flex><span>SCHEMA public TO sergio;
</span></span><span style=display:flex><span>hotel<span style=color:#f92672>=</span><span style=color:#75715e># ALTER DEFAULT PRIVILEGES IN SCHEMA public</span>
</span></span><span style=display:flex><span>GRANT ALL PRIVILEGES ON TABLES TO sergio;
</span></span><span style=display:flex><span>hotel<span style=color:#f92672>=</span><span style=color:#75715e># ALTER DEFAULT PRIVILEGES IN SCHEMA public</span>
</span></span><span style=display:flex><span>GRANT ALL PRIVILEGES ON SEQUENCES TO sergio;
</span></span></code></pre></div><ul><li>Desde el cliente remoto accedemos a la base de datos que acabamos de crear
con el usuario que hemos creado también ahora, y comenzamos con la creación
de tablas e inserción de datos.</li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-bash data-lang=bash><span style=display:flex><span>serjaii@db:~$ psql -h IP_ServidorPostgreSQL -p <span style=color:#ae81ff>5432</span> -U nombreUsuarioPostgreSQL -d baseDatosPostgreSQL 
</span></span><span style=display:flex><span>-- Creación de la tabla clientes.
</span></span><span style=display:flex><span>-- Creación de la tabla clientes.
</span></span><span style=display:flex><span>CREATE TABLE clientes<span style=color:#f92672>(</span>
</span></span><span style=display:flex><span>    id NUMERIC,
</span></span><span style=display:flex><span>    nombre VARCHAR<span style=color:#f92672>(</span>15<span style=color:#f92672>)</span> NOT NULL,
</span></span><span style=display:flex><span>    apellidos VARCHAR<span style=color:#f92672>(</span>30<span style=color:#f92672>)</span> NOT NULL,
</span></span><span style=display:flex><span>    email VARCHAR<span style=color:#f92672>(</span>50<span style=color:#f92672>)</span>,
</span></span><span style=display:flex><span>    telefono NUMERIC<span style=color:#f92672>(</span>9<span style=color:#f92672>)</span>,
</span></span><span style=display:flex><span>    CONSTRAINT pk_idCliente PRIMARY KEY <span style=color:#f92672>(</span>id<span style=color:#f92672>)</span>,
</span></span><span style=display:flex><span>    CONSTRAINT uq_email UNIQUE <span style=color:#f92672>(</span>email<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span><span style=color:#f92672>)</span>;
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>-- Creación de la tabla habitaciones.
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>CREATE TABLE habitaciones<span style=color:#f92672>(</span> id NUMERIC, numero NUMERIC NOT NULL, tipo VARCHAR<span style=color:#f92672>(</span>20<span style=color:#f92672>)</span> NOT NULL, precio NUMERIC<span style=color:#f92672>(</span>10,2<span style=color:#f92672>)</span> NOT NULL, 
</span></span><span style=display:flex><span>  CONSTRAINT pk_idHabitacion PRIMARY KEY <span style=color:#f92672>(</span>id<span style=color:#f92672>)</span>, 
</span></span><span style=display:flex><span>  CONSTRAINT uq_numero UNIQUE <span style=color:#f92672>(</span>numero<span style=color:#f92672>)</span>, 
</span></span><span style=display:flex><span>  CONSTRAINT ck_tipoHabitacion CHECK <span style=color:#f92672>(</span>tipo IN <span style=color:#f92672>(</span><span style=color:#e6db74>&#39;Individual&#39;</span>, <span style=color:#e6db74>&#39;Doble&#39;</span>, <span style=color:#e6db74>&#39;Suite&#39;</span>, <span style=color:#e6db74>&#39;Familiar&#39;</span><span style=color:#f92672>))</span> <span style=color:#f92672>)</span>;
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>-- Creación de la tabla reservas.
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>CREATE TABLE reservas<span style=color:#f92672>(</span> id NUMERIC, idCliente NUMERIC NOT NULL, idHabitacion NUMERIC NOT NULL, fecha_entrada DATE NOT NULL, fecha_salida DATE NOT NULL, 
</span></span><span style=display:flex><span>  CONSTRAINT pk_idReservas PRIMARY KEY <span style=color:#f92672>(</span>id<span style=color:#f92672>)</span>, 
</span></span><span style=display:flex><span>  CONSTRAINT fk_idCliente FOREIGN KEY <span style=color:#f92672>(</span>idCliente<span style=color:#f92672>)</span> REFERENCES clientes<span style=color:#f92672>(</span>id<span style=color:#f92672>)</span>, 
</span></span><span style=display:flex><span>  CONSTRAINT fk_idHabitacion FOREIGN KEY <span style=color:#f92672>(</span>idHabitacion<span style=color:#f92672>)</span> REFERENCES habitaciones<span style=color:#f92672>(</span>id<span style=color:#f92672>)</span> <span style=color:#f92672>)</span>;
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>-- Creación de la tabla pagos.
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>CREATE TABLE pagos<span style=color:#f92672>(</span> id NUMERIC, idReserva NUMERIC NOT NULL, metodoPago VARCHAR<span style=color:#f92672>(</span>20<span style=color:#f92672>)</span> NOT NULL, precio NUMERIC<span style=color:#f92672>(</span>10,2<span style=color:#f92672>)</span> NOT NULL, fechaPago DATE NOT NULL, 
</span></span><span style=display:flex><span>  CONSTRAINT pk_idPagos PRIMARY KEY <span style=color:#f92672>(</span>id<span style=color:#f92672>)</span>, 
</span></span><span style=display:flex><span>  CONSTRAINT fk_idReserva FOREIGN KEY <span style=color:#f92672>(</span>idReserva<span style=color:#f92672>)</span> REFERENCES reservas<span style=color:#f92672>(</span>id<span style=color:#f92672>)</span>, 
</span></span><span style=display:flex><span>  CONSTRAINT ck_metodoPago CHECK <span style=color:#f92672>(</span>metodoPago IN <span style=color:#f92672>(</span><span style=color:#e6db74>&#39;Tarjeta&#39;</span>, <span style=color:#e6db74>&#39;Efectivo&#39;</span>, <span style=color:#e6db74>&#39;PayPal&#39;</span><span style=color:#f92672>))</span> <span style=color:#f92672>)</span>;
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>-- Inserción de datos en la tabla clientes.
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>INSERT INTO clientes <span style=color:#f92672>(</span>id, nombre, apellidos, email, telefono<span style=color:#f92672>)</span> VALUES <span style=color:#f92672>(</span>1, <span style=color:#e6db74>&#39;David&#39;</span>, <span style=color:#e6db74>&#39;Dorado Lopez&#39;</span>, <span style=color:#e6db74>&#39;davidd@gmail.com&#39;</span>, 600111222<span style=color:#f92672>)</span>;
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>INSERT INTO clientes <span style=color:#f92672>(</span>id, nombre, apellidos, email, telefono<span style=color:#f92672>)</span> VALUES <span style=color:#f92672>(</span>2, <span style=color:#e6db74>&#39;Maria&#39;</span>, <span style=color:#e6db74>&#39;Gomez Perez&#39;</span>, <span style=color:#e6db74>&#39;mariagom@gmail.com&#39;</span>, 600333444<span style=color:#f92672>)</span>;
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>INSERT INTO clientes <span style=color:#f92672>(</span>id, nombre, apellidos, email, telefono<span style=color:#f92672>)</span> VALUES <span style=color:#f92672>(</span>3, <span style=color:#e6db74>&#39;Jorge&#39;</span>, <span style=color:#e6db74>&#39;Santos Diaz&#39;</span>, <span style=color:#e6db74>&#39;jogesantos@gmail.com&#39;</span>, 600555666<span style=color:#f92672>)</span>;
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>INSERT INTO clientes <span style=color:#f92672>(</span>id, nombre, apellidos, email, telefono<span style=color:#f92672>)</span> VALUES <span style=color:#f92672>(</span>4, <span style=color:#e6db74>&#39;Lucia&#39;</span>, <span style=color:#e6db74>&#39;Romero Garcia&#39;</span>, <span style=color:#e6db74>&#39;luciarom@yahoot.es&#39;</span>, 600777888<span style=color:#f92672>)</span>;
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>INSERT INTO clientes <span style=color:#f92672>(</span>id, nombre, apellidos, email, telefono<span style=color:#f92672>)</span> VALUES <span style=color:#f92672>(</span>5, <span style=color:#e6db74>&#39;Pablo&#39;</span>, <span style=color:#e6db74>&#39;Ruiz Torres&#39;</span>, <span style=color:#e6db74>&#39;pablo@gmail.com&#39;</span>, 600999000<span style=color:#f92672>)</span>;
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>INSERT INTO clientes <span style=color:#f92672>(</span>id, nombre, apellidos, email, telefono<span style=color:#f92672>)</span> VALUES <span style=color:#f92672>(</span>6, <span style=color:#e6db74>&#39;Sofia&#39;</span>, <span style=color:#e6db74>&#39;Martinez Leon&#39;</span>, <span style=color:#e6db74>&#39;sofleon@yahoot.es&#39;</span>, 601111222<span style=color:#f92672>)</span>;
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>INSERT INTO clientes <span style=color:#f92672>(</span>id, nombre, apellidos, email, telefono<span style=color:#f92672>)</span> VALUES <span style=color:#f92672>(</span>7, <span style=color:#e6db74>&#39;Alberto&#39;</span>, <span style=color:#e6db74>&#39;Navas Cruz&#39;</span>, <span style=color:#e6db74>&#39;albertonavas@yahoot.es&#39;</span>, 601333444<span style=color:#f92672>)</span>;
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>INSERT INTO clientes <span style=color:#f92672>(</span>id, nombre, apellidos, email, telefono<span style=color:#f92672>)</span> VALUES <span style=color:#f92672>(</span>8, <span style=color:#e6db74>&#39;Marta&#39;</span>, <span style=color:#e6db74>&#39;Lopez Gil&#39;</span>, <span style=color:#e6db74>&#39;marta@gmail.com&#39;</span>, 601555666<span style=color:#f92672>)</span>;
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>INSERT INTO clientes <span style=color:#f92672>(</span>id, nombre, apellidos, email, telefono<span style=color:#f92672>)</span> VALUES <span style=color:#f92672>(</span>9, <span style=color:#e6db74>&#39;Raul&#39;</span>, <span style=color:#e6db74>&#39;Castro Vega&#39;</span>, <span style=color:#e6db74>&#39;raulcastro@gmail.com&#39;</span>, 601777888<span style=color:#f92672>)</span>;
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>INSERT INTO clientes <span style=color:#f92672>(</span>id, nombre, apellidos, email, telefono<span style=color:#f92672>)</span> VALUES <span style=color:#f92672>(</span>10, <span style=color:#e6db74>&#39;Laura&#39;</span>, <span style=color:#e6db74>&#39;Morales Cano&#39;</span>, <span style=color:#e6db74>&#39;laura@gmail.com&#39;</span>, 601999000<span style=color:#f92672>)</span>;
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>-- Inserción de datos en la tabla habitaciones.
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>INSERT INTO habitaciones <span style=color:#f92672>(</span>id, numero, tipo, precio<span style=color:#f92672>)</span> VALUES <span style=color:#f92672>(</span>1, 101, <span style=color:#e6db74>&#39;Individual&#39;</span>, 50<span style=color:#f92672>)</span>;
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>INSERT INTO habitaciones <span style=color:#f92672>(</span>id, numero, tipo, precio<span style=color:#f92672>)</span> VALUES <span style=color:#f92672>(</span>2, 102, <span style=color:#e6db74>&#39;Doble&#39;</span>, 80<span style=color:#f92672>)</span>;
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>INSERT INTO habitaciones <span style=color:#f92672>(</span>id, numero, tipo, precio<span style=color:#f92672>)</span> VALUES <span style=color:#f92672>(</span>3, 103, <span style=color:#e6db74>&#39;Suite&#39;</span>, 150<span style=color:#f92672>)</span>;
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>INSERT INTO habitaciones <span style=color:#f92672>(</span>id, numero, tipo, precio<span style=color:#f92672>)</span> VALUES <span style=color:#f92672>(</span>4, 104, <span style=color:#e6db74>&#39;Individual&#39;</span>, 50<span style=color:#f92672>)</span>;
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>INSERT INTO habitaciones <span style=color:#f92672>(</span>id, numero, tipo, precio<span style=color:#f92672>)</span> VALUES <span style=color:#f92672>(</span>5, 105, <span style=color:#e6db74>&#39;Doble&#39;</span>, 80<span style=color:#f92672>)</span>;
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>INSERT INTO habitaciones <span style=color:#f92672>(</span>id, numero, tipo, precio<span style=color:#f92672>)</span> VALUES <span style=color:#f92672>(</span>6, 106, <span style=color:#e6db74>&#39;Suite&#39;</span>, 150<span style=color:#f92672>)</span>;
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>-- Inserción de datos en la tabla reservas.
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>INSERT INTO reservas <span style=color:#f92672>(</span>id, idCliente, idHabitacion, fecha_entrada, fecha_salida<span style=color:#f92672>)</span> VALUES <span style=color:#f92672>(</span>1, 1, 1, TO_DATE<span style=color:#f92672>(</span><span style=color:#e6db74>&#39;2025-10-01&#39;</span>, <span style=color:#e6db74>&#39;YYYY-MM-DD&#39;</span><span style=color:#f92672>)</span>, TO_DATE<span style=color:#f92672>(</span><span style=color:#e6db74>&#39;2025-10-05&#39;</span>, <span style=color:#e6db74>&#39;YYYY-MM-DD&#39;</span><span style=color:#f92672>))</span>;
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>INSERT INTO reservas <span style=color:#f92672>(</span>id, idCliente, idHabitacion, fecha_entrada, fecha_salida<span style=color:#f92672>)</span> VALUES <span style=color:#f92672>(</span>2, 2, 2, TO_DATE<span style=color:#f92672>(</span><span style=color:#e6db74>&#39;2025-10-03&#39;</span>, <span style=color:#e6db74>&#39;YYYY-MM-DD&#39;</span><span style=color:#f92672>)</span>, TO_DATE<span style=color:#f92672>(</span><span style=color:#e6db74>&#39;2025-10-06&#39;</span>, <span style=color:#e6db74>&#39;YYYY-MM-DD&#39;</span><span style=color:#f92672>))</span>;
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>INSERT INTO reservas <span style=color:#f92672>(</span>id, idCliente, idHabitacion, fecha_entrada, fecha_salida<span style=color:#f92672>)</span> TO_DATE<span style=color:#f92672>(</span><span style=color:#e6db74>&#39;2025-10-02&#39;</span>, TO_DATE<span style=color:#f92672>(</span><span style=color:#e6db74>&#39;2025-10-04&#39;</span>, VALUES <span style=color:#f92672>(</span>3, 3, 3, <span style=color:#e6db74>&#39;YYYY-MM-DD&#39;</span><span style=color:#f92672>)</span>, <span style=color:#e6db74>&#39;YYYY-MM-DD&#39;</span><span style=color:#f92672>))</span>;
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>INSERT INTO reservas <span style=color:#f92672>(</span>id, idCliente, idHabitacion, fecha_entrada, fecha_salida<span style=color:#f92672>)</span> VALUES <span style=color:#f92672>(</span>4, 4, 4, TO_DATE<span style=color:#f92672>(</span><span style=color:#e6db74>&#39;2025-10-05&#39;</span>, <span style=color:#e6db74>&#39;YYYY-MM-DD&#39;</span><span style=color:#f92672>)</span>, TO_DATE<span style=color:#f92672>(</span><span style=color:#e6db74>&#39;2025-10-10&#39;</span>, <span style=color:#e6db74>&#39;YYYY-MM-DD&#39;</span><span style=color:#f92672>))</span>;
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>INSERT INTO reservas <span style=color:#f92672>(</span>id, idCliente, idHabitacion, fecha_entrada, fecha_salida<span style=color:#f92672>)</span> VALUES <span style=color:#f92672>(</span>5, 5, 5, TO_DATE<span style=color:#f92672>(</span><span style=color:#e6db74>&#39;2025-10-07&#39;</span>, <span style=color:#e6db74>&#39;YYYY-MM-DD&#39;</span><span style=color:#f92672>)</span>, TO_DATE<span style=color:#f92672>(</span><span style=color:#e6db74>&#39;2025-10-12&#39;</span>, <span style=color:#e6db74>&#39;YYYY-MM-DD&#39;</span><span style=color:#f92672>))</span>;
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>INSERT INTO reservas <span style=color:#f92672>(</span>id, idCliente, idHabitacion, fecha_entrada, fecha_salida<span style=color:#f92672>)</span> VALUES <span style=color:#f92672>(</span>6, 6, 6, TO_DATE<span style=color:#f92672>(</span><span style=color:#e6db74>&#39;2025-10-01&#39;</span>, <span style=color:#e6db74>&#39;YYYY-MM-DD&#39;</span><span style=color:#f92672>)</span>, TO_DATE<span style=color:#f92672>(</span><span style=color:#e6db74>&#39;2025-10-03&#39;</span>, <span style=color:#e6db74>&#39;YYYY-MM-DD&#39;</span><span style=color:#f92672>))</span>;
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>-- Inserción de datos en la tabla pagos.
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>INSERT INTO pagos <span style=color:#f92672>(</span>id, idReserva, metodoPago, precio, fechaPago<span style=color:#f92672>)</span> VALUES <span style=color:#f92672>(</span>1, 1, <span style=color:#e6db74>&#39;Tarjeta&#39;</span>, 200, TO_DATE<span style=color:#f92672>(</span><span style=color:#e6db74>&#39;2025-10-01&#39;</span>, <span style=color:#e6db74>&#39;YYYY-MM-DD&#39;</span><span style=color:#f92672>))</span>;
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>INSERT INTO pagos <span style=color:#f92672>(</span>id, idReserva, metodoPago, precio, fechaPago<span style=color:#f92672>)</span> VALUES <span style=color:#f92672>(</span>2, 2, <span style=color:#e6db74>&#39;Efectivo&#39;</span>, 240, TO_DATE<span style=color:#f92672>(</span><span style=color:#e6db74>&#39;2025-10-03&#39;</span>, <span style=color:#e6db74>&#39;YYYY-MM-DD&#39;</span><span style=color:#f92672>))</span>;
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>INSERT INTO pagos <span style=color:#f92672>(</span>id, idReserva, metodoPago, precio, fechaPago<span style=color:#f92672>)</span> VALUES <span style=color:#f92672>(</span>3, 3, <span style=color:#e6db74>&#39;PayPal&#39;</span>, 300, TO_DATE<span style=color:#f92672>(</span><span style=color:#e6db74>&#39;2025-10-02&#39;</span>, <span style=color:#e6db74>&#39;YYYY-MM-DD&#39;</span><span style=color:#f92672>))</span>;
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>INSERT INTO pagos <span style=color:#f92672>(</span>id, idReserva, metodoPago, precio, fechaPago<span style=color:#f92672>)</span> VALUES <span style=color:#f92672>(</span>4, 4, <span style=color:#e6db74>&#39;Tarjeta&#39;</span>, 400, TO_DATE<span style=color:#f92672>(</span><span style=color:#e6db74>&#39;2025-10-05&#39;</span>, <span style=color:#e6db74>&#39;YYYY-MM-DD&#39;</span><span style=color:#f92672>))</span>;
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>INSERT INTO pagos <span style=color:#f92672>(</span>id, idReserva, metodoPago, precio, fechaPago<span style=color:#f92672>)</span> VALUES <span style=color:#f92672>(</span>5, 5, <span style=color:#e6db74>&#39;Efectivo&#39;</span>, 320, TO_DATE<span style=color:#f92672>(</span><span style=color:#e6db74>&#39;2025-10-07&#39;</span>, <span style=color:#e6db74>&#39;YYYY-MM-DD&#39;</span><span style=color:#f92672>))</span>;
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>INSERT INTO pagos <span style=color:#f92672>(</span>id, idReserva, metodoPago, precio, fechaPago<span style=color:#f92672>)</span> VALUES <span style=color:#f92672>(</span>6, 6, <span style=color:#e6db74>&#39;PayPal&#39;</span>, 150, TO_DATE<span style=color:#f92672>(</span><span style=color:#e6db74>&#39;2025-10-01&#39;</span>, <span style=color:#e6db74>&#39;YYYY-MM-DD&#39;</span><span style=color:#f92672>))</span>;
</span></span></code></pre></div><h2 id=instalación-servidor-mysql-en-debian-13>Instalación Servidor MySQL en Debian 13.</h2><h3 id=1instalación-del-servidor>1.Instalación del servidor</h3><ul><li>Primero vamos a actualizar el sistema y comprobar que no tenga
actualizaciones, para que no de error al instalar los nuevos paquetes del
servidor mariaDB.</li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-bash data-lang=bash><span style=display:flex><span>serjaii@db:~$ sudo apt update
</span></span></code></pre></div><ul><li>Una vez actualizados los paquetes del sistema, vamos a ejecutar el siguiente
comando, para instalar “mariaDB”.</li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-bash data-lang=bash><span style=display:flex><span>serjaii@db:~$ sudo apt install mariadb-server -y
</span></span></code></pre></div><ul><li>Comprobamos que se ha instalado correctamente el servidor de MariaDB y que
está levantado.</li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-bash data-lang=bash><span style=display:flex><span>serjaii@db:~$ sudo systemctl status mariadb
</span></span></code></pre></div><ul><li>Ejecutamos el siguiente comando para que se inicie el servidor mariadb cada
vez que iniciemos la máquina.</li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-bash data-lang=bash><span style=display:flex><span>serjaii@db:~$ sudo systemctl enable mariadb
</span></span></code></pre></div><ul><li>Comprobamos que podemos entrar en MySQL.</li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-bash data-lang=bash><span style=display:flex><span>serjaii@db:~$ sudo mysql -u root -p
</span></span></code></pre></div><h3 id=2configuración-del-servidor-mysql-para-la-conexión-remota>2.Configuración del servidor MySQL para la conexión remota.</h3><ul><li>Modificamos el fichero “/etc/mysql/mariadb.conf.d/50-server.cnf”, para
permitir conexiones remotas al servidor mariaDB, modificamos la línea “bindaddress”, para permitir que pueda tener conexión remota. Una vez modificado
esto, guardamos los cambios y salimos.</li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-bash data-lang=bash><span style=display:flex><span>serjaii@db:~$ sudo nano /etc/mysql/mariadb.conf.d/50-server.cnf
</span></span></code></pre></div><ul><li>Reiniciamos el servidor para que se apliquen los cambios.</li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-bash data-lang=bash><span style=display:flex><span>serjaii@db:~$ sudo systemctl restart mariadb
</span></span></code></pre></div><h3 id=3crear-base-de-datos-de-prueba-usuario-y-conceder-permisos>3.Crear base de datos de prueba, usuario y conceder permisos</h3><p>en MySQL.</p><ul><li>Entramos en Mysql.</li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-bash data-lang=bash><span style=display:flex><span>serjaii@db:~$ sudo mysql -u root -p
</span></span></code></pre></div><ul><li>Creamos un usuario con contraseña.</li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-sql data-lang=sql><span style=display:flex><span>MariaDB [(<span style=color:#66d9ef>none</span>)]<span style=color:#f92672>&gt;</span> <span style=color:#66d9ef>CREATE</span> <span style=color:#66d9ef>USER</span> <span style=color:#e6db74>&#39;sergio&#39;</span><span style=color:#f92672>@</span><span style=color:#e6db74>&#39;%&#39;</span> IDENTIFIED <span style=color:#66d9ef>BY</span> <span style=color:#e6db74>&#39;sergio&#39;</span>;
</span></span><span style=display:flex><span>MariaDB [(<span style=color:#66d9ef>none</span>)]<span style=color:#f92672>&gt;</span> <span style=color:#66d9ef>GRANT</span> <span style=color:#66d9ef>ALL</span> <span style=color:#66d9ef>PRIVILEGES</span> <span style=color:#66d9ef>ON</span> <span style=color:#f92672>*</span>.<span style=color:#f92672>*</span> <span style=color:#66d9ef>TO</span> <span style=color:#e6db74>&#39;sergio&#39;</span><span style=color:#f92672>@</span><span style=color:#e6db74>&#39;%&#39;</span> <span style=color:#66d9ef>WITH</span> <span style=color:#66d9ef>GRANT</span> <span style=color:#66d9ef>OPTION</span>;
</span></span></code></pre></div><ul><li>Probamos que podemos conectarnos con el usuario que acabamos de crear
desde nuestra propia máquina local.</li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-bash data-lang=bash><span style=display:flex><span>serjaii@db:~$ sudo mysql -h localhost -P <span style=color:#ae81ff>3306</span> -u sergio -p
</span></span></code></pre></div><h3 id=4instalación-y-configuración-del-cliente-de-mysql>4.Instalación y configuración del cliente de MySQL.</h3><ul><li>Actualizamos los paquetes del sistema para evitar conflictos durante la
instalación del cliente de MySQL.</li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-bash data-lang=bash><span style=display:flex><span>serjaii@db:~$ sudo apt update
</span></span></code></pre></div><ul><li>Instalamos el cliente de MySQL.</li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-bash data-lang=bash><span style=display:flex><span>serjaii@db:~$ sudo apt install mariadb-client -y
</span></span></code></pre></div><ul><li>Probamos a conectarnos al servidor de MySQL, desde el cliente.</li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-bash data-lang=bash><span style=display:flex><span>serjaii@db:~$ mysql -h 192.168.122.79 -P <span style=color:#ae81ff>3306</span> -u sergio -p
</span></span></code></pre></div><h3 id=5creación-de-base-de-datos-con-tablas-y-datos-en-mysql>5.Creación de base de datos con tablas y datos en MySQL.</h3><ul><li>Accedemos al servidor de MySQL desde la misma máquina donde se encuentra
instalado, accediendo como superusuario a la base de datos.</li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-bash data-lang=bash><span style=display:flex><span>serjaii@db:~$ sudo mysql -u root -p
</span></span></code></pre></div><ul><li>Creamos la base de datos, el usuario con el vamos a acceder a la base de datos
y dotamos de los privilegios necesarios para que ese usuario pueda acceder a
los datos de la base de datos.</li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-sql data-lang=sql><span style=display:flex><span>MariaDB [(<span style=color:#66d9ef>none</span>)]<span style=color:#f92672>&gt;</span> <span style=color:#66d9ef>CREATE</span> <span style=color:#66d9ef>DATABASE</span> hotel;
</span></span><span style=display:flex><span>MariaDB [(<span style=color:#66d9ef>none</span>)]<span style=color:#f92672>&gt;</span> <span style=color:#66d9ef>CREATE</span> <span style=color:#66d9ef>USER</span> <span style=color:#e6db74>&#39;sergio&#39;</span><span style=color:#f92672>@</span><span style=color:#e6db74>&#39;%&#39;</span> IDENTIFIED <span style=color:#66d9ef>BY</span> <span style=color:#e6db74>&#39;sergio&#39;</span>;
</span></span><span style=display:flex><span>MariaDB [(<span style=color:#66d9ef>none</span>)]<span style=color:#f92672>&gt;</span> <span style=color:#66d9ef>GRANT</span> <span style=color:#66d9ef>ALL</span> <span style=color:#66d9ef>PRIVILEGES</span> <span style=color:#66d9ef>ON</span> hotel.<span style=color:#f92672>*</span> <span style=color:#66d9ef>TO</span> <span style=color:#e6db74>&#39;sergio&#39;</span><span style=color:#f92672>@</span><span style=color:#e6db74>&#39;%&#39;</span>;
</span></span><span style=display:flex><span>MariaDB [(<span style=color:#66d9ef>none</span>)]<span style=color:#f92672>&gt;</span> FLUSH <span style=color:#66d9ef>PRIVILEGES</span>;
</span></span><span style=display:flex><span>serjaii<span style=color:#f92672>@</span>db:<span style=color:#f92672>~</span><span style=color:#960050;background-color:#1e0010>$</span> mysql <span style=color:#f92672>-</span>h IP_SERVIDOR_MYSQL <span style=color:#f92672>-</span>P <span style=color:#ae81ff>3306</span> <span style=color:#f92672>-</span>u usuario <span style=color:#f92672>-</span>p 
</span></span><span style=display:flex><span>MariaDB [(<span style=color:#66d9ef>none</span>)]<span style=color:#f92672>&gt;</span>  
</span></span><span style=display:flex><span>USE hotel;
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span><span style=color:#75715e>-- Creación de la tabla clientes.
</span></span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span><span style=color:#66d9ef>CREATE</span> <span style=color:#66d9ef>TABLE</span> clientes( id NUMERIC, nombre VARCHAR(<span style=color:#ae81ff>15</span>) <span style=color:#66d9ef>NOT</span> <span style=color:#66d9ef>NULL</span>, apellidos VARCHAR(<span style=color:#ae81ff>30</span>) <span style=color:#66d9ef>NOT</span> <span style=color:#66d9ef>NULL</span>, email VARCHAR(<span style=color:#ae81ff>50</span>), telefono NUMERIC(<span style=color:#ae81ff>9</span>), 
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>CONSTRAINT</span> pk_idCliente <span style=color:#66d9ef>PRIMARY</span> <span style=color:#66d9ef>KEY</span> (id), 
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>CONSTRAINT</span> uq_email <span style=color:#66d9ef>UNIQUE</span> (email) );
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span><span style=color:#75715e>-- Creación de la tabla habitaciones.
</span></span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span><span style=color:#66d9ef>CREATE</span> <span style=color:#66d9ef>TABLE</span> habitaciones( id NUMERIC, numero NUMERIC <span style=color:#66d9ef>NOT</span> <span style=color:#66d9ef>NULL</span>, tipo VARCHAR(<span style=color:#ae81ff>20</span>) <span style=color:#66d9ef>NOT</span> <span style=color:#66d9ef>NULL</span>, precio NUMERIC(<span style=color:#ae81ff>10</span>,<span style=color:#ae81ff>2</span>) <span style=color:#66d9ef>NOT</span> <span style=color:#66d9ef>NULL</span>, 
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>CONSTRAINT</span> pk_idHabitacion <span style=color:#66d9ef>PRIMARY</span> <span style=color:#66d9ef>KEY</span> (id), 
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>CONSTRAINT</span> uq_numero <span style=color:#66d9ef>UNIQUE</span> (numero), 
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>CONSTRAINT</span> ck_tipoHabitacion <span style=color:#66d9ef>CHECK</span> (tipo <span style=color:#66d9ef>IN</span> (<span style=color:#e6db74>&#39;Individual&#39;</span>, <span style=color:#e6db74>&#39;Doble&#39;</span>, <span style=color:#e6db74>&#39;Suite&#39;</span>, <span style=color:#e6db74>&#39;Familiar&#39;</span>)) );
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span><span style=color:#75715e>-- Creación de la tabla reservas.
</span></span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span><span style=color:#66d9ef>CREATE</span> <span style=color:#66d9ef>TABLE</span> reservas( id NUMERIC, idCliente NUMERIC <span style=color:#66d9ef>NOT</span> <span style=color:#66d9ef>NULL</span>, idHabitacion NUMERIC <span style=color:#66d9ef>NOT</span> <span style=color:#66d9ef>NULL</span>, fecha_entrada DATE <span style=color:#66d9ef>NOT</span> <span style=color:#66d9ef>NULL</span>, fecha_salida DATE <span style=color:#66d9ef>NOT</span> <span style=color:#66d9ef>NULL</span>, 
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>CONSTRAINT</span> pk_idReservas <span style=color:#66d9ef>PRIMARY</span> <span style=color:#66d9ef>KEY</span> (id), 
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>CONSTRAINT</span> fk_idCliente <span style=color:#66d9ef>FOREIGN</span> <span style=color:#66d9ef>KEY</span> (idCliente) <span style=color:#66d9ef>REFERENCES</span> clientes(id), 
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>CONSTRAINT</span> fk_idHabitacion <span style=color:#66d9ef>FOREIGN</span> <span style=color:#66d9ef>KEY</span> (idHabitacion) <span style=color:#66d9ef>REFERENCES</span> habitaciones(id) );
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span><span style=color:#75715e>-- Creación de la tabla pagos.
</span></span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span><span style=color:#66d9ef>CREATE</span> <span style=color:#66d9ef>TABLE</span> pagos( id NUMERIC, idReserva NUMERIC <span style=color:#66d9ef>NOT</span> <span style=color:#66d9ef>NULL</span>, metodoPago VARCHAR(<span style=color:#ae81ff>20</span>) <span style=color:#66d9ef>NOT</span> <span style=color:#66d9ef>NULL</span>, precio NUMERIC(<span style=color:#ae81ff>10</span>,<span style=color:#ae81ff>2</span>) <span style=color:#66d9ef>NOT</span> <span style=color:#66d9ef>NULL</span>, fechaPago DATE <span style=color:#66d9ef>NOT</span> <span style=color:#66d9ef>NULL</span>, 
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>CONSTRAINT</span> pk_idPagos <span style=color:#66d9ef>PRIMARY</span> <span style=color:#66d9ef>KEY</span> (id), 
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>CONSTRAINT</span> fk_idReserva <span style=color:#66d9ef>FOREIGN</span> <span style=color:#66d9ef>KEY</span> (idReserva) <span style=color:#66d9ef>REFERENCES</span> reservas(id), 
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>CONSTRAINT</span> ck_metodoPago <span style=color:#66d9ef>CHECK</span> (metodoPago <span style=color:#66d9ef>IN</span> (<span style=color:#e6db74>&#39;Tarjeta&#39;</span>, <span style=color:#e6db74>&#39;Efectivo&#39;</span>, <span style=color:#e6db74>&#39;PayPal&#39;</span>)) );
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span><span style=color:#75715e>-- Inserción de datos en la tabla clientes.
</span></span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span><span style=color:#66d9ef>INSERT</span> <span style=color:#66d9ef>INTO</span> clientes (id, nombre, apellidos, email, telefono) <span style=color:#66d9ef>VALUES</span> (<span style=color:#ae81ff>1</span>, <span style=color:#e6db74>&#39;David&#39;</span>, <span style=color:#e6db74>&#39;Dorado Lopez&#39;</span>, <span style=color:#e6db74>&#39;davidd@gmail.com&#39;</span>, <span style=color:#ae81ff>600111222</span>);
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span><span style=color:#66d9ef>INSERT</span> <span style=color:#66d9ef>INTO</span> clientes (id, nombre, apellidos, email, telefono) <span style=color:#66d9ef>VALUES</span> (<span style=color:#ae81ff>2</span>, <span style=color:#e6db74>&#39;Maria&#39;</span>, <span style=color:#e6db74>&#39;Gomez Perez&#39;</span>, <span style=color:#e6db74>&#39;mariagom@gmail.com&#39;</span>, <span style=color:#ae81ff>600333444</span>);
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span><span style=color:#66d9ef>INSERT</span> <span style=color:#66d9ef>INTO</span> clientes (id, nombre, apellidos, email, telefono) <span style=color:#66d9ef>VALUES</span> (<span style=color:#ae81ff>3</span>, <span style=color:#e6db74>&#39;Jorge&#39;</span>, <span style=color:#e6db74>&#39;Santos Diaz&#39;</span>, <span style=color:#e6db74>&#39;jogesantos@gmail.com&#39;</span>, <span style=color:#ae81ff>600555666</span>);
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span><span style=color:#66d9ef>INSERT</span> <span style=color:#66d9ef>INTO</span> clientes (id, nombre, apellidos, email, telefono) <span style=color:#66d9ef>VALUES</span> (<span style=color:#ae81ff>4</span>, <span style=color:#e6db74>&#39;Lucia&#39;</span>, <span style=color:#e6db74>&#39;Romero Garcia&#39;</span>, <span style=color:#e6db74>&#39;luciarom@yahoot.es&#39;</span>, <span style=color:#ae81ff>600777888</span>);
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span><span style=color:#66d9ef>INSERT</span> <span style=color:#66d9ef>INTO</span> clientes (id, nombre, apellidos, email, telefono) <span style=color:#66d9ef>VALUES</span> (<span style=color:#ae81ff>5</span>, <span style=color:#e6db74>&#39;Pablo&#39;</span>, <span style=color:#e6db74>&#39;Ruiz Torres&#39;</span>, <span style=color:#e6db74>&#39;pablo@gmail.com&#39;</span>, <span style=color:#ae81ff>600999000</span>);
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span><span style=color:#66d9ef>INSERT</span> <span style=color:#66d9ef>INTO</span> clientes (id, nombre, apellidos, email, telefono) <span style=color:#66d9ef>VALUES</span> (<span style=color:#ae81ff>6</span>, <span style=color:#e6db74>&#39;Sofia&#39;</span>, <span style=color:#e6db74>&#39;Martinez Leon&#39;</span>, <span style=color:#e6db74>&#39;sofleon@yahoot.es&#39;</span>, <span style=color:#ae81ff>601111222</span>);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>INSERT</span> <span style=color:#66d9ef>INTO</span> clientes (id, nombre, apellidos, email, telefono) <span style=color:#66d9ef>VALUES</span> (<span style=color:#ae81ff>7</span>, <span style=color:#e6db74>&#39;Alberto&#39;</span>, <span style=color:#e6db74>&#39;Navas Cruz&#39;</span>, <span style=color:#e6db74>&#39;albertonavas@yahoot.es&#39;</span>, <span style=color:#ae81ff>601333444</span>);
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span><span style=color:#66d9ef>INSERT</span> <span style=color:#66d9ef>INTO</span> clientes (id, nombre, apellidos, email, telefono) <span style=color:#66d9ef>VALUES</span> (<span style=color:#ae81ff>8</span>, <span style=color:#e6db74>&#39;Marta&#39;</span>, <span style=color:#e6db74>&#39;Lopez Gil&#39;</span>, <span style=color:#e6db74>&#39;marta@gmail.com&#39;</span>, <span style=color:#ae81ff>601555666</span>);
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span><span style=color:#66d9ef>INSERT</span> <span style=color:#66d9ef>INTO</span> clientes (id, nombre, apellidos, email, telefono) <span style=color:#66d9ef>VALUES</span> (<span style=color:#ae81ff>9</span>, <span style=color:#e6db74>&#39;Raul&#39;</span>, <span style=color:#e6db74>&#39;Castro Vega&#39;</span>, <span style=color:#e6db74>&#39;raulcastro@gmail.com&#39;</span>, <span style=color:#ae81ff>601777888</span>);
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span><span style=color:#66d9ef>INSERT</span> <span style=color:#66d9ef>INTO</span> clientes (id, nombre, apellidos, email, telefono) <span style=color:#66d9ef>VALUES</span> (<span style=color:#ae81ff>10</span>, <span style=color:#e6db74>&#39;Laura&#39;</span>, <span style=color:#e6db74>&#39;Morales Cano&#39;</span>, <span style=color:#e6db74>&#39;laura@gmail.com&#39;</span>, <span style=color:#ae81ff>601999000</span>);
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span><span style=color:#75715e>-- Inserción de datos en la tabla habitaciones.
</span></span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span><span style=color:#66d9ef>INSERT</span> <span style=color:#66d9ef>INTO</span> habitaciones (id, numero, tipo, precio) <span style=color:#66d9ef>VALUES</span> (<span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>101</span>, <span style=color:#e6db74>&#39;Individual&#39;</span>, <span style=color:#ae81ff>50</span>);
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span><span style=color:#66d9ef>INSERT</span> <span style=color:#66d9ef>INTO</span> habitaciones (id, numero, tipo, precio) <span style=color:#66d9ef>VALUES</span> (<span style=color:#ae81ff>2</span>, <span style=color:#ae81ff>102</span>, <span style=color:#e6db74>&#39;Doble&#39;</span>, <span style=color:#ae81ff>80</span>);
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span><span style=color:#66d9ef>INSERT</span> <span style=color:#66d9ef>INTO</span> habitaciones (id, numero, tipo, precio) <span style=color:#66d9ef>VALUES</span> (<span style=color:#ae81ff>3</span>, <span style=color:#ae81ff>103</span>, <span style=color:#e6db74>&#39;Suite&#39;</span>, <span style=color:#ae81ff>150</span>);
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span><span style=color:#66d9ef>INSERT</span> <span style=color:#66d9ef>INTO</span> habitaciones (id, numero, tipo, precio) <span style=color:#66d9ef>VALUES</span> (<span style=color:#ae81ff>4</span>, <span style=color:#ae81ff>104</span>, <span style=color:#e6db74>&#39;Individual&#39;</span>, <span style=color:#ae81ff>50</span>);
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span><span style=color:#66d9ef>INSERT</span> <span style=color:#66d9ef>INTO</span> habitaciones (id, numero, tipo, precio) <span style=color:#66d9ef>VALUES</span> (<span style=color:#ae81ff>5</span>, <span style=color:#ae81ff>105</span>, <span style=color:#e6db74>&#39;Doble&#39;</span>, <span style=color:#ae81ff>80</span>);
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span><span style=color:#66d9ef>INSERT</span> <span style=color:#66d9ef>INTO</span> habitaciones (id, numero, tipo, precio) <span style=color:#66d9ef>VALUES</span> (<span style=color:#ae81ff>6</span>, <span style=color:#ae81ff>106</span>, <span style=color:#e6db74>&#39;Suite&#39;</span>, <span style=color:#ae81ff>150</span>);
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span><span style=color:#75715e>-- Inserción de datos en la tabla reservas.
</span></span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span><span style=color:#66d9ef>INSERT</span> <span style=color:#66d9ef>INTO</span> reservas (id, idCliente, idHabitacion, fecha_entrada, fecha_salida) <span style=color:#66d9ef>VALUES</span> (<span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>1</span>, <span style=color:#e6db74>&#39;2025-10-01&#39;</span>, <span style=color:#e6db74>&#39;2025-10-05&#39;</span>);
</span></span><span style=display:flex><span><span style=color:#66d9ef>INSERT</span> <span style=color:#66d9ef>INTO</span> reservas (id, idCliente, idHabitacion, fecha_entrada, fecha_salida) <span style=color:#66d9ef>VALUES</span> (<span style=color:#ae81ff>2</span>, <span style=color:#ae81ff>2</span>, <span style=color:#ae81ff>2</span>, <span style=color:#e6db74>&#39;2025-10-03&#39;</span>, <span style=color:#e6db74>&#39;2025-10-06&#39;</span>);
</span></span><span style=display:flex><span><span style=color:#66d9ef>INSERT</span> <span style=color:#66d9ef>INTO</span> reservas (id, idCliente, idHabitacion, fecha_entrada, fecha_salida) <span style=color:#66d9ef>VALUES</span> (<span style=color:#ae81ff>3</span>, <span style=color:#ae81ff>3</span>, <span style=color:#ae81ff>3</span>, <span style=color:#e6db74>&#39;2025-10-02&#39;</span>, <span style=color:#e6db74>&#39;2025-10-04&#39;</span>);
</span></span><span style=display:flex><span><span style=color:#66d9ef>INSERT</span> <span style=color:#66d9ef>INTO</span> reservas (id, idCliente, idHabitacion, fecha_entrada, fecha_salida) <span style=color:#66d9ef>VALUES</span> (<span style=color:#ae81ff>4</span>, <span style=color:#ae81ff>4</span>, <span style=color:#ae81ff>4</span>, <span style=color:#e6db74>&#39;2025-10-05&#39;</span>, <span style=color:#e6db74>&#39;2025-10-10&#39;</span>);
</span></span><span style=display:flex><span><span style=color:#66d9ef>INSERT</span> <span style=color:#66d9ef>INTO</span> reservas (id, idCliente, idHabitacion, fecha_entrada, fecha_salida) <span style=color:#66d9ef>VALUES</span> (<span style=color:#ae81ff>5</span>, <span style=color:#ae81ff>5</span>, <span style=color:#ae81ff>5</span>, <span style=color:#e6db74>&#39;2025-10-07&#39;</span>, <span style=color:#e6db74>&#39;2025-10-12&#39;</span>);
</span></span><span style=display:flex><span><span style=color:#66d9ef>INSERT</span> <span style=color:#66d9ef>INTO</span> reservas (id, idCliente, idHabitacion, fecha_entrada, fecha_salida) <span style=color:#66d9ef>VALUES</span> (<span style=color:#ae81ff>6</span>, <span style=color:#ae81ff>6</span>, <span style=color:#ae81ff>6</span>, <span style=color:#e6db74>&#39;2025-10-01&#39;</span>, <span style=color:#e6db74>&#39;2025-10-03&#39;</span>);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>-- Inserción de datos en la tabla pagos.
</span></span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>INSERT</span> <span style=color:#66d9ef>INTO</span> pagos (id, idReserva, metodoPago, precio, fechaPago) <span style=color:#66d9ef>VALUES</span> (<span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>1</span>, <span style=color:#e6db74>&#39;Tarjeta&#39;</span>, <span style=color:#ae81ff>200</span>, <span style=color:#e6db74>&#39;2025-10-01&#39;</span>);
</span></span><span style=display:flex><span><span style=color:#66d9ef>INSERT</span> <span style=color:#66d9ef>INTO</span> pagos (id, idReserva, metodoPago, precio, fechaPago) <span style=color:#66d9ef>VALUES</span> (<span style=color:#ae81ff>2</span>, <span style=color:#ae81ff>2</span>, <span style=color:#e6db74>&#39;Efectivo&#39;</span>, <span style=color:#ae81ff>240</span>, <span style=color:#e6db74>&#39;2025-10-03&#39;</span>);
</span></span><span style=display:flex><span><span style=color:#66d9ef>INSERT</span> <span style=color:#66d9ef>INTO</span> pagos (id, idReserva, metodoPago, precio, fechaPago) <span style=color:#66d9ef>VALUES</span> (<span style=color:#ae81ff>3</span>, <span style=color:#ae81ff>3</span>, <span style=color:#e6db74>&#39;PayPal&#39;</span>, <span style=color:#ae81ff>300</span>, <span style=color:#e6db74>&#39;2025-10-02&#39;</span>);
</span></span><span style=display:flex><span><span style=color:#66d9ef>INSERT</span> <span style=color:#66d9ef>INTO</span> pagos (id, idReserva, metodoPago, precio, fechaPago) <span style=color:#66d9ef>VALUES</span> (<span style=color:#ae81ff>4</span>, <span style=color:#ae81ff>4</span>, <span style=color:#e6db74>&#39;Tarjeta&#39;</span>, <span style=color:#ae81ff>400</span>, <span style=color:#e6db74>&#39;2025-10-05&#39;</span>);
</span></span><span style=display:flex><span><span style=color:#66d9ef>INSERT</span> <span style=color:#66d9ef>INTO</span> pagos (id, idReserva, metodoPago, precio, fechaPago) <span style=color:#66d9ef>VALUES</span> (<span style=color:#ae81ff>5</span>, <span style=color:#ae81ff>5</span>, <span style=color:#e6db74>&#39;Efectivo&#39;</span>, <span style=color:#ae81ff>320</span>, <span style=color:#e6db74>&#39;2025-10-07&#39;</span>);
</span></span><span style=display:flex><span><span style=color:#66d9ef>INSERT</span> <span style=color:#66d9ef>INTO</span> pagos (id, idReserva, metodoPago, precio, fechaPago) <span style=color:#66d9ef>VALUES</span> (<span style=color:#ae81ff>6</span>, <span style=color:#ae81ff>6</span>, <span style=color:#e6db74>&#39;PayPal&#39;</span>, <span style=color:#ae81ff>150</span>, <span style=color:#e6db74>&#39;2025-10-01&#39;</span>);
</span></span></code></pre></div><ul><li>Comprobación de la creación de tablas e inserción de datos.</li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-bash data-lang=bash><span style=display:flex><span>SELECT * FROM clientes;
</span></span><span style=display:flex><span>MariaDB <span style=color:#f92672>[</span>hotel<span style=color:#f92672>]</span>&gt; SELECT * FROM habitaciones;
</span></span><span style=display:flex><span>MariaDB <span style=color:#f92672>[</span>hotel<span style=color:#f92672>]</span>&gt; SELECT * FROM reservas;
</span></span><span style=display:flex><span>MariaDB <span style=color:#f92672>[</span>hotel<span style=color:#f92672>]</span>&gt; SELECT * FROM pagos;
</span></span></code></pre></div><h2 id=instalación-servidor-mongodb-en-debian-13>Instalación Servidor MongoDB en Debian 13.</h2><h3 id=1dependencias-y-configuración-previa>1.Dependencias y configuración previa</h3><ul><li>Actualizamos los paquetes del sistema para evitar posibles conflictos de
versiones durante la instalación del servidor de MongoDB.</li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-bash data-lang=bash><span style=display:flex><span>serjaii@db:~$ sudo apt update
</span></span></code></pre></div><ul><li>Instalamos las siguientes dependencias.</li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-bash data-lang=bash><span style=display:flex><span>serjaii@db:~$ sudo apt install curl gnupg -y - curl: sirve para descargar archivos desde Internet. 
</span></span><span style=display:flex><span>- **gnupg**: permite manejar claves criptográficas como las claves GPG.
</span></span></code></pre></div><ul><li>Ejecutamos el siguiente comando para descargar la clave pública GPG oficial
de MongoDB, y con “gpg &ndash;dearmor” la convertimos en formato binario para
que apt pueda usarla.</li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-bash data-lang=bash><span style=display:flex><span>serjaii@db:~$ sudo curl -fsSL https://pgp.mongodb.com/server-8.0.asc | sudo gpg -dearmor -o /usr/share/keyrings/mongodbserver-8.0.gpg
</span></span></code></pre></div><ul><li>Con el siguiente comando voy a añadir el repositorio de MongoDB. El
siguiente comando lo que hace es crear un nuevo archivo de lista de
repositorios (mongodb-org-8.0.list) en “/etc/apt/sources.list.d/”, escribiendo
dentro del fichero una línea que le dice a apt lo siguiente:</li><li></li></ul><p>Usa el repositorio de MongoDB.
Está en <a class=link href=https://repo.mongodb.org/apt/debian target=_blank rel=noopener>https://repo.mongodb.org/apt/debian</a>.
Usa la versión bookworm, que es equivalente tanto para Debian 12
como para Debian 13.
La sección es main.
Los paquetes deben estar firmados con la clave “/usr/share/keyrings/mongodb-server-8.0.gpg”.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-bash data-lang=bash><span style=display:flex><span>serjaii@db:~$ sudo echo <span style=color:#e6db74>&#34;deb [signed-by=/usr/share/keyrings/mongodbserver-8.0.gpg] https://repo.mongodb.org/apt/debian bookworm/mongodb-org/8.0 main&#34;</span> | sudo tee /etc/apt/sources.list.d/mongodb-org-8.0.list
</span></span></code></pre></div><ul><li>Volvemos a actualizar los paquetes e instalamos MongoDB.</li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-bash data-lang=bash><span style=display:flex><span>serjaii@db:~$ sudo apt update
</span></span></code></pre></div><h3 id=2instalación-del-servidor-2>2.Instalación del servidor</h3><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-bash data-lang=bash><span style=display:flex><span>serjaii@db:~$ sudo apt install mongodb-org -y
</span></span></code></pre></div><ul><li>Iniciamos y habilitamos MongoDB para que se inicie cada vez que se inicie la
máquina.</li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-bash data-lang=bash><span style=display:flex><span>serjaii@db:~$ sudo systemctl start mongod
</span></span><span style=display:flex><span>serjaii@db:~$ sudo systemctl enable mongod
</span></span></code></pre></div><ul><li>Verificamos el estado del servidor de MongoDB.</li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-bash data-lang=bash><span style=display:flex><span>serjaii@db:~$ sudo systemctl status mongod
</span></span></code></pre></div><ul><li>Comprobamos que podemos entrar en mongodb desde el local.</li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-bash data-lang=bash><span style=display:flex><span>serjaii@db:~$ mongosh
</span></span></code></pre></div><h3 id=3configuración-del-servidor-mongodb-para-la-conexión>3.Configuración del servidor MongoDB para la conexión</h3><p>remota.</p><ul><li>Para permitir el acceso remoto al servidor de MongoDB, tendremos que
modificar el parámetro “bindIp” a “0.0.0.0”, en el fichero “/etc/mongod.conf”.</li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-bash data-lang=bash><span style=display:flex><span>serjaii@db:~$ sudo nano /etc/mongod.conf
</span></span></code></pre></div><ul><li>Reiniciamos el servicio de MongoDB para aplicar los cambios.</li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-bash data-lang=bash><span style=display:flex><span>serjaii@db:~$ sudo systemctl restart mongod
</span></span></code></pre></div><h3 id=4crear-base-de-datos-de-prueba-usuario-y-conceder-permisos>4.Crear base de datos de prueba, usuario y conceder permisos</h3><p>en MongoDB.</p><ul><li>Accedemos al servidor de mongoDB en el mismo equipo.</li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-bash data-lang=bash><span style=display:flex><span>serjaii@db:~$ mongosh
</span></span></code></pre></div><ul><li><p>Creamos una base de datos de prueba.
test> use pruebadb</p></li><li><p>Vamos a crear un usuario de prueba también con contraseña, que solo pueda
operar sobre la base de datos que acabamos de crear. Pero para ello, tenemos
que hacerlo usando la base de datos que acabamos de crear.
pruebadb> db.createUser({
&mldr; user: &ldquo;sergio&rdquo;,
&mldr; pwd: &ldquo;sergio&rdquo;,
&mldr; roles: [
&mldr;
{ role: &ldquo;readWrite&rdquo;, db: &ldquo;pruebadb&rdquo; }
&mldr; ]
&mldr; })</p></li><li><p>En el fichero “/etc/mongod.config”, vamos a habilitar para que se fuerce la
autenticación.</p></li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-bash data-lang=bash><span style=display:flex><span>serjaii@db:~$ sudo nano /etc/mongod.conf
</span></span></code></pre></div><ul><li>Reiniciamos el servicio de MongoDB para aplicar los cambios.</li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-bash data-lang=bash><span style=display:flex><span>serjaii@db:~$ sudo systemctl restart mongod
</span></span></code></pre></div><ul><li>Comprobamos que podemos conectarnos al usuario que acabamos de crear y a
la base de datos.</li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-bash data-lang=bash><span style=display:flex><span>serjaii@db:~$ mongosh -u sergio -p sergio -authenticationDatabase pruebadb
</span></span></code></pre></div><h3 id=5instalación-y-configuración-del-cliente-de-mongodb>5.Instalación y configuración del cliente de MongoDB.</h3><ul><li>Actualizamos los paquetes del sistema para evitar posibles conflictos de
versiones durante la instalación del servidor de MongoDB.</li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-bash data-lang=bash><span style=display:flex><span>serjaii@db:~$ sudo apt update
</span></span></code></pre></div><ul><li>Instalamos las siguientes dependencias.</li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-bash data-lang=bash><span style=display:flex><span>serjaii@db:~$ sudo apt install curl gnupg -y
</span></span></code></pre></div><ul><li>Ejecutamos el siguiente comando para descargar la clave pública GPG oficial
de MongoDB, y con “gpg &ndash;dearmor” la convertimos en formato binario para
que apt pueda usarla.</li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-bash data-lang=bash><span style=display:flex><span>serjaii@db:~$ sudo curl -fsSL https://pgp.mongodb.com/server-8.0.asc | sudo gpg --dearmor -o /usr/share/keyrings/mongodb-server-8.0.gpg
</span></span></code></pre></div><ul><li>A continuación, vamos a añadir el repositorio de MongoDB con el siguiente
comando.</li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-bash data-lang=bash><span style=display:flex><span>serjaii@db:~$ echo <span style=color:#e6db74>&#34;deb [signed-by=/usr/share/keyrings/mongodb-server-8.0.gpg] https://repo.mongodb.org/apt/debian bookworm/mongodb-org/8.0 main&#34;</span> | sudo tee /etc/apt/sources.list.d/mongodb-org-8.0.list
</span></span></code></pre></div><ul><li>Volvemos a actualizar los paquetes.</li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-bash data-lang=bash><span style=display:flex><span>serjaii@db:~$ sudo apt update
</span></span></code></pre></div><ul><li>Con el siguiente comando vamos a instalar mongoDB, pero solo el cliente
moderno de MongoDB, ya que tenemos el servidor instalado en la máquina
remota.</li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-bash data-lang=bash><span style=display:flex><span>serjaii@db:~$ sudo apt install -y mongodb-mongosh
</span></span></code></pre></div><ul><li>Comprobamos que podemos conectarnos desde el cliente en nuestro local al
servidor remoto.</li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-bash data-lang=bash><span style=display:flex><span>serjaii@db:~$ mongosh <span style=color:#e6db74>&#34;mongodb://usuario:contraseña@IP_DEL_SERVIDOR:2 7017/pruebadb?authSource=pruebadb&#34;</span>
</span></span></code></pre></div><h3 id=6creación-de-usuario-base-de-datos-con-tablas-y-datos-en>6.Creación de usuario, base de datos con tablas y datos en</h3><p>MongoDB.</p><ul><li>Nos conectamos al servidor desde su propia máquina y creamos la base de
datos y el usuario con el que vamos a acceder a la base de datos remotamente.</li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-bash data-lang=bash><span style=display:flex><span>serjaii@db:~$ mongosh 
</span></span><span style=display:flex><span>test&gt; use hotel 
</span></span><span style=display:flex><span>hotel&gt; db.createUser<span style=color:#f92672>({</span> user: <span style=color:#e6db74>&#34;sergio&#34;</span>, pwd: <span style=color:#e6db74>&#34;sergio&#34;</span>, roles: <span style=color:#f92672>[{</span> role: <span style=color:#e6db74>&#34;readWrite&#34;</span>, db: <span style=color:#e6db74>&#34;hotel&#34;</span> <span style=color:#f92672>}]</span> <span style=color:#f92672>})</span> 
</span></span><span style=display:flex><span><span style=color:#f92672>{</span> ok: <span style=color:#ae81ff>1</span> <span style=color:#f92672>}</span>
</span></span></code></pre></div><ul><li>Volvemos a activar la autenticación en “/etc/mongod.conf”.</li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-bash data-lang=bash><span style=display:flex><span>serjaii@db:~$ sudo systemctl restart mongod
</span></span></code></pre></div><ul><li>Nos conectamos remotamente, y comenzamos a crear colecciones e insertar
datos.</li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-bash data-lang=bash><span style=display:flex><span>serjaii@db:~$ mongosh <span style=color:#e6db74>&#34;mongodb://usuario:contraseña@IP_DEL_SERVIDOR:27017/pruebadb?authSource=pruebadb&#34;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>// Creación de la colección clientes e inserción de datos.
</span></span><span style=display:flex><span>db.clientes.insertMany<span style=color:#f92672>([</span> 
</span></span><span style=display:flex><span><span style=color:#f92672>{</span>_id:1, nombre:<span style=color:#e6db74>&#34;David&#34;</span>, apellido1:<span style=color:#e6db74>&#34;Dorado&#34;</span>, apellido2:<span style=color:#e6db74>&#34;Lopez&#34;</span>, email:<span style=color:#e6db74>&#34;davidd@gmail.com&#34;</span>, telefono:600111222<span style=color:#f92672>}</span>, 
</span></span><span style=display:flex><span><span style=color:#f92672>{</span>_id:2, nombre:<span style=color:#e6db74>&#34;Maria&#34;</span>, apellido1:<span style=color:#e6db74>&#34;Gomez&#34;</span>, apellido2:<span style=color:#e6db74>&#34;Perez&#34;</span>, email:<span style=color:#e6db74>&#34;mariagom@gmail.com&#34;</span>, telefono:600333444<span style=color:#f92672>}</span>, 
</span></span><span style=display:flex><span><span style=color:#f92672>{</span>_id:3, nombre:<span style=color:#e6db74>&#34;Jorge&#34;</span>, apellido1:<span style=color:#e6db74>&#34;Santos&#34;</span>, apellido2:<span style=color:#e6db74>&#34;Diaz&#34;</span>, email:<span style=color:#e6db74>&#34;jorgesantos@gmail.com&#34;</span>, telefono:600555666<span style=color:#f92672>}</span>, 
</span></span><span style=display:flex><span><span style=color:#f92672>{</span>_id:4, nombre:<span style=color:#e6db74>&#34;Lucia&#34;</span>, apellido1:<span style=color:#e6db74>&#34;Romero&#34;</span>, apellido2:<span style=color:#e6db74>&#34;Garcia&#34;</span>, email:<span style=color:#e6db74>&#34;luciarom@yahoo.es&#34;</span>, telefono:600777888<span style=color:#f92672>}</span>, 
</span></span><span style=display:flex><span><span style=color:#f92672>{</span>_id:5, nombre:<span style=color:#e6db74>&#34;Pablo&#34;</span>, apellido1:<span style=color:#e6db74>&#34;Ruiz&#34;</span>, apellido2:<span style=color:#e6db74>&#34;Torres&#34;</span>, email:<span style=color:#e6db74>&#34;pablo@gmail.com&#34;</span>, telefono:600999000<span style=color:#f92672>}</span>, 
</span></span><span style=display:flex><span><span style=color:#f92672>{</span>_id:6, nombre:<span style=color:#e6db74>&#34;Sofia&#34;</span>, apellido1:<span style=color:#e6db74>&#34;Martinez&#34;</span>, apellido2:<span style=color:#e6db74>&#34;Leon&#34;</span>, email:<span style=color:#e6db74>&#34;sofleon@yahoo.es&#34;</span>, telefono:601111222<span style=color:#f92672>}</span>, 
</span></span><span style=display:flex><span><span style=color:#f92672>{</span>_id:7, nombre:<span style=color:#e6db74>&#34;Alberto&#34;</span>, apellido1:<span style=color:#e6db74>&#34;Navas&#34;</span>, apellido2:<span style=color:#e6db74>&#34;Cruz&#34;</span>, email:<span style=color:#e6db74>&#34;albertonavas@yahoo.es&#34;</span>, telefono:601333444<span style=color:#f92672>}</span>, 
</span></span><span style=display:flex><span><span style=color:#f92672>{</span>_id:8, nombre:<span style=color:#e6db74>&#34;Marta&#34;</span>, apellido1:<span style=color:#e6db74>&#34;Lopez&#34;</span>, apellido2:<span style=color:#e6db74>&#34;Gil&#34;</span>, email:<span style=color:#e6db74>&#34;marta@gmail.com&#34;</span>, telefono:601555666<span style=color:#f92672>}</span>, 
</span></span><span style=display:flex><span><span style=color:#f92672>{</span>_id:9, nombre:<span style=color:#e6db74>&#34;Raul&#34;</span>, apellido1:<span style=color:#e6db74>&#34;Castro&#34;</span>, apellido2:<span style=color:#e6db74>&#34;Vega&#34;</span>, email:<span style=color:#e6db74>&#34;raulcastro@gmail.com&#34;</span>, telefono:601777888<span style=color:#f92672>}</span>, 
</span></span><span style=display:flex><span><span style=color:#f92672>{</span>_id:10, nombre:<span style=color:#e6db74>&#34;Laura&#34;</span>, apellido1:<span style=color:#e6db74>&#34;Morales&#34;</span>, apellido2:<span style=color:#e6db74>&#34;Cano&#34;</span>, email:<span style=color:#e6db74>&#34;laura@gmail.com&#34;</span>, telefono:601999000<span style=color:#f92672>}</span>
</span></span><span style=display:flex><span><span style=color:#f92672>])</span>; 
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>// Creación de la colección habitaciones e inserción de datos.
</span></span><span style=display:flex><span>db.habitaciones.insertMany<span style=color:#f92672>([</span> 
</span></span><span style=display:flex><span><span style=color:#f92672>{</span>_id:1, numero:101, tipo:<span style=color:#e6db74>&#34;Individual&#34;</span>, precio:50<span style=color:#f92672>}</span>, 
</span></span><span style=display:flex><span><span style=color:#f92672>{</span>_id:2, numero:102, tipo:<span style=color:#e6db74>&#34;Doble&#34;</span>, precio:80<span style=color:#f92672>}</span>, 
</span></span><span style=display:flex><span><span style=color:#f92672>{</span>_id:3, numero:103, tipo:<span style=color:#e6db74>&#34;Suite&#34;</span>, precio:150<span style=color:#f92672>}</span>, 
</span></span><span style=display:flex><span><span style=color:#f92672>{</span>_id:4, numero:104, tipo:<span style=color:#e6db74>&#34;Individual&#34;</span>, precio:50<span style=color:#f92672>}</span>, 
</span></span><span style=display:flex><span><span style=color:#f92672>{</span>_id:5, numero:105, tipo:<span style=color:#e6db74>&#34;Doble&#34;</span>, precio:80<span style=color:#f92672>}</span>, 
</span></span><span style=display:flex><span><span style=color:#f92672>{</span>_id:6, numero:106, tipo:<span style=color:#e6db74>&#34;Suite&#34;</span>, precio:150<span style=color:#f92672>}</span> 
</span></span><span style=display:flex><span><span style=color:#f92672>])</span>; 
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>// Creación de la colección servicios e inserción de datos. 
</span></span><span style=display:flex><span>db.servicios.insertMany<span style=color:#f92672>([</span> 
</span></span><span style=display:flex><span><span style=color:#f92672>{</span> _id:1, servicio:<span style=color:#e6db74>&#34;Desayuno&#34;</span>, precio:5 <span style=color:#f92672>}</span>, 
</span></span><span style=display:flex><span><span style=color:#f92672>{</span> _id:2, servicio:<span style=color:#e6db74>&#34;Spa&#34;</span>, precio:20 <span style=color:#f92672>}</span>, 
</span></span><span style=display:flex><span><span style=color:#f92672>{</span> _id:3, servicio:<span style=color:#e6db74>&#34;Gimnasio&#34;</span>, precio:0 <span style=color:#f92672>}</span>, 
</span></span><span style=display:flex><span><span style=color:#f92672>{</span> _id:4, servicio:<span style=color:#e6db74>&#34;Piscina cubierta&#34;</span>, precio:0 <span style=color:#f92672>}</span>, 
</span></span><span style=display:flex><span><span style=color:#f92672>{</span> _id:5, servicio:<span style=color:#e6db74>&#34;Aparcamiento&#34;</span>, precio:10 <span style=color:#f92672>}</span>, 
</span></span><span style=display:flex><span><span style=color:#f92672>{</span> _id:6, servicio:<span style=color:#e6db74>&#34;Limpieza extra&#34;</span>, precio:15 <span style=color:#f92672>}</span>, 
</span></span><span style=display:flex><span><span style=color:#f92672>{</span> _id:7, servicio:<span style=color:#e6db74>&#34;Wi-Fi Premium&#34;</span>, precio:3 <span style=color:#f92672>}</span>, 
</span></span><span style=display:flex><span><span style=color:#f92672>{</span> _id:8, servicio:<span style=color:#e6db74>&#34;Transporte aeropuerto&#34;</span>, precio:25 <span style=color:#f92672>}</span>, 
</span></span><span style=display:flex><span><span style=color:#f92672>{</span> _id:9, servicio:<span style=color:#e6db74>&#34;Cuna para bebé&#34;</span>, precio:5 <span style=color:#f92672>}</span>, 
</span></span><span style=display:flex><span><span style=color:#f92672>{</span> _id:10, servicio:<span style=color:#e6db74>&#34;Late check-out&#34;</span>, precio:12 <span style=color:#f92672>}</span>
</span></span><span style=display:flex><span><span style=color:#f92672>])</span>;
</span></span></code></pre></div><ul><li>Comprobamos que se han creado las colecciones con los datos correctamente.
Colección clientes.
hotel> db.clientes.find();</li></ul><p>Colección habitaciones.
hotel> db.habitaciones.find();</p><p>Colección servicios.
hotel> db.servicios.find();</p><h2 id=instalación-servidor-neo4j-en-debian-13>Instalación Servidor Neo4J en Debian 13.</h2><h3 id=1instalación-de-dependencias>1.Instalación de dependencias</h3><ul><li>Actualizamos los paquetes del sistema para evitar conflictos durante la
instalación de paquetes y dependencias.</li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-bash data-lang=bash><span style=display:flex><span>serjaii@db:~$ sudo apt update
</span></span></code></pre></div><ul><li>Instalamos las dependencias y utilidades básicas para Neo4J.</li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-bash data-lang=bash><span style=display:flex><span>serjaii@db:~$ sudo apt install -y wget curl gnupg lsb-release ca-certificates apt-transport-https 
</span></span></code></pre></div><ul><li><strong>wget</strong>: para descargar archivos desde internet.</li><li><strong>curl</strong>: descargar archivos desde internet.</li><li><strong>gnupg</strong>: manejar claves de seguridad (GPG).</li><li><strong>lsb-release</strong>: saber la versión del sistema.</li><li><strong>ca-certificates y apt-transport-https</strong>: permiten usar repositorios HTTPS de forma segura.</li></ul><pre tabindex=0><code>- Neo4j necesita java para funcionar. En mi caso, voy a instalar Temurin Java 21,
usando una versión mantenida por Adoptium.
```bash
serjaii@db:~$ wget -qO https://packages.adoptium.net/artifactory/api/gpg/key/public | gpg --dearmor | sudo tee /etc/apt/trusted.gpg.d/adoptium.gpg &gt; /dev/null
</code></pre><p>Con este comando, estamos descargando y guardando la clave GPG para poder
confiar en los paquetes de Adoptium.</p><ul><li>Añadimos el repositorio de Adoptium desde donde apt puede descargar los
paquetes Temurin (Java 21).</li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-bash data-lang=bash><span style=display:flex><span>serjaii@db:~$ echo <span style=color:#e6db74>&#34;deb [signed-by=/etc/apt/trusted.gpg.d/adoptium.gpg] https://packages.adoptium.net/artifactory/deb </span><span style=color:#66d9ef>$(</span>lsb_release -cs<span style=color:#66d9ef>)</span><span style=color:#e6db74> main&#34;</span> | sudo tee /etc/apt/sources.list.d/adoptium.list
</span></span></code></pre></div><ul><li>Volvemos a actualizar los repositorios antes de instalar java 21.</li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-bash data-lang=bash><span style=display:flex><span>serjaii@db:~$ sudo apt update
</span></span></code></pre></div><ul><li>Instalamos Java Development Kit 21, necesario para ejecutar Neo4j.</li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-bash data-lang=bash><span style=display:flex><span>serjaii@db:~$ sudo apt install -y temurin-21-jdk
</span></span></code></pre></div><ul><li>Comprobamos que se ha descargado java correctamente.</li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-bash data-lang=bash><span style=display:flex><span>serjaii@db:~$ java -version
</span></span></code></pre></div><ul><li>Añadimos la clave de Neo4j, descargando y guardando la clave oficial de
Neo4j para verificar los paquetes.</li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-bash data-lang=bash><span style=display:flex><span>serjaii@db:~$ wget -qO https://debian.neo4j.com/neotechnology.gpg.key | gpg --dearmor | sudo tee /etc/apt/trusted.gpg.d/neo4j.gpg &gt; /dev/null
</span></span></code></pre></div><ul><li>Añadimos el repositorio oficial de dónde se descargará Neo4j.</li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-bash data-lang=bash><span style=display:flex><span>serjaii@db:~$ echo <span style=color:#e6db74>&#39;deb https://debian.neo4j.com stable latest&#39;</span> | sudo tee /etc/apt/sources.list.d/neo4j.list
</span></span></code></pre></div><h3 id=2instalación-del-servidor-3>2.Instalación del servidor</h3><ul><li>Actualizamos los paquetes, para refrescar la lista de paquetes antes de instalar
Neo4j.</li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-bash data-lang=bash><span style=display:flex><span>serjaii@db:~$ sudo apt update
</span></span></code></pre></div><ul><li>Instalamos Neo4j.</li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-bash data-lang=bash><span style=display:flex><span>serjaii@db:~$ sudo apt install neo4j -y
</span></span></code></pre></div><ul><li>Antes de iniciar por primera vez el servidor de Neo4j, hay que definir la
contraseña del usuario administrador de Neo4j. Para ello, vamos a asegurarnos
que el servicio esté apagado antes.</li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-bash data-lang=bash><span style=display:flex><span>serjaii@db:~$ sudo systemctl status neo4j
</span></span></code></pre></div><ul><li>Fijamos la contraseña inicial para el usuario neo4j.</li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-bash data-lang=bash><span style=display:flex><span>serjaii@db:~$ sudo neo4j-admin dbms set-initialpassword <span style=color:#e6db74>&#39;root1234&#39;</span>
</span></span></code></pre></div><ul><li>Iniciamos el servicio de Neo4j y comprobamos que podemos acceder a la base
de datos de Neo4j.</li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-bash data-lang=bash><span style=display:flex><span>serjaii@db:~$ sudo systemctl start neo4j
</span></span><span style=display:flex><span>serjaii@db:~$ sudo systemctl status neo4j
</span></span><span style=display:flex><span>serjaii@db:~$ sudo systemctl enable neo4j
</span></span><span style=display:flex><span>serjaii@db:~$ cypher-shell -u neo4j -p <span style=color:#e6db74>&#39;root1234&#39;</span>
</span></span></code></pre></div><h3 id=3configuración-del-servidor-neo4j-en-debian-13-para-la>3.Configuración del Servidor Neo4J en Debian 13 para la</h3><p>conexión remota.</p><ul><li>Por defecto Neo4j escucha sólo en localhost. Por lo tanto, vamos a modificar en
el fichero “/etc/neo4j/neo4j.conf”, las siguientes líneas para permitir la
conexión remota.</li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-bash data-lang=bash><span style=display:flex><span>serjaii@db:~$ sudo nano /etc/neo4j/neo4j.conf
</span></span><span style=display:flex><span>serjaii@db:~$ grep -E <span style=color:#e6db74>&#39;server.default_listen_address|server.bolt.listen_address|server.http.listen_address&#39;</span> /etc/neo4j/neo4j.conf
</span></span></code></pre></div><ul><li><p>0.0.0.0: escuchar todas las interfaces de red.
Puerto 7687: activar protocolo Bolt en el puerto 7687, usado por
clientes como cypher-shell.
Puerto 7474: interfaz web de Neo4j accesible desde el navegador.</p></li><li><p>Reiniciamos el servicio de Neo4j para que se apliquen los cambios de
configuración remota.</p></li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-bash data-lang=bash><span style=display:flex><span>serjaii@db:~$ sudo systemctl restart neo4j
</span></span></code></pre></div><ul><li>Verificamos que el servicio está escuchando por los puertos que hemos
activado.</li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-bash data-lang=bash><span style=display:flex><span>serjaii@db:~$ ss -tlnp | grep <span style=color:#ae81ff>7687</span>
</span></span><span style=display:flex><span>serjaii@db:~$ curl -I http://localhost:7474
</span></span></code></pre></div><h3 id=4instalación-y-configuración-del-cliente-de-neo4j-en-debian-13>4.Instalación y configuración del cliente de Neo4j en Debian 13.</h3><ul><li>Actualizamos los paquetes del sistema para evitar conflictos durante la
instalación del cliente.</li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-bash data-lang=bash><span style=display:flex><span>serjaii@db:~$ sudo apt update <span style=color:#f92672>&amp;&amp;</span> sudo apt upgrade -y
</span></span></code></pre></div><ul><li>Nos descargamos los repositorios oficiales y clave gpg del cliente de Neo4j.</li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-bash data-lang=bash><span style=display:flex><span>serjaii@db:~$ wget -qO https://debian.neo4j.com/neotechnology.gpg.key | gpg --dearmor | sudo tee /etc/apt/trusted.gpg.d/neo4j.gpg &gt; /dev/null
</span></span></code></pre></div><ul><li>Añadimos la clave de Neo4j.</li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-bash data-lang=bash><span style=display:flex><span>serjaii@db:~$ echo <span style=color:#e6db74>&#39;deb https://debian.neo4j.com stable latest&#39;</span> | sudo tee /etc/apt/sources.list.d/neo4j.list
</span></span></code></pre></div><ul><li>Actualizamos los paquetes del sistema para que se incluyan los repositorios y la
clave de Neo4j al sistema.</li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-bash data-lang=bash><span style=display:flex><span>serjaii@db:~$ sudo apt update
</span></span></code></pre></div><ul><li>Instalamos el cliente de línea de comandos de Neo4j.</li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-bash data-lang=bash><span style=display:flex><span>serjaii@db:~$ sudo apt install -y cypher-shell
</span></span></code></pre></div><ul><li>Comprobamos que podemos conectar remotamente desde el cliente al servidor
de Neo4j.</li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-bash data-lang=bash><span style=display:flex><span>serjaii@db:~$ cypher-shell bolt://IP_SERVIDOR:7687 -u neo4j -p <span style=color:#e6db74>&#39;root1234&#39;</span> -a
</span></span></code></pre></div><h3 id=5creación-de-usuario-base-de-datos-con-nodos-e-inserción-de>5.Creación de usuario, base de datos con nodos e inserción de</h3><p>datos de Neo4j.
Durante la instalación de Neo4j se ha utilizado la edición Community, que es la
versión gratuita y de código abierto.
Esta edición no permite la creación base de datos adicionales, por lo que todas las
pruebas y ejercicios las realizaremos sobre la base de datos por defecto llamada
“neo4j”.</p><ul><li>Accedemos a la base de datos desde el cliente, y creamos un nuevo usuario y le
otorgamos los permisos necesarios adecuados al usuario creado para que pueda
interactuar sobre la base de datos por defecto. En este caso, al igual que hemos
explicado antes con la creación de la base de datos, la edición Community
tampoco tiene las opciones de darle privilegios a los usuarios, sino que durante
la creación del usuario, el usuario tiene todos los permisos por defecto, como si
fuera admin.</li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-bash data-lang=bash><span style=display:flex><span>serjaii@db:~$ cypher-shell bolt://192.168.122.79:7687 -u neo4j -p <span style=color:#e6db74>&#39;root1234&#39;</span> 
</span></span><span style=display:flex><span>neo4j@neo4j&gt; :use system
</span></span><span style=display:flex><span>neo4j@neo4j&gt; CREATE USER nombreUsuario SET PASSWORD <span style=color:#e6db74>&#39;contraseñaUsuario&#39;</span> CHANGE NOT REQUIRED;
</span></span></code></pre></div><p>Con la opción “CHANGE NOT REQUIRED”, hemos indicado que no necesita
cambiar la contraseña en su primer inicio de sesión.</p><ul><li>Creamos los nodos correspondientes con sus datos.
Creación de clientes.</li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-bash data-lang=bash><span style=display:flex><span>CREATE <span style=color:#f92672>(</span>:Cliente <span style=color:#f92672>{</span>id: 1, nombre: <span style=color:#e6db74>&#34;David&#34;</span>, apellido1: <span style=color:#e6db74>&#34;Dorado&#34;</span>, apellido2: <span style=color:#e6db74>&#34;Lopez&#34;</span>, email: <span style=color:#e6db74>&#34;davidd@gmail.com&#34;</span>, telefono: 600111222<span style=color:#f92672>})</span>;
</span></span><span style=display:flex><span>CREATE <span style=color:#f92672>(</span>:Cliente <span style=color:#f92672>{</span>id: 2, nombre: <span style=color:#e6db74>&#34;Maria&#34;</span>, apellido1: <span style=color:#e6db74>&#34;Gomez&#34;</span>, apellido2: <span style=color:#e6db74>&#34;Perez&#34;</span>, email: <span style=color:#e6db74>&#34;mariagom@gmail.com&#34;</span>, telefono: 600333444<span style=color:#f92672>})</span>;
</span></span><span style=display:flex><span>CREATE <span style=color:#f92672>(</span>:Cliente <span style=color:#f92672>{</span>id: 3, nombre: <span style=color:#e6db74>&#34;Jorge&#34;</span>, apellido1: <span style=color:#e6db74>&#34;Santos&#34;</span>, apellido2: <span style=color:#e6db74>&#34;Diaz&#34;</span>, email: <span style=color:#e6db74>&#34;jorgesantos@gmail.com&#34;</span>, telefono: 600555666<span style=color:#f92672>})</span>;
</span></span><span style=display:flex><span>CREATE <span style=color:#f92672>(</span>:Cliente <span style=color:#f92672>{</span>id: 4, nombre: <span style=color:#e6db74>&#34;Lucia&#34;</span>, apellido1: <span style=color:#e6db74>&#34;Romero&#34;</span>, apellido2: <span style=color:#e6db74>&#34;Garcia&#34;</span>, email: <span style=color:#e6db74>&#34;luciarom@yahoot.es&#34;</span>, telefono: 600777888<span style=color:#f92672>})</span>;
</span></span><span style=display:flex><span>CREATE <span style=color:#f92672>(</span>:Cliente <span style=color:#f92672>{</span>id: 5, nombre: <span style=color:#e6db74>&#34;Pablo&#34;</span>, apellido1: <span style=color:#e6db74>&#34;Ruiz&#34;</span>, apellido2: <span style=color:#e6db74>&#34;Torres&#34;</span>, email: <span style=color:#e6db74>&#34;pablo@gmail.com&#34;</span>, telefono: 600999000<span style=color:#f92672>})</span>;
</span></span><span style=display:flex><span>CREATE <span style=color:#f92672>(</span>:Cliente <span style=color:#f92672>{</span>id: 6, nombre: <span style=color:#e6db74>&#34;Sofia&#34;</span>, apellido1: <span style=color:#e6db74>&#34;Martinez&#34;</span>, apellido2: <span style=color:#e6db74>&#34;Leon&#34;</span>, email: <span style=color:#e6db74>&#34;sofleon@yahoot.es&#34;</span>, telefono: 601111222<span style=color:#f92672>})</span>;
</span></span><span style=display:flex><span>CREATE <span style=color:#f92672>(</span>:Cliente <span style=color:#f92672>{</span>id: 7, nombre: <span style=color:#e6db74>&#34;Roberto&#34;</span>, apellido1: <span style=color:#e6db74>&#34;Navas&#34;</span>, apellido2: <span style=color:#e6db74>&#34;Cruz&#34;</span>, email: <span style=color:#e6db74>&#34;albertonavas@yahoot.es&#34;</span>, telefono: 601333444<span style=color:#f92672>})</span>;
</span></span><span style=display:flex><span>CREATE <span style=color:#f92672>(</span>:Cliente <span style=color:#f92672>{</span>id: 8, nombre: <span style=color:#e6db74>&#34;Marta&#34;</span>, apellido1: <span style=color:#e6db74>&#34;Lopez&#34;</span>, apellido2: <span style=color:#e6db74>&#34;Gil&#34;</span>, email: <span style=color:#e6db74>&#34;marta@gmail.com&#34;</span>, telefono: 601555666<span style=color:#f92672>})</span>;
</span></span><span style=display:flex><span>CREATE <span style=color:#f92672>(</span>:Cliente <span style=color:#f92672>{</span>id: 9, nombre: <span style=color:#e6db74>&#34;Raul&#34;</span>, apellido1: <span style=color:#e6db74>&#34;Castro&#34;</span>, apellido2: <span style=color:#e6db74>&#34;Vega&#34;</span>, email: <span style=color:#e6db74>&#34;raulcastro@gmail.com&#34;</span>, telefono: 601777888<span style=color:#f92672>})</span>;
</span></span><span style=display:flex><span>CREATE <span style=color:#f92672>(</span>:Cliente <span style=color:#f92672>{</span>id: 10, nombre: <span style=color:#e6db74>&#34;laura&#34;</span>, apellido1: <span style=color:#e6db74>&#34;Morales&#34;</span>, apellido2: <span style=color:#e6db74>&#34;Cano&#34;</span>, email: <span style=color:#e6db74>&#34;laura@gmail.com&#34;</span>, telefono: 601999000<span style=color:#f92672>})</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>// Creación de habitaciones.
</span></span><span style=display:flex><span>CREATE <span style=color:#f92672>(</span>:Habitacion <span style=color:#f92672>{</span>id: 1, numero: 101, tipo: <span style=color:#e6db74>&#34;Individual&#34;</span><span style=color:#f92672>})</span>;
</span></span><span style=display:flex><span>CREATE <span style=color:#f92672>(</span>:Habitacion <span style=color:#f92672>{</span>id: 2, numero: 102, tipo: <span style=color:#e6db74>&#34;Doble&#34;</span><span style=color:#f92672>})</span>;
</span></span><span style=display:flex><span>CREATE <span style=color:#f92672>(</span>:Habitacion <span style=color:#f92672>{</span>id: 3, numero: 103, tipo: <span style=color:#e6db74>&#34;Suite&#34;</span><span style=color:#f92672>})</span>;
</span></span><span style=display:flex><span>CREATE <span style=color:#f92672>(</span>:Habitacion <span style=color:#f92672>{</span>id: 4, numero: 104, tipo: <span style=color:#e6db74>&#34;Individual&#34;</span><span style=color:#f92672>})</span>;
</span></span><span style=display:flex><span>CREATE <span style=color:#f92672>(</span>:Habitacion <span style=color:#f92672>{</span>id: 5, numero: 105, tipo: <span style=color:#e6db74>&#34;Doble&#34;</span><span style=color:#f92672>})</span>;
</span></span><span style=display:flex><span>CREATE <span style=color:#f92672>(</span>:Habitacion <span style=color:#f92672>{</span>id: 6, numero: 106, tipo: <span style=color:#e6db74>&#34;Suite&#34;</span><span style=color:#f92672>})</span>;
</span></span><span style=display:flex><span>CREATE <span style=color:#f92672>(</span>:Habitacion <span style=color:#f92672>{</span>id: 7, numero: 107, tipo: <span style=color:#e6db74>&#34;Individual&#34;</span><span style=color:#f92672>})</span>;
</span></span><span style=display:flex><span>CREATE <span style=color:#f92672>(</span>:Habitacion <span style=color:#f92672>{</span>id: 8, numero: 108, tipo: <span style=color:#e6db74>&#34;Doble&#34;</span><span style=color:#f92672>})</span>;
</span></span><span style=display:flex><span>CREATE <span style=color:#f92672>(</span>:Habitacion <span style=color:#f92672>{</span>id: 9, numero: 109, tipo: <span style=color:#e6db74>&#34;Suite&#34;</span><span style=color:#f92672>})</span>;
</span></span><span style=display:flex><span>CREATE <span style=color:#f92672>(</span>:Habitacion <span style=color:#f92672>{</span>id: 10, numero: 110, tipo: <span style=color:#e6db74>&#34;Doble&#34;</span><span style=color:#f92672>})</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>// Creación de servicios.
</span></span><span style=display:flex><span>CREATE <span style=color:#f92672>(</span>:Servicio <span style=color:#f92672>{</span>id: 1, nombre: <span style=color:#e6db74>&#34;Restaurante&#34;</span>, precio: 15<span style=color:#f92672>})</span>;
</span></span><span style=display:flex><span>CREATE <span style=color:#f92672>(</span>:Servicio <span style=color:#f92672>{</span>id: 2, nombre: <span style=color:#e6db74>&#34;Piscina&#34;</span>, precio: 5<span style=color:#f92672>})</span>;
</span></span><span style=display:flex><span>CREATE <span style=color:#f92672>(</span>:Servicio <span style=color:#f92672>{</span>id: 3, nombre: <span style=color:#e6db74>&#34;Spa&#34;</span>, precio: 25<span style=color:#f92672>})</span>;
</span></span><span style=display:flex><span>CREATE <span style=color:#f92672>(</span>:Servicio <span style=color:#f92672>{</span>id: 4, nombre: <span style=color:#e6db74>&#34;Gimnasio&#34;</span>, precio: 10<span style=color:#f92672>})</span>;
</span></span><span style=display:flex><span>CREATE <span style=color:#f92672>(</span>:Servicio <span style=color:#f92672>{</span>id: 5, nombre: <span style=color:#e6db74>&#34;Parking&#34;</span>, precio: 8<span style=color:#f92672>})</span>;
</span></span><span style=display:flex><span>CREATE <span style=color:#f92672>(</span>:Servicio <span style=color:#f92672>{</span>id: 6, nombre: <span style=color:#e6db74>&#34;Transporte&#34;</span>, precio: 12<span style=color:#f92672>})</span>;
</span></span><span style=display:flex><span>CREATE <span style=color:#f92672>(</span>:Servicio <span style=color:#f92672>{</span>id: 7, nombre: <span style=color:#e6db74>&#34;WiFi Premium&#34;</span>, precio: 3<span style=color:#f92672>})</span>;
</span></span><span style=display:flex><span>CREATE <span style=color:#f92672>(</span>:Servicio <span style=color:#f92672>{</span>id: 8, nombre: <span style=color:#e6db74>&#34;Canguro&#34;</span>, precio: 20<span style=color:#f92672>})</span>;
</span></span><span style=display:flex><span>CREATE <span style=color:#f92672>(</span>:Servicio <span style=color:#f92672>{</span>id: 9, nombre: <span style=color:#e6db74>&#34;Excursión&#34;</span>, precio: 30<span style=color:#f92672>})</span>;
</span></span><span style=display:flex><span>CREATE <span style=color:#f92672>(</span>:Servicio <span style=color:#f92672>{</span>id: 10, nombre: <span style=color:#e6db74>&#34;Alquiler Bicicleta&#34;</span>, precio: 7<span style=color:#f92672>})</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>// Creación de Pagos.
</span></span><span style=display:flex><span>CREATE <span style=color:#f92672>(</span>:Pagos <span style=color:#f92672>{</span>id: 1, monto: 100, metodo: <span style=color:#e6db74>&#34;Tarjeta&#34;</span><span style=color:#f92672>})</span>;
</span></span><span style=display:flex><span>CREATE <span style=color:#f92672>(</span>:Pagos <span style=color:#f92672>{</span>id: 2, monto: 200, metodo: <span style=color:#e6db74>&#34;Efectivo&#34;</span><span style=color:#f92672>})</span>;
</span></span><span style=display:flex><span>CREATE <span style=color:#f92672>(</span>:Pagos <span style=color:#f92672>{</span>id: 3, monto: 150, metodo: <span style=color:#e6db74>&#34;Transferencia&#34;</span><span style=color:#f92672>})</span>;
</span></span><span style=display:flex><span>CREATE <span style=color:#f92672>(</span>:Pagos <span style=color:#f92672>{</span>id: 4, monto: 120, metodo: <span style=color:#e6db74>&#34;Tarjeta&#34;</span><span style=color:#f92672>})</span>;
</span></span><span style=display:flex><span>CREATE <span style=color:#f92672>(</span>:Pagos <span style=color:#f92672>{</span>id: 5, monto: 250, metodo: <span style=color:#e6db74>&#34;Efectivo&#34;</span><span style=color:#f92672>})</span>;
</span></span><span style=display:flex><span>CREATE <span style=color:#f92672>(</span>:Pagos <span style=color:#f92672>{</span>id: 6, monto: 180, metodo: <span style=color:#e6db74>&#34;Tarjeta&#34;</span><span style=color:#f92672>})</span>;
</span></span><span style=display:flex><span>CREATE <span style=color:#f92672>(</span>:Pagos <span style=color:#f92672>{</span>id: 7, monto: 90, metodo: <span style=color:#e6db74>&#34;Transferencia&#34;</span><span style=color:#f92672>})</span>;
</span></span><span style=display:flex><span>CREATE <span style=color:#f92672>(</span>:Pagos <span style=color:#f92672>{</span>id: 8, monto: 300, metodo: <span style=color:#e6db74>&#34;Efectivo&#34;</span><span style=color:#f92672>})</span>;
</span></span><span style=display:flex><span>CREATE <span style=color:#f92672>(</span>:Pagos <span style=color:#f92672>{</span>id: 9, monto: 50, metodo: <span style=color:#e6db74>&#34;Tarjeta&#34;</span><span style=color:#f92672>})</span>;
</span></span><span style=display:flex><span>CREATE <span style=color:#f92672>(</span>:Pagos <span style=color:#f92672>{</span>id: 10, monto: 75, metodo: <span style=color:#e6db74>&#34;Efectivo&#34;</span><span style=color:#f92672>})</span>;
</span></span></code></pre></div><ul><li>Creamos las relaciones entre los nodos que hemos creado antes.
Cliente reserva Habitación.</li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-bash data-lang=bash><span style=display:flex><span>serjaii@db:~$ cypher-shell bolt://IP_SERVIDOR:7687 -u neo4j -p <span style=color:#e6db74>&#39;root1234&#39;</span>
</span></span><span style=display:flex><span>neo4j@neo4j&gt; :use neo4j;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>// Cliente reserva Habitación.
</span></span><span style=display:flex><span>MATCH <span style=color:#f92672>(</span>c:Cliente <span style=color:#f92672>{</span>id:1<span style=color:#f92672>})</span>, <span style=color:#f92672>(</span>h:Habitacion <span style=color:#f92672>{</span>id:1<span style=color:#f92672>})</span> CREATE <span style=color:#f92672>(</span>c<span style=color:#f92672>)</span>-<span style=color:#f92672>[</span>:Reserva<span style=color:#f92672>]</span>-&gt;<span style=color:#f92672>(</span>h<span style=color:#f92672>)</span>;
</span></span><span style=display:flex><span>MATCH <span style=color:#f92672>(</span>c:Cliente <span style=color:#f92672>{</span>id:2<span style=color:#f92672>})</span>, <span style=color:#f92672>(</span>h:Habitacion <span style=color:#f92672>{</span>id:3<span style=color:#f92672>})</span> CREATE <span style=color:#f92672>(</span>c<span style=color:#f92672>)</span>-<span style=color:#f92672>[</span>:Reserva<span style=color:#f92672>]</span>-&gt;<span style=color:#f92672>(</span>h<span style=color:#f92672>)</span>;
</span></span><span style=display:flex><span>MATCH <span style=color:#f92672>(</span>c:Cliente <span style=color:#f92672>{</span>id:3<span style=color:#f92672>})</span>, <span style=color:#f92672>(</span>h:Habitacion <span style=color:#f92672>{</span>id:4<span style=color:#f92672>})</span> CREATE <span style=color:#f92672>(</span>c<span style=color:#f92672>)</span>-<span style=color:#f92672>[</span>:Reserva<span style=color:#f92672>]</span>-&gt;<span style=color:#f92672>(</span>h<span style=color:#f92672>)</span>;
</span></span><span style=display:flex><span>MATCH <span style=color:#f92672>(</span>c:Cliente <span style=color:#f92672>{</span>id:4<span style=color:#f92672>})</span>, <span style=color:#f92672>(</span>h:Habitacion <span style=color:#f92672>{</span>id:2<span style=color:#f92672>})</span> CREATE <span style=color:#f92672>(</span>c<span style=color:#f92672>)</span>-<span style=color:#f92672>[</span>:Reserva<span style=color:#f92672>]</span>-&gt;<span style=color:#f92672>(</span>h<span style=color:#f92672>)</span>;
</span></span><span style=display:flex><span>MATCH <span style=color:#f92672>(</span>c:Cliente <span style=color:#f92672>{</span>id:5<span style=color:#f92672>})</span>, <span style=color:#f92672>(</span>h:Habitacion <span style=color:#f92672>{</span>id:6<span style=color:#f92672>})</span> CREATE <span style=color:#f92672>(</span>c<span style=color:#f92672>)</span>-<span style=color:#f92672>[</span>:Reserva<span style=color:#f92672>]</span>-&gt;<span style=color:#f92672>(</span>h<span style=color:#f92672>)</span>;
</span></span><span style=display:flex><span>MATCH <span style=color:#f92672>(</span>c:Cliente <span style=color:#f92672>{</span>id:6<span style=color:#f92672>})</span>, <span style=color:#f92672>(</span>h:Habitacion <span style=color:#f92672>{</span>id:8<span style=color:#f92672>})</span> CREATE <span style=color:#f92672>(</span>c<span style=color:#f92672>)</span>-<span style=color:#f92672>[</span>:Reserva<span style=color:#f92672>]</span>-&gt;<span style=color:#f92672>(</span>h<span style=color:#f92672>)</span>;
</span></span><span style=display:flex><span>MATCH <span style=color:#f92672>(</span>c:Cliente <span style=color:#f92672>{</span>id:7<span style=color:#f92672>})</span>, <span style=color:#f92672>(</span>h:Habitacion <span style=color:#f92672>{</span>id:5<span style=color:#f92672>})</span> CREATE <span style=color:#f92672>(</span>c<span style=color:#f92672>)</span>-<span style=color:#f92672>[</span>:Reserva<span style=color:#f92672>]</span>-&gt;<span style=color:#f92672>(</span>h<span style=color:#f92672>)</span>;
</span></span><span style=display:flex><span>MATCH <span style=color:#f92672>(</span>c:Cliente <span style=color:#f92672>{</span>id:8<span style=color:#f92672>})</span>, <span style=color:#f92672>(</span>h:Habitacion <span style=color:#f92672>{</span>id:7<span style=color:#f92672>})</span> CREATE <span style=color:#f92672>(</span>c<span style=color:#f92672>)</span>-<span style=color:#f92672>[</span>:Reserva<span style=color:#f92672>]</span>-&gt;<span style=color:#f92672>(</span>h<span style=color:#f92672>)</span>;
</span></span><span style=display:flex><span>MATCH <span style=color:#f92672>(</span>c:Cliente <span style=color:#f92672>{</span>id:9<span style=color:#f92672>})</span>, <span style=color:#f92672>(</span>h:Habitacion <span style=color:#f92672>{</span>id:9<span style=color:#f92672>})</span> CREATE <span style=color:#f92672>(</span>c<span style=color:#f92672>)</span>-<span style=color:#f92672>[</span>:Reserva<span style=color:#f92672>]</span>-&gt;<span style=color:#f92672>(</span>h<span style=color:#f92672>)</span>;
</span></span><span style=display:flex><span>MATCH <span style=color:#f92672>(</span>c:Cliente <span style=color:#f92672>{</span>id:10<span style=color:#f92672>})</span>, <span style=color:#f92672>(</span>h:Habitacion <span style=color:#f92672>{</span>id:10<span style=color:#f92672>})</span> CREATE <span style=color:#f92672>(</span>c<span style=color:#f92672>)</span>-<span style=color:#f92672>[</span>:Reserva<span style=color:#f92672>]</span>-&gt;<span style=color:#f92672>(</span>h<span style=color:#f92672>)</span>;
</span></span></code></pre></div><p>// Cliente utiliza Servicio.
MATCH (c:Cliente {id:1}),(s:Servicio{id:1}) CREATE (c)-[:USA]->(s);
MATCH (c:Cliente {id:2}),(s:Servicio{id:4}) CREATE (c)-[:USA]->(s);
MATCH (c:Cliente {id:3}),(s:Servicio{id:5}) CREATE (c)-[:USA]->(s);
MATCH (c:Cliente {id:4}),(s:Servicio{id:2}) CREATE (c)-[:USA]->(s);
MATCH (c:Cliente {id:5}),(s:Servicio{id:3}) CREATE (c)-[:USA]->(s);
MATCH (c:Cliente {id:6}),(s:Servicio{id:8}) CREATE (c)-[:USA]->(s);
MATCH (c:Cliente {id:7}),(s:Servicio{id:6}) CREATE (c)-[:USA]->(s);
MATCH (c:Cliente {id:8}),(s:Servicio{id:7}) CREATE (c)-[:USA]->(s);
MATCH (c:Cliente {id:9}),(s:Servicio{id:9}) CREATE (c)-[:USA]->(s);
MATCH (c:Cliente {id:10}),(s:Servicio{id:10}) CREATE (c)-[:USA]->(s);</p><p>// Cliente realiza Pago.
MATCH (c:Cliente {id:1}),(p:Pagos{id:1}) CREATE (c)-[:PAGA]->(p);
MATCH (c:Cliente {id:2}),(p:Pagos{id:2}) CREATE (c)-[:PAGA]->(p);
MATCH (c:Cliente {id:3}),(p:Pagos{id:3}) CREATE (c)-[:PAGA]->(p);
MATCH (c:Cliente {id:4}),(p:Pagos{id:4}) CREATE (c)-[:PAGA]->(p);
MATCH (c:Cliente {id:5}),(p:Pagos{id:5}) CREATE (c)-[:PAGA]->(p);
MATCH (c:Cliente {id:6}),(p:Pagos{id:6}) CREATE (c)-[:PAGA]->(p);
MATCH (c:Cliente {id:7}),(p:Pagos{id:7}) CREATE (c)-[:PAGA]->(p);
MATCH (c:Cliente {id:8}),(p:Pagos{id:8}) CREATE (c)-[:PAGA]->(p);
MATCH (c:Cliente {id:9}),(p:Pagos{id:9}) CREATE (c)-[:PAGA]->(p);
MATCH (c:Cliente {id:10}),(p:Pagos{id:10}) CREATE (c)-[:PAGA]->(p);</p><pre tabindex=0><code>
### 6.Pruebas del funcionamiento básico de Neo4j.
- Obtener todos los nodos de un tipo. En mi caso, voy a obtener todos los nodos
de Cliente y todos los nodos de Servicio.
- Obtener todos los nodos de un tipo. En mi caso, voy a obtener todos los nodos
de Cliente y todos los nodos de Servicio.
```bash
neo4j@neo4j&gt; MATCH (c:Cliente) RETURN c;
neo4j@neo4j&gt; MATCH (s:Servicio) RETURN s;
</code></pre><ul><li>Obtener un nodo concreto. En mi caso voy a obtener el Cliente con id 1, y las
habitaciones de tipo individual ordenados descendentemente por el número de
habitación. Además, también voy a obtener los pagos de 90€ que se hayan
realizado por transferencia.</li><li>Obtener un nodo concreto. En mi caso voy a obtener el Cliente con id 1, y las
habitaciones de tipo individual ordenados descendentemente por el número de
habitación. Además, también voy a obtener los pagos de 90€ que se hayan
realizado por transferencia.</li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-bash data-lang=bash><span style=display:flex><span>neo4j@neo4j&gt; MATCH <span style=color:#f92672>(</span>c:Cliente <span style=color:#f92672>{</span>id:1<span style=color:#f92672>})</span> RETURN c;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>neo4j@neo4j&gt; MATCH <span style=color:#f92672>(</span>h:Habitacion <span style=color:#f92672>{</span>tipo:<span style=color:#e6db74>&#39;Individual&#39;</span><span style=color:#f92672>})</span>
</span></span><span style=display:flex><span>RETURN h ORDER BY h.numero DESC;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>neo4j@neo4j&gt; MATCH <span style=color:#f92672>(</span>p:Pagos <span style=color:#f92672>{</span>monto: 90, metodo:<span style=color:#e6db74>&#39;Transferencia&#39;</span><span style=color:#f92672>})</span>
</span></span><span style=display:flex><span>RETURN p;
</span></span></code></pre></div><ul><li>Contar cuántos nodos Habitación hay que sean de tipo Suite.</li><li>Contar cuántos nodos Habitación hay que sean de tipo Suite.</li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-bash data-lang=bash><span style=display:flex><span>neo4j@neo4j&gt; MATCH <span style=color:#f92672>(</span>h:Habitacion <span style=color:#f92672>{</span>tipo:<span style=color:#e6db74>&#39;Suite&#39;</span><span style=color:#f92672>})</span>
</span></span><span style=display:flex><span>RETURN COUNT<span style=color:#f92672>(</span>h<span style=color:#f92672>)</span> AS habitaciones_suite;
</span></span></code></pre></div><ul><li>Mostrar todas las relaciones de un nodo. En mi caso, voy a realizar la siguiente
consulta de ejemplo: Mostrar las habitaciones que ha reservado el cliente cuyo
nombre es Jorge y cuyo primer apellido es Santos.</li><li>Mostrar todas las relaciones de un nodo. En mi caso, voy a realizar la siguiente
consulta de ejemplo: Mostrar las habitaciones que ha reservado el cliente cuyo
nombre es Jorge y cuyo primer apellido es Santos.</li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-bash data-lang=bash><span style=display:flex><span>neo4j@neo4j&gt; MATCH <span style=color:#f92672>(</span>c:Cliente <span style=color:#f92672>{</span>nombre:<span style=color:#e6db74>&#34;Jorge&#34;</span>, apellido1:<span style=color:#e6db74>&#34;Santos&#34;</span><span style=color:#f92672>})</span>-<span style=color:#f92672>[</span>r<span style=color:#f92672>]</span>-&gt;<span style=color:#f92672>(</span>h:Habitacion<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>RETURN c.nombre, c.apellido1, r, h.numero, h.tipo;
</span></span></code></pre></div><ul><li>Obtener las habitaciones que ha reservado y los servicios que ha utilizado la
clienta Marta Lopez Gil.</li><li>Obtener las habitaciones que ha reservado y los servicios que ha utilizado la
clienta Marta Lopez Gil.</li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-bash data-lang=bash><span style=display:flex><span>neo4j@neo4j&gt; MATCH <span style=color:#f92672>(</span>c:Cliente <span style=color:#f92672>{</span>nombre:<span style=color:#e6db74>&#34;Marta&#34;</span>, apellido1:<span style=color:#e6db74>&#34;Lopez&#34;</span>, apellido2:<span style=color:#e6db74>&#34;Gil&#34;</span><span style=color:#f92672>})</span>-<span style=color:#f92672>[</span>r<span style=color:#f92672>]</span>-&gt;<span style=color:#f92672>(</span>h:Habitacion<span style=color:#f92672>)</span>,
</span></span><span style=display:flex><span><span style=color:#f92672>(</span>c<span style=color:#f92672>)</span>-<span style=color:#f92672>[</span>u<span style=color:#f92672>]</span>-&gt;<span style=color:#f92672>(</span>s:Servicio<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>RETURN c.nombre, c.apellido1, c.apellido2, r, h.numero, h.tipo, u, s.nombre, s.precio;
</span></span></code></pre></div><ul><li>Obtener el número de servicios que ha utilizado cada cliente.</li><li>Obtener el número de servicios que ha utilizado cada cliente.</li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-bash data-lang=bash><span style=display:flex><span>neo4j@neo4j&gt; MATCH <span style=color:#f92672>(</span>c:Cliente<span style=color:#f92672>)</span>-<span style=color:#f92672>[</span>u<span style=color:#f92672>]</span>-&gt;<span style=color:#f92672>(</span>s:Servicio<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>RETURN c.nombre, c.apellido1, c.apellido2, u, COUNT<span style=color:#f92672>(</span>s<span style=color:#f92672>)</span> AS Total_Servicios;
</span></span></code></pre></div><ul><li>Obtener los clientes que realizaron pagos mayores a 100.</li><li>Obtener los clientes que realizaron pagos mayores a 100.</li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-bash data-lang=bash><span style=display:flex><span>neo4j@neo4j&gt; MATCH <span style=color:#f92672>(</span>c:Cliente<span style=color:#f92672>)</span>-<span style=color:#f92672>[</span>:PAGA<span style=color:#f92672>]</span>-&gt;<span style=color:#f92672>(</span>p:Pagos<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>WHERE p.monto &gt; <span style=color:#ae81ff>100</span>
</span></span><span style=display:flex><span>RETURN c.nombre, c.apellido1, c.apellido2, p.monto;
</span></span></code></pre></div><ul><li>Modificar el precio del servicio Spa de 25€ a 20€.</li><li>Modificar el precio del servicio Spa de 25€ a 20€.</li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-bash data-lang=bash><span style=display:flex><span>neo4j@neo4j&gt; MATCH <span style=color:#f92672>(</span>s:Servicio <span style=color:#f92672>{</span>nombre: <span style=color:#e6db74>&#34;Spa&#34;</span><span style=color:#f92672>})</span>
</span></span><span style=display:flex><span>SET s.precio <span style=color:#f92672>=</span> <span style=color:#ae81ff>20</span>
</span></span><span style=display:flex><span>RETURN s.id, s.nombre, s.precio;
</span></span></code></pre></div><ul><li>Agregar una nueva relación entre Cliente y Habitación.</li><li>Agregar una nueva relación entre Cliente y Habitación.</li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-bash data-lang=bash><span style=display:flex><span>neo4j@neo4j&gt; MATCH <span style=color:#f92672>(</span>c:Cliente <span style=color:#f92672>{</span>id:2<span style=color:#f92672>})</span>, <span style=color:#f92672>(</span>h:Habitacion <span style=color:#f92672>{</span>id:2<span style=color:#f92672>})</span>
</span></span><span style=display:flex><span>CREATE <span style=color:#f92672>(</span>c<span style=color:#f92672>)</span>-<span style=color:#f92672>[</span>:Reserva <span style=color:#f92672>{</span>fecha_entrada: date<span style=color:#f92672>(</span><span style=color:#e6db74>&#34;2025-10-10&#34;</span><span style=color:#f92672>)</span>, fecha_salida:date<span style=color:#f92672>(</span><span style=color:#e6db74>&#34;2025-10-15&#34;</span><span style=color:#f92672>)}]</span>-&gt;<span style=color:#f92672>(</span>h<span style=color:#f92672>)</span>;
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-bash data-lang=bash><span style=display:flex><span>CREATE <span style=color:#f92672>(</span>c<span style=color:#f92672>)</span>-<span style=color:#f92672>[</span>:Reserva <span style=color:#f92672>{</span>fecha_entrada: date<span style=color:#f92672>(</span><span style=color:#e6db74>&#34;2025-1010&#34;</span><span style=color:#f92672>)</span>, fecha_salida:date<span style=color:#f92672>(</span><span style=color:#e6db74>&#34;2025-10-15&#34;</span><span style=color:#f92672>)}]</span>-&gt;<span style=color:#f92672>(</span>h<span style=color:#f92672>)</span>;
</span></span></code></pre></div><ul><li>Borrar un nodo junto con sus relaciones.</li><li>Borrar un nodo junto con sus relaciones.</li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-bash data-lang=bash><span style=display:flex><span>neo4j@neo4j&gt; MATCH <span style=color:#f92672>(</span>p:Pagos <span style=color:#f92672>{</span>id:1<span style=color:#f92672>})</span>
</span></span><span style=display:flex><span>DETACH DELETE p;
</span></span></code></pre></div><ul><li>Listar los clientes ordenados por número de reservas.</li><li>Listar los clientes ordenados por número de reservas.</li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-bash data-lang=bash><span style=display:flex><span>neo4j@neo4j&gt; MATCH <span style=color:#f92672>(</span>c:Cliente<span style=color:#f92672>)</span>-<span style=color:#f92672>[</span>:Reserva<span style=color:#f92672>]</span>-&gt;<span style=color:#f92672>(</span>h:Habitacion<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>RETURN c.nombre, COUNT<span style=color:#f92672>(</span>h<span style=color:#f92672>)</span> AS Total_Reservas
</span></span><span style=display:flex><span>ORDER BY Total_Reservas DESC;
</span></span></code></pre></div><ul><li>Sumar todos los pagos de un cliente.</li><li>Sumar todos los pagos de un cliente.</li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-bash data-lang=bash><span style=display:flex><span>neo4j@neo4j&gt; MATCH <span style=color:#f92672>(</span>c:Cliente <span style=color:#f92672>{</span>id:3<span style=color:#f92672>})</span>-<span style=color:#f92672>[</span>:PAGA<span style=color:#f92672>]</span>-&gt;<span style=color:#f92672>(</span>p:Pagos<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>RETURN c.nombre, c.apellido1, c.apellido2, SUM<span style=color:#f92672>(</span>p.monto<span style=color:#f92672>)</span> AS total_pagado;
</span></span></code></pre></div><h2 id=instalación-servidor-redis-en-debian-13>Instalación Servidor Redis en Debian 13</h2><h3 id=1dependencias-y-configuración-previa-1>1.Dependencias y configuración previa</h3><ul><li>En primer lugar usaremos apt para instalar las dependencias necesarias para
Redis</li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-bash data-lang=bash><span style=display:flex><span>serjaii@db:~$ sudo apt update
</span></span></code></pre></div><ul><li>Para añadir el repositorio de Redis a nuestra máquina será necesaria una clave
GPG.</li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-bash data-lang=bash><span style=display:flex><span>serjaii@db:~$ curl -fsSL https://packages.redis.io/gpg | sudo gpg --dearmor -o /usr/share/keyrings/redis-archivekeyring.gpg <span style=color:#f92672>&amp;&amp;</span> sudo chmod <span style=color:#ae81ff>644</span> /usr/share/keyrings/redis-archive-keyring.gpg
</span></span></code></pre></div><ul><li>Ahora si podemos añadir el repositorio de Redis y realizar un apt update</li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-bash data-lang=bash><span style=display:flex><span>serjaii@db:~$ echo <span style=color:#e6db74>&#34;deb [signed-by=/usr/share/keyrings/redis-archive-keyring.gpg] https://packages.redis.io/deb </span><span style=color:#66d9ef>$(</span>lsb_release -cs<span style=color:#66d9ef>)</span><span style=color:#e6db74> main&#34;</span> | sudo tee /etc/apt/sources.list.d/redis.list <span style=color:#f92672>&amp;&amp;</span> sudo apt update
</span></span></code></pre></div><h3 id=2instalación-del-servidor-4>2.Instalación del servidor</h3><ul><li>Instalamos el servidor Redis</li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-bash data-lang=bash><span style=display:flex><span>serjaii@db:~$ sudo apt install redis
</span></span></code></pre></div><ul><li>Iniciamos el servicio de Redis con systemctl</li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-bash data-lang=bash><span style=display:flex><span>serjaii@db:~$ sudo systemctl enable redis-server
</span></span><span style=display:flex><span>serjaii@db:~$ sudo systemctl start redis-server
</span></span></code></pre></div><ul><li>Comprobamos que podemos acceder al servidor y ejecutar instrucciones sobre
él</li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-bash data-lang=bash><span style=display:flex><span>serjaii@db:~$ redis-cli
</span></span></code></pre></div><h3 id=3configuración-del-servidor-redis-para-acceso-remoto>3.Configuración del servidor Redis para acceso remoto</h3><ul><li>Por defecto Redis escucha sólo en localhost. Por lo tanto, vamos a modificar en
el fichero “/etc/redis/redis.conf” en el que buscaremos comentar la linea “bind
127.0.0.1 -::1 la cual hará que se acepten conexiones externas” y la cambiamos</li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-bash data-lang=bash><span style=display:flex><span>serjaii@db:~$ sudo nano /etc/redis/redis.conf
</span></span></code></pre></div><ul><li>De igual forma la linea protected-mode la vamos a deshabilitar y a su vez
añadiremos una password para el acceso remoto</li></ul><h3 id=4configuración-del-cliente-redis-cli-para-acceso-remoto>4.Configuración del cliente Redis-cli para acceso remoto</h3><ul><li>En primer lugar actualizamos los paquetes del sistema</li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-bash data-lang=bash><span style=display:flex><span>serjaii@db:~$ sudo apt update
</span></span><span style=display:flex><span>serjaii@db:~$ sudo apt install redis-tools
</span></span></code></pre></div><ul><li>Comprobamos que podemos acceder remotamente</li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-bash data-lang=bash><span style=display:flex><span>serjaii@db:~$ redis-cli -h bd -p <span style=color:#ae81ff>6379</span> -a clienteredis
</span></span></code></pre></div><h3 id=5creación-de-usuariobase-de-datos-e-inserción-de-datos>5.Creación de usuario,base de datos e inserción de datos</h3><ul><li>Ingresamos a la base de datos y creamos el usuario</li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-bash data-lang=bash><span style=display:flex><span>serjaii@db:~$ redis-cli
</span></span><span style=display:flex><span>bd:6379&gt; ACL SETUSER serjaii on &gt;serjaii ~* +@all
</span></span><span style=display:flex><span>OK
</span></span></code></pre></div><ul><li>Accedemos con el nuevo usuario</li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-bash data-lang=bash><span style=display:flex><span>serjaii@db:~$ redis-cli -h bd -p <span style=color:#ae81ff>6379</span> -a serjaii --user serjaii
</span></span><span style=display:flex><span>Warning: Using a password with <span style=color:#e6db74>&#39;-a&#39;</span> or <span style=color:#e6db74>&#39;-u&#39;</span> option on the
</span></span><span style=display:flex><span>command line interface may not be safe.
</span></span></code></pre></div><ul><li><p>Redis no trabaja con bases de datos ni tablas sino grafos y nodos,crearemos un
grafo de ejemplo e insertaremos datos</p></li><li><p>Clientes:</p></li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-bash data-lang=bash><span style=display:flex><span>HSET cliente:1 id <span style=color:#ae81ff>1</span> nombre <span style=color:#e6db74>&#34;David&#34;</span> apellido1 <span style=color:#e6db74>&#34;Dorado&#34;</span> apellido2 <span style=color:#e6db74>&#34;Lopez&#34;</span> email <span style=color:#e6db74>&#34;davidd@gmail.com&#34;</span> telefono <span style=color:#e6db74>&#34;600111222&#34;</span>
</span></span><span style=display:flex><span>HSET cliente:2 id <span style=color:#ae81ff>2</span> nombre <span style=color:#e6db74>&#34;Maria&#34;</span> apellido1 <span style=color:#e6db74>&#34;Dorado&#34;</span> apellido2 <span style=color:#e6db74>&#34;Lopez&#34;</span> email <span style=color:#e6db74>&#34;maria@gmail.com&#34;</span> telefono <span style=color:#e6db74>&#34;600333444&#34;</span>
</span></span><span style=display:flex><span>HSET cliente:3 id <span style=color:#ae81ff>3</span> nombre <span style=color:#e6db74>&#34;Jorge&#34;</span> apellido1 <span style=color:#e6db74>&#34;Santos&#34;</span> apellido2 <span style=color:#e6db74>&#34;Diaz&#34;</span> email <span style=color:#e6db74>&#34;jorgesantos@gmail.com&#34;</span> telefono <span style=color:#e6db74>&#34;600555666&#34;</span>
</span></span></code></pre></div><p>HSET cliente:4 id 4 nombre &ldquo;Lucia&rdquo; apellido1 &ldquo;Romero&rdquo; apellido2 &ldquo;Garcia&rdquo; email &ldquo;<a class=link href=mailto:luciarom@yahoot.es>luciarom@yahoot.es</a>&rdquo; telefono &ldquo;600777888&rdquo;
HSET cliente:5 id 5 nombre &ldquo;Pablo&rdquo; apellido1 &ldquo;Ruiz&rdquo; apellido2 &ldquo;Torres&rdquo; email &ldquo;<a class=link href=mailto:pablo@gmail.com>pablo@gmail.com</a>&rdquo; telefono &ldquo;600999000&rdquo;
HSET cliente:6 id 6 nombre &ldquo;Sofia&rdquo; apellido1 &ldquo;Martinez&rdquo; apellido2 &ldquo;Leon&rdquo; email &ldquo;<a class=link href=mailto:sofleon@yahoot.es>sofleon@yahoot.es</a>&rdquo; telefono &ldquo;601111222&rdquo;
HSET cliente:7 id 7 nombre &ldquo;Roberto&rdquo; apellido1 &ldquo;Navas&rdquo; apellido2 &ldquo;Cruz&rdquo; email &ldquo;<a class=link href=mailto:albertonavas@yahoot.es>albertonavas@yahoot.es</a>&rdquo; telefono &ldquo;601333444&rdquo;
HSET cliente:8 id 8 nombre &ldquo;Marta&rdquo; apellido1 &ldquo;Lopez&rdquo; apellido2 &ldquo;Gil&rdquo; email &ldquo;<a class=link href=mailto:marta@gmail.com>marta@gmail.com</a>&rdquo; telefono &ldquo;601555666&rdquo;
HSET cliente:9 id 9 nombre &ldquo;Raul&rdquo; apellido1 &ldquo;Castro&rdquo; apellido2 &ldquo;Vega&rdquo; email &ldquo;<a class=link href=mailto:raulcastro@gmail.com>raulcastro@gmail.com</a>&rdquo; telefono &ldquo;601777888&rdquo;
HSET cliente:10 id 10 nombre &ldquo;Laura&rdquo; apellido1 &ldquo;Morales&rdquo; apellido2 &ldquo;Cano&rdquo; email &ldquo;<a class=link href=mailto:laura@gmail.com>laura@gmail.com</a>&rdquo; telefono &ldquo;601999000&rdquo;</p><ul><li><p>Habitacion:
HSET habitacion:1 id 1 numero 101 tipo &ldquo;Individual&rdquo;
HSET habitacion:2 id 2 numero 102 tipo &ldquo;Doble&rdquo;
HSET habitacion:3 id 3 numero 103 tipo &ldquo;Suite&rdquo;
HSET habitacion:4 id 4 numero 104 tipo &ldquo;Individual&rdquo;
HSET habitacion:5 id 5 numero 105 tipo &ldquo;Doble&rdquo;
HSET habitacion:6 id 6 numero 106 tipo &ldquo;Suite&rdquo;
HSET habitacion:7 id 7 numero 107 tipo &ldquo;Individual&rdquo;
HSET habitacion:8 id 8 numero 108 tipo &ldquo;Doble&rdquo;
HSET habitacion:9 id 9 numero 109 tipo &ldquo;Suite&rdquo;
HSET habitacion:10 id 10 numero 110 tipo &ldquo;Doble&rdquo;</p></li><li><p>Servicio:
HSET servicio:1 id 1 nombre &ldquo;Restaurante&rdquo; precio 15
HSET servicio:2 id 2 nombre &ldquo;Piscina&rdquo; precio 5
HSET servicio:3 id 3 nombre &ldquo;Spa&rdquo; precio 25
HSET servicio:4 id 4 nombre &ldquo;Gimnasio&rdquo; precio 10
HSET servicio:5 id 5 nombre &ldquo;Parking&rdquo; precio 8
HSET servicio:6 id 6 nombre &ldquo;Transporte&rdquo; precio 12
HSET servicio:7 id 7 nombre &ldquo;WiFi Premium&rdquo; precio 3
HSET servicio:8 id 8 nombre &ldquo;Canguro&rdquo; precio 20
HSET servicio:9 id 9 nombre &ldquo;Excursión&rdquo; precio 30
HSET servicio:10 id 10 nombre &ldquo;Alquiler Bicicleta&rdquo; precio 7</p></li><li><p>Pago:
HSET pago:1 id 1 monto 100 metodo &ldquo;Tarjeta&rdquo;
HSET pago:2 id 2 monto 200 metodo &ldquo;Efectivo&rdquo;
HSET pago:3 id 3 monto 150 metodo &ldquo;Transferencia&rdquo;
HSET pago:4 id 4 monto 120 metodo &ldquo;Tarjeta&rdquo;
HSET pago:5 id 5 monto 250 metodo &ldquo;Efectivo&rdquo;
HSET pago:6 id 6 monto 180 metodo &ldquo;Tarjeta&rdquo;
HSET pago:7 id 7 monto 90 metodo &ldquo;Transferencia&rdquo;
HSET pago:8 id 8 monto 300 metodo &ldquo;Efectivo&rdquo;
HSET pago:9 id 9 monto 50 metodo &ldquo;Tarjeta&rdquo;
HSET pago:10 id 10 monto 75 metodo &ldquo;Efectivo&rdquo;</p></li></ul><h3 id=6pruebas-de-funcionamiento>6.Pruebas de funcionamiento</h3><ul><li><p>Listar todas las claves creadas
bd:6379> KEYS *</p></li><li><p>Comprobar un cliente
bd:6379> HGETALL cliente:4</p></li><li><p>Buscar por campo
bd:6379> SCAN 0 MATCH cliente:* COUNT 100</p></li></ul><h2 id=instalación-servidor-cassandra-en-debian-13>Instalación Servidor Cassandra en Debian 13</h2><h3 id=1dependencias-y-configuración-previa-2>1.Dependencias y configuración previa</h3><ul><li>Como siempre, comenzamos actualizando los repositorios del sistema:</li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-bash data-lang=bash><span style=display:flex><span>sudo apt update
</span></span><span style=display:flex><span>sudo apt upgrade -y
</span></span></code></pre></div><ul><li>Instalar Java 11<ul><li>Cassandra 4.1.5 requiere Java 11. Como Debian Trixie no lo tiene en sus
repositorios oficiales, lo instalaremos desde Adoptium:</li></ul></li><li>Instalamos las dependencias necesarias</li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-bash data-lang=bash><span style=display:flex><span>sudo apt install -y wget apt-transport-https gpg
</span></span></code></pre></div><ul><li>Añadir la clave GPG del repositorio de Adoptium</li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-bash data-lang=bash><span style=display:flex><span>serjaii@db:~$ wget -qO - https://packages.adoptium.net/artifactory/api/gpg/key/public | sudo gpg --dearmor -o /usr/share/keyrings/adoptium.gpg
</span></span></code></pre></div><ul><li>Añadir el repositorio</li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-bash data-lang=bash><span style=display:flex><span>serjaii@db:~$ echo <span style=color:#e6db74>&#34;deb [signed-by=/usr/share/keyrings/adoptium.gpg] https://packages.adoptium.net/artifactory/deb bookworm main&#34;</span> | sudo tee /etc/apt/sources.list.d/adoptium.list
</span></span></code></pre></div><ul><li>Actualizar e instalar Java 11</li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-bash data-lang=bash><span style=display:flex><span>sudo apt update
</span></span><span style=display:flex><span>sudo apt install -y temurin-11-jdk
</span></span></code></pre></div><ul><li>Verificar instalación
java -version</li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-bash data-lang=bash><span style=display:flex><span>serjaii@db:~$ java -version openjdk version <span style=color:#e6db74>&#34;11.0.28&#34;</span> 2025-07-15 OpenJDK Runtime Environment Temurin-11.0.28+6 <span style=color:#f92672>(</span>build 11.0.28+6<span style=color:#f92672>)</span> OpenJDK 64-Bit Server VM Temurin-11.0.28+6 <span style=color:#f92672>(</span>build 11.0.28+6, mixed mode<span style=color:#f92672>)</span>
</span></span></code></pre></div><ul><li>Instalar dependencias adicionales<ul><li>Necesitamos herramientas para compilar drivers de Python:</li></ul></li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-bash data-lang=bash><span style=display:flex><span>sudo apt install -y python3-pip python3-dev python3-six buildessential libev-dev libssl-dev libffi-dev unzip zip wget
</span></span></code></pre></div><ul><li>Explicación:<ul><li>python3-pip → Gestor de paquetes de Python</li><li>python3-dev → Archivos de desarrollo de Python</li><li>python3-six → Librería de compatibilidad Python 2/3</li><li>build-essential → Herramientas de compilación (gcc, make)</li><li>libev-dev → Librería para event loops</li><li>unzip/zip → Para manipular archivos comprimidos</li></ul></li></ul><h3 id=2instalación-del-servidor-5>2.Instalación del servidor</h3><ul><li><p>Descargamos Cassandra desde el archivo oficial de Apache y lo extraemos
en /opt/cassandra para tener una instalación limpia y organizada.</p></li><li><p>Entramos al directorio /opt
cd /opt</p></li><li><p>Descargar Cassandra 4.1.5</p></li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-bash data-lang=bash><span style=display:flex><span>sudo wget https://archive.apache.org/dist/cassandra/4.1.5/apachecassandra-4.1.5-bin.tar.gz
</span></span></code></pre></div><ul><li>Extraer el archivo</li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-bash data-lang=bash><span style=display:flex><span>sudo tar -xzf apache-cassandra-4.1.5-bin.tar.gz
</span></span></code></pre></div><ul><li>Renombrar para facilitar el acceso</li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-bash data-lang=bash><span style=display:flex><span>sudo mv apache-cassandra-4.1.5 cassandra
</span></span></code></pre></div><ul><li>Eliminar el archivo comprimido</li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-bash data-lang=bash><span style=display:flex><span>sudo rm apache-cassandra-4.1.5-bin.tar.gz
</span></span></code></pre></div><ul><li>Crear usuario para Cassandra<ul><li>Por seguridad, Cassandra no debe ejecutarse como root:</li></ul></li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-bash data-lang=bash><span style=display:flex><span>sudo useradd -r -s /bin/false cassandra
</span></span><span style=display:flex><span>sudo chown -R cassandra:cassandra /opt/cassandra
</span></span></code></pre></div><ul><li>Explicación:<ul><li>-r → Crea un usuario del sistema (sin directorio home)</li><li>-s /bin/false → Sin shell de login (más seguro)</li></ul></li></ul><p>Configurar Cassandra como servicio systemd</p><ul><li>Creamos un servicio para que Cassandra se inicie automáticamente:</li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-bash data-lang=bash><span style=display:flex><span>sudo nano /etc/systemd/system/cassandra.service
</span></span></code></pre></div><ul><li>Tenemos que añadir lo siguiente</li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-ini data-lang=ini><span style=display:flex><span><span style=color:#66d9ef>[Unit]</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>Description</span><span style=color:#f92672>=</span><span style=color:#e6db74>Apache Cassandra</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>After</span><span style=color:#f92672>=</span><span style=color:#e6db74>network.target</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>[Service]</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>Type</span><span style=color:#f92672>=</span><span style=color:#e6db74>forking</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>User</span><span style=color:#f92672>=</span><span style=color:#e6db74>cassandra</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>Group</span><span style=color:#f92672>=</span><span style=color:#e6db74>cassandra</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>ExecStart</span><span style=color:#f92672>=</span><span style=color:#e6db74>/opt/cassandra/bin/cassandra -p /opt/cassandra/cassandra.pid</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>ExecStop</span><span style=color:#f92672>=</span><span style=color:#e6db74>/bin/kill -TERM $MAINPID</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>Environment</span><span style=color:#f92672>=</span><span style=color:#e6db74>JAVA_HOME=/usr/lib/jvm/temurin-11-jdk-amd64</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>Restart</span><span style=color:#f92672>=</span><span style=color:#e6db74>always</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>LimitNOFILE</span><span style=color:#f92672>=</span><span style=color:#e6db74>100000</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>[Install]</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>WantedBy</span><span style=color:#f92672>=</span><span style=color:#e6db74>multi-user.target</span>
</span></span></code></pre></div><ul><li>Explicación de las opciones:</li><li>Type=forking → Cassandra se ejecuta en segundo plano</li><li>User=cassandra → Se ejecuta con el usuario cassandra</li><li>Environment=JAVA_HOME → Define dónde está Java instalado</li><li>LimitNOFILE=100000 → Aumenta el límite de archivos abiertos
(necesario para Cassandra)
Iniciar Cassandra</li><li>Recargar systemd</li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-bash data-lang=bash><span style=display:flex><span>sudo systemctl daemon-reload
</span></span></code></pre></div><ul><li>Habilitar inicio automático</li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-bash data-lang=bash><span style=display:flex><span>sudo systemctl enable cassandra
</span></span></code></pre></div><ul><li>Iniciar Cassandra</li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-bash data-lang=bash><span style=display:flex><span>sudo systemctl start cassandra
</span></span></code></pre></div><ul><li>Verificar estado</li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-bash data-lang=bash><span style=display:flex><span>sudo systemctl status cassandra
</span></span></code></pre></div><ul><li>Ahora esperamos unos 30 segundos para que se inicie todo bien y
comprobamos que esté escuchando en localhost:</li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-bash data-lang=bash><span style=display:flex><span>sudo ss -tulpn | grep <span style=color:#ae81ff>9042</span>
</span></span></code></pre></div><ul><li>Nos debería salir algo como lo siguiente</li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-bash data-lang=bash><span style=display:flex><span>serjaii@db:~$ sudo ss -tulpn | grep <span style=color:#ae81ff>9042</span> tcp LISTEN <span style=color:#ae81ff>0</span> 127.0.0.1:9042 0.0.0.0:* users:<span style=color:#f92672>((</span><span style=color:#e6db74>&#34;java&#34;</span>,pid<span style=color:#f92672>=</span>3393,fd<span style=color:#f92672>=</span>154<span style=color:#f92672>))</span> Instalar y configurar cqlsh <span style=color:#f92672>(</span>Cliente de Cassandra<span style=color:#f92672>)</span>
</span></span></code></pre></div><ul><li>Instalar drivers de Python</li><li>Instalar el driver de Cassandra desde código fuente</li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-bash data-lang=bash><span style=display:flex><span>pip3 install --user --break-system-packages --no-cache-dir --nobinary :all: cassandra-driver
</span></span><span style=display:flex><span><span style=color:#75715e># Instalar eventlet y futurist (necesarios para Python 3.13)</span>
</span></span><span style=display:flex><span>pip3 install --user --break-system-packages eventlet futurist
</span></span></code></pre></div><ul><li>Python 3.13 eliminó el módulo asyncore, por lo que necesitamos usar eventlet
como reactor de eventos alternativo.
Configurar el driver para Python 3.13</li><li>El driver de Cassandra no es compatible con Python 3.13 por defecto.
Necesitamos modificarlo:</li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#75715e># Modificar cluster.py automáticamente</span>
</span></span><span style=display:flex><span>python3 <span style=color:#e6db74>&lt;&lt; &#39;EOF&#39;
</span></span></span><span style=display:flex><span><span style=color:#e6db74>import re
</span></span></span><span style=display:flex><span><span style=color:#e6db74>site_packages = __import__(&#39;site&#39;).USER_SITE
</span></span></span><span style=display:flex><span><span style=color:#e6db74>cluster_file = f&#34;{site_packages}/cassandra/cluster.py&#34;
</span></span></span><span style=display:flex><span><span style=color:#e6db74>with open(cluster_file, &#39;r&#39;) as f:
</span></span></span><span style=display:flex><span><span style=color:#e6db74>    content = f.read()
</span></span></span><span style=display:flex><span><span style=color:#e6db74># Buscar y reemplazar el bloque problemático
</span></span></span><span style=display:flex><span><span style=color:#e6db74>pattern = r&#39;if not conn_class:.*?raise DependencyException\([^)]+\)&#39;
</span></span></span><span style=display:flex><span><span style=color:#e6db74>replacement = &#39;&#39;&#39;if not conn_class:
</span></span></span><span style=display:flex><span><span style=color:#e6db74>    from cassandra.io.eventletreactor import EventletConnection
</span></span></span><span style=display:flex><span><span style=color:#e6db74>    default_connection_class = EventletConnection
</span></span></span><span style=display:flex><span><span style=color:#e6db74>    conn_class = EventletConnection
</span></span></span><span style=display:flex><span><span style=color:#e6db74>    DefaultConnection = conn_class&#39;&#39;&#39;
</span></span></span><span style=display:flex><span><span style=color:#e6db74>content_modified = re.sub(pattern, replacement, content, flags=re.DOTALL)
</span></span></span><span style=display:flex><span><span style=color:#e6db74>with open(cluster_file, &#39;w&#39;) as f:
</span></span></span><span style=display:flex><span><span style=color:#e6db74>    f.write(content_modified)
</span></span></span><span style=display:flex><span><span style=color:#e6db74>print(&#34;✓ cluster.py modificado correctamente&#34;)
</span></span></span><span style=display:flex><span><span style=color:#e6db74>EOF</span>
</span></span></code></pre></div><ul><li>Este script modifica el driver para usar Eventlet en lugar de libev o asyncore.
Solucionar problema del driver interno de Cassandra</li><li>El driver interno que viene con Cassandra (en formato ZIP) no puede encontrar
el módulo six. Vamos a extraerlo e insertar six:
cd /opt/cassandra/lib</li><li>Hacer backup del ZIP original</li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-bash data-lang=bash><span style=display:flex><span>sudo cp cassandra-driver-internal-only-3.25.0.zip cassandradriver-internal-only-3.25.0.zip.backup
</span></span></code></pre></div><ul><li>Extraer el ZIP permanentemente</li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-bash data-lang=bash><span style=display:flex><span>sudo unzip -q cassandra-driver-internal-only-3.25.0.zip
</span></span></code></pre></div><ul><li>Copiar el módulo six desde el sistema</li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-bash data-lang=bash><span style=display:flex><span>sudo cp /usr/lib/python3/dist-packages/six.py cassandradriver-3.25.0/
</span></span></code></pre></div><ul><li>Copiar también la metadata de six</li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-bash data-lang=bash><span style=display:flex><span>sudo cp -r /usr/lib/python3/dist-packages/six-*.dist-info cassandradriver-3.25.0/ 2&gt;/dev/null <span style=color:#f92672>||</span> true
</span></span></code></pre></div><ul><li>IMPORTANTE: Eliminar el ZIP para que Python use el directorio extraído</li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-bash data-lang=bash><span style=display:flex><span>sudo rm -f cassandra-driver-internal-only-3.25.0.zip
</span></span></code></pre></div><ul><li>Ajustar permisos</li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-bash data-lang=bash><span style=display:flex><span>sudo chown -R cassandra:cassandra cassandra-driver-3.25.0
</span></span></code></pre></div><ul><li>El driver empaquetado en ZIP no puede importar módulos externos. Al
extraerlo y copiar six.py dentro, solucionamos el problema.
Crear wrapper para cqlsh</li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-bash data-lang=bash><span style=display:flex><span>sudo nano /usr/local/bin/cqlsh
</span></span></code></pre></div><ul><li>tenemos que pegar el siguiente contenido</li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#75715e>#!/bin/bash
</span></span></span><span style=display:flex><span>export PYTHONPATH<span style=color:#f92672>=</span>/usr/lib/python3/dist-packages:$HOME/.local/lib/python3.13/site-packages
</span></span><span style=display:flex><span>exec /opt/cassandra/bin/cqlsh <span style=color:#e6db74>&#34;</span>$@<span style=color:#e6db74>&#34;</span>
</span></span></code></pre></div><ul><li>Lo guardamos y lo hacemos ejecutable con lo siguiente</li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-bash data-lang=bash><span style=display:flex><span>sudo chmod +x /usr/local/bin/cqlsh
</span></span></code></pre></div><ul><li>Este wrapper configura el PYTHONPATH correctamente para que cqlsh
encuentre todas las librerías necesarias.
Configurar variables de entorno
echo &rsquo;&rsquo; &#187; ~/.bashrc
echo &lsquo;# Cassandra configuración&rsquo; &#187; ~/.bashrc
echo &rsquo;export CASSANDRA_HOME=/opt/cassandra&rsquo; &#187; ~/.bashrc
echo &rsquo;export PATH=$PATH:$CASSANDRA_HOME/bin&rsquo; &#187;
~/.bashrc</li><li>Aplicamos los cambios
source ~/.bashrc</li><li>Ya podríamos entrar al servidor localmente ejecutando :
cqlsh</li></ul><h3 id=3configuración-del-servidor-cassandra-para-acceso-remoto>3.Configuración del servidor Cassandra para acceso remoto</h3><ul><li>Primero tenemos que ver la ip de nuestro servidor , simplemente con un ip a y
quedarnos con la ip
2: enp1s0: &lt;BROADCAST,MULTICAST,UP,LOWER_UP> mtu
1500 qdisc fq_codel state UP group default qlen 1000
link/ether 52:54:00:c1:44:60 brd ff:ff:ff:ff:ff:ff
altname enx525400c14460
inet 192.168.122.161/24 brd 192.168.122.255 scope global</li><li>Tenemos que editar el siguiente fichero</li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-bash data-lang=bash><span style=display:flex><span>serjaii@db:~$ sudo nano /opt/cassandra/conf/cassandra.yaml
</span></span></code></pre></div><ul><li><p>y cambiar lo siguientes parámetros de localhost a la ip de nuestro servidor</p></li><li><p>Esa línea está por defecto comentada la descomentamos y ponemos también la
ip del servidor</p></li></ul><p>Es importante que en este caso no podemos usar 0.0.0.0 ya que cassandra no lo
permite tenemos que poner siempre la ip de nuestro servidor
Ya con todo eso modificamos guardamos y salimos del fichero</p><ul><li>Reiniciamos cassandra</li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-bash data-lang=bash><span style=display:flex><span>sudo systemctl restart cassandra
</span></span></code></pre></div><ul><li>Esperamos unos segundos y verificamos que está escuchando</li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-bash data-lang=bash><span style=display:flex><span>sudo ss -tulpn | grep <span style=color:#ae81ff>9042</span>
</span></span></code></pre></div><ul><li>Podemos ver que la ip ha cambiado ahora esta la ip de nuestro servidor en vez
de localhost que es la 127.0.0.1</li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-bash data-lang=bash><span style=display:flex><span>serjaii@db:~$ sudo ss -tulpn | grep <span style=color:#ae81ff>9042</span> tcp LISTEN <span style=color:#ae81ff>0</span> 192.168.122.161:9042 0.0.0.0:* users:<span style=color:#f92672>((</span><span style=color:#e6db74>&#34;java&#34;</span>,pid <span style=color:#f92672>=</span>4057,fd<span style=color:#f92672>=</span>159<span style=color:#f92672>))</span>
</span></span></code></pre></div><h3 id=4configuración-del-cliente-cassandra-para-acceso-remoto>4.Configuración del cliente Cassandra para acceso remoto</h3><ul><li>Actualizar el sistema cliente</li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-bash data-lang=bash><span style=display:flex><span>sudo apt update
</span></span></code></pre></div><ul><li>Instalar cqlsh en el cliente
pip3 install &ndash;user &ndash;break-system-packages cqlsh</li><li>Instalar dependencias necesarias
pip3 install &ndash;user &ndash;break-system-packages eventlet futurist</li><li>Configurar el driver en el cliente es igual que lo que hemos hecho en el
servidor</li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-python data-lang=python><span style=display:flex><span>python3 <span style=color:#f92672>&lt;&lt;</span> <span style=color:#e6db74>&#39;EOF&#39;</span>
</span></span><span style=display:flex><span><span style=color:#f92672>import</span> re
</span></span><span style=display:flex><span>site_packages <span style=color:#f92672>=</span> __import__(<span style=color:#e6db74>&#39;site&#39;</span>)<span style=color:#f92672>.</span>USER_SITE
</span></span><span style=display:flex><span>cluster_file <span style=color:#f92672>=</span> <span style=color:#e6db74>f</span><span style=color:#e6db74>&#34;</span><span style=color:#e6db74>{</span>site_packages<span style=color:#e6db74>}</span><span style=color:#e6db74>/cassandra/cluster.py&#34;</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>with</span> open(cluster_file, <span style=color:#e6db74>&#39;r&#39;</span>) <span style=color:#66d9ef>as</span> f:
</span></span><span style=display:flex><span>    content <span style=color:#f92672>=</span> f<span style=color:#f92672>.</span>read()
</span></span><span style=display:flex><span>pattern <span style=color:#f92672>=</span> <span style=color:#e6db74>r</span><span style=color:#e6db74>&#39;if not conn_class:.*?raise DependencyException\([^)]+\)&#39;</span>
</span></span><span style=display:flex><span>replacement <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;&#39;&#39;if not conn_class:
</span></span></span><span style=display:flex><span><span style=color:#e6db74>    from cassandra.io.eventletreactor import EventletConnection
</span></span></span><span style=display:flex><span><span style=color:#e6db74>    default_connection_class = EventletConnection
</span></span></span><span style=display:flex><span><span style=color:#e6db74>    conn_class = EventletConnection
</span></span></span><span style=display:flex><span><span style=color:#e6db74>    DefaultConnection = conn_class&#39;&#39;&#39;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>content_modified <span style=color:#f92672>=</span> re<span style=color:#f92672>.</span>sub(pattern, replacement, content, flags<span style=color:#f92672>=</span>re<span style=color:#f92672>.</span>DOTALL)
</span></span><span style=display:flex><span><span style=color:#66d9ef>with</span> open(cluster_file, <span style=color:#e6db74>&#39;w&#39;</span>) <span style=color:#66d9ef>as</span> f:
</span></span><span style=display:flex><span>    f<span style=color:#f92672>.</span>write(content_modified)
</span></span><span style=display:flex><span>print(<span style=color:#e6db74>&#34;✓ cluster.py modificado correctamente&#34;</span>)
</span></span><span style=display:flex><span>EOF
</span></span></code></pre></div><ul><li>Añadir cqlsh al PATH
echo &rsquo;export PATH=$PATH:~/.local/bin&rsquo; &#187; ~/.bashrc</li><li>Aplicamos los cambios
source ~/.bashrc</li><li>Ya podemos conectarnos desde el cliente al servidor
cqlsh 192.168.122.161</li></ul><h3 id=5funcionamiento-básico-de-cassandra>5.Funcionamiento básico de Cassandra</h3><p>-Conceptos fundamentales</p><ul><li><p>¿Qué es un Keyspace?</p><ul><li>Un keyspace en Cassandra es equivalente a una base de datos en SQL.
Contiene las tablas y define la estrategia de replicación de datos.</li></ul></li><li><p>¿Qué es la replicación?</p><ul><li>Cassandra distribuye copias de los datos en múltiples nodos para
garantizar disponibilidad y tolerancia a fallos.
-Gestión de usuario en Cassandra</li></ul></li><li><p>Por defecto, Cassandra NO requiere usuario/contraseña. Para habilitarla:</p></li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-bash data-lang=bash><span style=display:flex><span>sudo nano /opt/cassandra/conf/cassandra.yaml
</span></span><span style=display:flex><span>Tenemos que cambiar las siguientes líneas
</span></span></code></pre></div><p>Reiniciamos el sistema y comprobamos desde remoto con usuario y contraseña</p><p>Para crear usuario con permisos de root usamos lo siguiente
Para ver los usuarios que tenemos creados</p><p>También podemos cambiar la contraseña por defecto de cassandra o cualquier usuario
con :</p><ul><li><p>Dar los permisos de esta tabla a un usuario especifico</p></li><li><p>Podemos ver también los permisos que tiene el usuario que queramos y sobre
qué base de datos tiene permisos</p></li><li><p>Si queremos darle un permisos específico sobre una base de datos a un usuario
lo hacemos de la siguiente forma</p></li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-bash data-lang=bash><span style=display:flex><span>GRANT SELECT ON KEYSPACE <span style=color:#f92672>(</span>base de datos<span style=color:#f92672>)</span> TO <span style=color:#f92672>(</span>usuario<span style=color:#f92672>)</span>;
</span></span></code></pre></div><ul><li><p>Ahora si listamos los permisos podemos ver que se le han aplicado permisos de
lectura al usuario bibliotecario sobre tienda</p></li><li><p>Tipos de permisos</p><ul><li>CREATE →Crear nuevas tablas, tipos, índices</li><li>ALTER → Modificar estructura de tablas</li><li>DROP → Eliminar tablas, tipos</li><li>SELECT → Leer datos (consultas)</li><li>MODIFY → Insertar, actualizar, eliminar datos</li><li>AUTHORIZE → Dar/quitar permisos a otros usuarios</li><li>ALL →Todos los permisos anteriores</li></ul></li><li><p>Quitar un permiso específico
REVOKE SELECT ON KEYSPACE biblioteca FROM usuario;</p></li><li><p>Quitar múltiples permisos
REVOKE SELECT, MODIFY ON KEYSPACE biblioteca FROM
usuario;</p></li><li><p>Quitar todos los permisos
REVOKE ALL PERMISSIONS ON KEYSPACE biblioteca FROM
usuario;</p></li><li><p>Quitar permisos sobre tabla específica
REVOKE SELECT ON biblioteca.libros FROM usuario;</p></li><li><p>Para eliminar usuarios</p></li></ul><p>DROP USER usuario;</p><p>-Gestión de Keyspaces</p><ul><li>Crear un keyspace
Keyspace simple (un solo datacenter, para desarrollo)</li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-bash data-lang=bash><span style=display:flex><span>CREATE KEYSPACE biblioteca
</span></span><span style=display:flex><span>WITH replication <span style=color:#f92672>=</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span><span style=color:#e6db74>&#39;class&#39;</span>: <span style=color:#e6db74>&#39;SimpleStrategy&#39;</span>,
</span></span><span style=display:flex><span><span style=color:#e6db74>&#39;replication_factor&#39;</span>: <span style=color:#ae81ff>1</span>
</span></span><span style=display:flex><span><span style=color:#f92672>}</span>;
</span></span></code></pre></div><ul><li><p>Explicación:</p><ul><li>SimpleStrategy: Para un solo datacenter</li><li>replication_factor: 1: Mantiene 1 copia de los datos (sin redundancia)</li></ul></li><li><p>Crear keyspace con replicación (producción)
Keyspace con 3 réplicas (recomendado para producción)</p></li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-bash data-lang=bash><span style=display:flex><span>CREATE KEYSPACE produccion
</span></span><span style=display:flex><span>WITH replication <span style=color:#f92672>=</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span><span style=color:#e6db74>&#39;class&#39;</span>: <span style=color:#e6db74>&#39;SimpleStrategy&#39;</span>,
</span></span><span style=display:flex><span><span style=color:#e6db74>&#39;replication_factor&#39;</span>: <span style=color:#ae81ff>3</span>
</span></span><span style=display:flex><span><span style=color:#f92672>}</span>;
</span></span></code></pre></div><ul><li><p>Explicación:</p><ul><li>Con 3 réplicas, los datos se copian en 3 nodos</li><li>Si un nodo falla, los otros 2 siguen sirviendo datos</li></ul></li><li><p>Crear keyspace multi-datacenter
Para clusters en múltiples datacenters</p></li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-bash data-lang=bash><span style=display:flex><span>CREATE KEYSPACE global_app
</span></span><span style=display:flex><span>WITH replication <span style=color:#f92672>=</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span><span style=color:#e6db74>&#39;class&#39;</span>: <span style=color:#e6db74>&#39;NetworkTopologyStrategy&#39;</span>,
</span></span><span style=display:flex><span><span style=color:#e6db74>&#39;datacenter1&#39;</span>: 3,
</span></span><span style=display:flex><span><span style=color:#e6db74>&#39;datacenter2&#39;</span>: <span style=color:#ae81ff>2</span>
</span></span><span style=display:flex><span><span style=color:#f92672>}</span>;
</span></span></code></pre></div><ul><li><p>Explicación:</p><ul><li>NetworkTopologyStrategy: Para múltiples datacenters</li><li>3 réplicas en datacenter1, 2 en datacenter2</li></ul></li><li><p>Ver keyspaces existentes
DESCRIBE KEYSPACES;</p></li><li><p>Ver información de un keyspace específico
DESCRIBE KEYSPACE biblioteca;</p></li><li><p>Usar un keyspace
USE biblioteca;</p></li><li><p>Cambiar factor de replicación de un KEYSPACE</p></li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-bash data-lang=bash><span style=display:flex><span>ALTER KEYSPACE biblioteca
</span></span><span style=display:flex><span>WITH replication <span style=color:#f92672>=</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span><span style=color:#e6db74>&#39;class&#39;</span>: <span style=color:#e6db74>&#39;SimpleStrategy&#39;</span>,
</span></span><span style=display:flex><span><span style=color:#e6db74>&#39;replication_factor&#39;</span>: <span style=color:#ae81ff>3</span>
</span></span><span style=display:flex><span><span style=color:#f92672>}</span>;
</span></span></code></pre></div><ul><li>Eliminar un KEYSPACE y todas sus tablas
DROP KEYSPACE biblioteca;</li></ul><p>-Gestión de tablas en Cassandra</p><ul><li><p>Seleccionamos el KEYSPACE que queremos usar</p></li><li><p>Creamos las tablas e introducimos los datos</p></li><li><p>Creación de tabla autores</p></li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-bash data-lang=bash><span style=display:flex><span>CREATE TABLE autores <span style=color:#f92672>(</span>
</span></span><span style=display:flex><span>id_autor int PRIMARY KEY,
</span></span><span style=display:flex><span>nombre text,
</span></span><span style=display:flex><span>nacionalidad text
</span></span><span style=display:flex><span><span style=color:#f92672>)</span>;
</span></span></code></pre></div><ul><li>Introducir datos</li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-bash data-lang=bash><span style=display:flex><span>INSERT INTO autores <span style=color:#f92672>(</span>id_autor, nombre, nacionalidad<span style=color:#f92672>)</span> VALUES <span style=color:#f92672>(</span>1,
</span></span><span style=display:flex><span><span style=color:#e6db74>&#39;Homero&#39;</span>, <span style=color:#e6db74>&#39;Griega&#39;</span><span style=color:#f92672>)</span>;
</span></span><span style=display:flex><span>INSERT INTO autores <span style=color:#f92672>(</span>id_autor, nombre, nacionalidad<span style=color:#f92672>)</span> VALUES <span style=color:#f92672>(</span>2,
</span></span><span style=display:flex><span><span style=color:#e6db74>&#39;Gabriel García Márquez&#39;</span>, <span style=color:#e6db74>&#39;Colombiana&#39;</span><span style=color:#f92672>)</span>;
</span></span><span style=display:flex><span>INSERT INTO autores <span style=color:#f92672>(</span>id_autor, nombre, nacionalidad<span style=color:#f92672>)</span> VALUES <span style=color:#f92672>(</span>3,
</span></span><span style=display:flex><span><span style=color:#e6db74>&#39;Miguel de Cervantes&#39;</span>, <span style=color:#e6db74>&#39;Española&#39;</span><span style=color:#f92672>)</span>;
</span></span></code></pre></div><ul><li>Creación de tabla libros</li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-bash data-lang=bash><span style=display:flex><span>CREATE TABLE libros <span style=color:#f92672>(</span>
</span></span><span style=display:flex><span>isbn text PRIMARY KEY,
</span></span><span style=display:flex><span>titulo text,
</span></span><span style=display:flex><span>id_autor int,
</span></span><span style=display:flex><span>anio int,
</span></span><span style=display:flex><span>categoria text
</span></span><span style=display:flex><span><span style=color:#f92672>)</span>;
</span></span></code></pre></div><ul><li>Introducir datos</li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-bash data-lang=bash><span style=display:flex><span>INSERT INTO libros <span style=color:#f92672>(</span>isbn, titulo, id_autor, anio, categoria<span style=color:#f92672>)</span> VALUES
</span></span><span style=display:flex><span><span style=color:#f92672>(</span><span style=color:#e6db74>&#39;9780140449136&#39;</span>, <span style=color:#e6db74>&#39;La Odisea&#39;</span>, 1, -700, <span style=color:#e6db74>&#39;Clásico&#39;</span><span style=color:#f92672>)</span>;
</span></span><span style=display:flex><span>INSERT INTO libros <span style=color:#f92672>(</span>isbn, titulo, id_autor, anio, categoria<span style=color:#f92672>)</span> VALUES
</span></span><span style=display:flex><span><span style=color:#f92672>(</span><span style=color:#e6db74>&#39;9788499890944&#39;</span>, <span style=color:#e6db74>&#39;Cien años de soledad&#39;</span>, 2, 1967, <span style=color:#e6db74>&#39;Novela&#39;</span><span style=color:#f92672>)</span>;
</span></span><span style=display:flex><span>INSERT INTO libros <span style=color:#f92672>(</span>isbn, titulo, id_autor, anio, categoria<span style=color:#f92672>)</span> VALUES
</span></span><span style=display:flex><span><span style=color:#f92672>(</span><span style=color:#e6db74>&#39;9788437604947&#39;</span>, <span style=color:#e6db74>&#39;Don Quijote de la Mancha&#39;</span>, 3, 1605, <span style=color:#e6db74>&#39;Clásico&#39;</span><span style=color:#f92672>)</span>;
</span></span></code></pre></div><ul><li>Creación de tabla prestamos</li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-bash data-lang=bash><span style=display:flex><span>CREATE TABLE prestamos <span style=color:#f92672>(</span>
</span></span><span style=display:flex><span>id_usuario int,
</span></span><span style=display:flex><span>fecha_prestamo timestamp,
</span></span><span style=display:flex><span>isbn text,
</span></span><span style=display:flex><span>fecha_devolucion timestamp,
</span></span><span style=display:flex><span>PRIMARY KEY <span style=color:#f92672>(</span>id_usuario, fecha_prestamo<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span><span style=color:#f92672>)</span> WITH CLUSTERING ORDER BY <span style=color:#f92672>(</span>fecha_prestamo DESC<span style=color:#f92672>)</span>;
</span></span></code></pre></div><ul><li>Introducir datos</li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-bash data-lang=bash><span style=display:flex><span>INSERT INTO prestamos <span style=color:#f92672>(</span>id_usuario, fecha_prestamo, isbn,
</span></span><span style=display:flex><span>fecha_devolucion<span style=color:#f92672>)</span> VALUES <span style=color:#f92672>(</span>1, toTimestamp<span style=color:#f92672>(</span>now<span style=color:#f92672>())</span>, <span style=color:#e6db74>&#39;9780140449136&#39;</span>,
</span></span><span style=display:flex><span>null<span style=color:#f92672>)</span>;
</span></span><span style=display:flex><span>INSERT INTO prestamos <span style=color:#f92672>(</span>id_usuario, fecha_prestamo, isbn,
</span></span><span style=display:flex><span>fecha_devolucion<span style=color:#f92672>)</span> VALUES <span style=color:#f92672>(</span>2, toTimestamp<span style=color:#f92672>(</span>now<span style=color:#f92672>())</span>, <span style=color:#e6db74>&#39;9788499890944&#39;</span>,
</span></span><span style=display:flex><span><span style=color:#e6db74>&#39;2025-10-10T00:00:00Z&#39;</span><span style=color:#f92672>)</span>;
</span></span><span style=display:flex><span>INSERT INTO prestamos <span style=color:#f92672>(</span>id_usuario, fecha_prestamo, isbn,
</span></span><span style=display:flex><span>fecha_devolucion<span style=color:#f92672>)</span> VALUES <span style=color:#f92672>(</span>3, toTimestamp<span style=color:#f92672>(</span>now<span style=color:#f92672>())</span>, <span style=color:#e6db74>&#39;9788437604947&#39;</span>,
</span></span><span style=display:flex><span>null<span style=color:#f92672>)</span>;
</span></span></code></pre></div><ul><li>Para eliminar todos los datos de una tabla lo hacemos con TRUNCATE
TRUNCATE autores;</li></ul><p>Ver información de las tablas</p><ul><li>En Cassandra se pueden consultar los datos de una tabla utilizando sentencias
SELECT, de manera similar a otros sistemas de gestión de bases de datos. No
obstante, a diferencia de los sistemas relacionales, Cassandra no admite
operaciones JOIN ni relaciones entre tablas, ya que su modelo de datos está</li></ul><p>desnormalizado y orientado a las consultas. Por este motivo, cada tabla se
diseña específicamente para responder a un tipo de consulta determinado, sin
depender de otras tablas.</p><h2 id=aplicación-web-que-conecte-con-el-servidor>Aplicación Web que conecte con el servidor</h2><p>MySQL y comprobación de las vulnerabilidad
a SQL Injection.
En este enlace se encuentra mi trabajo sobre el servidor web conectado a MySQL al
igual que la comprobación a la vulnerabilidad SQL Injection</p><h2 id=aplicación-web-que-conecte-con-el-servidor-1>Aplicación Web que conecte con el servidor</h2><p>MongoDB
En el siguiente enlace esta el codigo de la aplicación web de MongoDB : enlace</p><h2 id=aplicación-web-que-conecte-con-el-servidor-2>Aplicación Web que conecte con el servidor</h2><p>PostgreSQL tras autenticarse.
Este es el enlace de GitHub donde tengo subida mi aplicación web:
<a class=link href=https://github.com/ddorluc760/aplicacionWebHotel.git target=_blank rel=noopener>https://github.com/ddorluc760/aplicacionWebHotel.git</a>
Dentro del directorio “server”, tengo el fichero .sql, con las consultas de creación de
tablas e inserción de datos que he usado para mi aplicación Web.</p><p>SQL Injection sobre Aplicación Web en
PostgreSQL.
Un ataque SQL Injection ocurre cuando un atacante puede insertar o manipular
consultas SQL a través de entradas no validadas, lo que puede llevar a la exposición
de datos sensibles o incluso a la manipulación de la base de datos</p><h3 id=1cambios-realizados-sobre-mi-aplicación-web-para-hacerla>1.Cambios realizados sobre mi aplicación web para hacerla</h3><p>vulnerable.
Para la práctica he introducido cambios deliberados en “/server/server.js” para que la
comprobación de login sea vulnerable a SQL Injection en un entorno de laboratorio
controlado. Concretamente, en la ruta “/login” he sustituido la consulta parametrizada
por una construcción por concatenación:</p><p>He realizado la misma acción en las rutas “/menu/tablaHabitaciones”,
“/menu/tablaReservas”,
“/menu/tablaPagos”,
“/menu/tablaClientes”
y
“/menu/tablaUsuarios”:</p><p>Al concatenar valores procedentes del cliente (usuario, password) directamente en la
cadena SQL, los valores dejan de ser únicamente datos y pueden pasar a formar parte
de la estructura de la sentencia SQL. Esto permite que entradas especialmente
formateadas influyan sobre la sintaxis y la lógica de la consulta, es decir, que un
atacante pueda alterar la consulta original. Este comportamiento es conocido como
SQL Injection.
Esto provoca que la entrada del cliente deje de ser tratada solo como datos y pase a
formar parte de la estructura de la sentencia SQL, lo que permite manipular la
consulta si se introducen contenidos especiales en los campos.
Para que la inyección de errores y la inyección de funciones funcionen, es decir, que
mi página web también sea vulnerable a estos ataques, voy a realizar las siguientes
modificaciones en el catch, en dónde además de devolver el mensaje del error,
también devolverá el detalle del error.</p><h3 id=2tipos-de-ataques-sql-injection-sobre-mi-aplicación-web>2.Tipos de ataques SQL Injection sobre mi aplicación web.</h3><p>Inyección Básica.
Intenta manipular la consulta SQL básica para obtener acceso no autorizado. En caso
de que la aplicación sea vulnerable, deberías poder iniciar sesión sin conocer la
contraseña real.
Vamos a ponerlo en práctica. Para ello, en el formulario de inicio de sesión,
ingresamos en usuario lo siguiente, y en el caso de la contraseña introducimos
también lo siguiente.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-bash data-lang=bash><span style=display:flex><span>usuario: admin
</span></span><span style=display:flex><span>password: <span style=color:#e6db74>&#39; OR &#39;</span>1<span style=color:#e6db74>&#39;=&#39;</span><span style=color:#ae81ff>1</span>
</span></span></code></pre></div><p>Inyección de comentarios.
Utiliza comentarios SQL para ignorar el resto de la consulta, y permitiendo de este
modo el acceso. Para ello, necesitaremos un usuario existente solamente, ya que con
los parámetros <code>--</code>, vamos a ignorar la comprobación de la contraseña en la consulta <code>SELECT</code> de nuestro login.
Vamos a ponerlo en práctica. Para ello, en el formulario de inicio de sesión,
ingresamos en usuario lo siguiente, y en el caso de la contraseña introducimos
también lo siguiente.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-bash data-lang=bash><span style=display:flex><span>usuario: usuarioVálido<span style=color:#960050;background-color:#1e0010>&#39;</span> --
</span></span><span style=display:flex><span>password: <span style=color:#e6db74>&#34;cualquierContraseña&#34;</span>
</span></span></code></pre></div><p>Inyección de Unión (UNION Injection).
Combina resultados de otra consulta para obtener datos adicionales, como por
ejemplo, todos los usuarios y contraseñas.
Vamos a ponerlo en práctica. Para ello, en el formulario de inicio de sesión,
ingresamos en usuario lo siguiente, y en el caso de la contraseña introducimos
también lo siguiente.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-bash data-lang=bash><span style=display:flex><span>usuario: admin<span style=color:#960050;background-color:#1e0010>&#39;</span> UNION SELECT null, usuario,password,null FROM usuarios --
</span></span><span style=display:flex><span>password: <span style=color:#f92672>[</span>cualquiercontraseña<span style=color:#f92672>]</span>
</span></span></code></pre></div><p>Antes de pasar con la ejecución de la inyección SQL, vamos a abrir la herramienta
para desarrolladores, y en mi caso, voy a aplicar un punto de depuración antes de
cambiar de página, para ver si en la respuesta del login, nos muestra todos los usuarios
y sus contraseñas de la tabla usuarios.</p><p>Probamos a loguearnos, ejecutando la inyección SQL.</p><p>Nos vamos a “Red” o “Network” y pulsamos sobre la última respuesta del login. Tras
haber hecho esto, si todo se ha ejecutado correctamente, nos mostrará los datos que
hemos solicitado en el UNION.</p><p>Inyección de Tiempo (Time-Based Blind SQL Injection).
Usa una función como “pg_sleep” para confirmar la vulnerabilidad mediante retrasos
en la respuesta. En este caso, la respuesta tardará 5 segundos en llegar.
Vamos a ponerlo en práctica. Para ello, en el formulario de inicio de sesión,
ingresamos en usuario lo siguiente, y en el caso de la contraseña introducimos
también lo siguiente.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-bash data-lang=bash><span style=display:flex><span>usuario: admin<span style=color:#960050;background-color:#1e0010>&#39;</span> <span style=color:#f92672>||</span> pg_sleep<span style=color:#f92672>(</span>5<span style=color:#f92672>)</span> --
</span></span><span style=display:flex><span>password: <span style=color:#f92672>[</span>cualquierContraseña<span style=color:#f92672>]</span>
</span></span></code></pre></div><p>Para verificar que esto funciona correctamente, voy a facilitar capturas en la cuál se
muestra un ejemplo en el que se intenta hacer un inicio de sesión con un usuario o
contraseña que no existen, y comprobaremos el tiempo que tarda en enviar la
respuesta el login.</p><p>Inyección de Cadenas.
Con este ataque SQL, se intenta manipular cadenas para forzar una condición
verdadera.</p><p>Vamos a ponerlo en práctica. Para ello, en el formulario de inicio de sesión,
ingresamos en usuario lo siguiente, y en el caso de la contraseña introducimos
también lo siguiente.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-bash data-lang=bash><span style=display:flex><span>usuario: admin<span style=color:#e6db74>&#39; OR &#39;</span>a<span style=color:#e6db74>&#39;=&#39;</span>a<span style=color:#960050;background-color:#1e0010>&#39;</span> --
</span></span><span style=display:flex><span>contraseña: <span style=color:#f92672>[</span>cualquierContraseña<span style=color:#f92672>]</span>
</span></span></code></pre></div><p>Inyección de Subconsultas.
Usa subconsultas para obtener datos adicionales.
Vamos a ponerlo en práctica. Para ello, en el formulario de inicio de sesión,
ingresamos en usuario lo siguiente, y en el caso de la contraseña introducimos
también lo siguiente. En este caso, en el caso de que cumpla con la subconsulta las
tablas, nos va a permitir loguearnos. Es decir, que en este ejemplo, en el caso de que la
tabla no tenga algún dato nos va a permitir loguearnos. En el caso de que no lo
tuviera, no nos va a permitir loguearnos.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-bash data-lang=bash><span style=display:flex><span>usuario: admin<span style=color:#960050;background-color:#1e0010>&#39;</span> OR <span style=color:#f92672>(</span>SELECT COUNT<span style=color:#f92672>(</span>*<span style=color:#f92672>)</span> FROM usuarios<span style=color:#f92672>)</span> &gt; <span style=color:#ae81ff>0</span> --
</span></span><span style=display:flex><span>password: <span style=color:#f92672>[</span>cualquierContraseña<span style=color:#f92672>]</span>
</span></span></code></pre></div><p>En el siguiente caso, no deberíamos de poder entrar, ya que la tabla Clientes tiene
datos.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-bash data-lang=bash><span style=display:flex><span>usuario: admin<span style=color:#960050;background-color:#1e0010>&#39;</span> OR <span style=color:#f92672>(</span>SELECT COUNT<span style=color:#f92672>(</span>*<span style=color:#f92672>)</span> FROM usuarios<span style=color:#f92672>)</span> &lt; <span style=color:#ae81ff>0</span> --
</span></span><span style=display:flex><span>password: <span style=color:#f92672>[</span>cualquierContraseña<span style=color:#f92672>]</span>
</span></span></code></pre></div><p>Inyección de Errores.
Provoca un error para obtener información sobre la base de datos. Si la aplicación es
vulnerable, deberíamos obtener un error que revele información sobre la base de
datos.</p><p>Vamos a ponerlo en práctica. Para ello, en el formulario de inicio de sesión,
ingresamos en usuario lo siguiente, y en el caso de la contraseña introducimos
también lo siguiente.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-bash data-lang=bash><span style=display:flex><span>usuario: admin<span style=color:#e6db74>&#39; AND 1=(CAST((SELECT string_agg(nombre || &#39;</span>:<span style=color:#e6db74>&#39; || primerApellido || &#39;</span>:<span style=color:#e6db74>&#39; || segundoApellido || &#39;</span>:<span style=color:#e6db74>&#39; || telefono || &#39;</span>:<span style=color:#e6db74>&#39; || email, &#39;</span>, <span style=color:#960050;background-color:#1e0010>&#39;</span><span style=color:#f92672>)</span> FROM clientes<span style=color:#f92672>)</span> AS INT<span style=color:#f92672>))</span> --
</span></span><span style=display:flex><span>password: <span style=color:#f92672>[</span>cualquierContraseña<span style=color:#f92672>]</span>
</span></span></code></pre></div><p>En la herramienta de desarrollador del navegador web, nos vamos a la opción Red, y
vemos como en la respuesta 500, que nos da el error “Error en la conexión a la base de
datos”, también nos proporciona detalles sobre la versión del servidor PostgreSQL.</p><p>Inyección de Datos.
Con esta inyección SQL, tratamos de intentar insertar datos en la base de datos.
Vamos a ponerlo en práctica. Para ello, en el formulario de inicio de sesión,
ingresamos en usuario lo siguiente, y en el caso de la contraseña introducimos
también lo siguiente.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-bash data-lang=bash><span style=display:flex><span>usuario: admin<span style=color:#e6db74>&#39; ; INSERT INTO usuarios (usuario, password) VALUES (&#39;</span>hacker<span style=color:#e6db74>&#39;, &#39;</span>123<span style=color:#960050;background-color:#1e0010>&#39;</span><span style=color:#f92672>)</span>; --
</span></span><span style=display:flex><span>password: <span style=color:#f92672>[</span>cualquierContraseña<span style=color:#f92672>]</span>
</span></span></code></pre></div><p>Comprobamos que podemos acceder con el usuario y contraseña que hemos insertado.</p><p>Inyección de Funciones.
Usa funciones de PostgreSQL para obtener información.
Vamos a ponerlo en práctica. Para ello, en el formulario de inicio de sesión,
ingresamos en usuario lo siguiente, y en el caso de la contraseña introducimos
también lo siguiente.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-bash data-lang=bash><span style=display:flex><span>usuario: admin<span style=color:#960050;background-color:#1e0010>&#39;</span> AND 1<span style=color:#f92672>=(</span>SELECT CAST<span style=color:#f92672>(</span>version<span style=color:#f92672>()</span> AS INT<span style=color:#f92672>))</span> --
</span></span><span style=display:flex><span>contraseña: <span style=color:#f92672>[</span>cualquierContraseña<span style=color:#f92672>]</span>
</span></span></code></pre></div><p>En la herramienta de desarrollador del navegador web, nos vamos a la opción Red, y
vemos como en la respuesta 500, que nos da el error “Error en la conexión a la base de
datos”, también nos proporciona detalles sobre la versión del servidor PostgreSQL.</p><p>Inyección de Datos Sensibles</p><p>Intenta extraer datos sensibles con UNION.
Vamos a ponerlo en práctica. Para ello, en el formulario de inicio de sesión,
ingresamos en usuario lo siguiente, y en el caso de la contraseña introducimos
también lo siguiente.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-bash data-lang=bash><span style=display:flex><span>usuario: admin<span style=color:#e6db74>&#39; UNION SELECT 1, json_build_object( &#39;</span>id<span style=color:#e6db74>&#39;, id, &#39;</span>email<span style=color:#e6db74>&#39;, email, &#39;</span>nombre_completo<span style=color:#e6db74>&#39;, nombre || &#39;</span> <span style=color:#e6db74>&#39; || primerApellido || &#39;</span> <span style=color:#e6db74>&#39; || COALESCE(segundoApellido, &#39;&#39;), &#39;</span>telefono<span style=color:#e6db74>&#39;, telefono)::text, &#39;</span>CLIENTE<span style=color:#960050;background-color:#1e0010>&#39;</span>, id FROM clientes --
</span></span><span style=display:flex><span>contraseña: <span style=color:#f92672>[</span>cualquierContraseña<span style=color:#f92672>]</span>
</span></span></code></pre></div><p>Antes de pasar con la ejecución de la inyección SQL, vamos a abrir la herramienta
para desarrolladores, y en mi caso, voy a aplicar un punto de depuración antes de
cambiar de página, para ver si en la respuesta del login, nos muestra todos los usuarios
y sus contraseñas de la tabla usuarios.</p><p>Probamos a loguearnos, ejecutando la inyección SQL.</p><p>Nos vamos a “Red” o “Network” y pulsamos sobre la última respuesta del login. Tras
haber hecho esto, si todo se ha ejecutado correctamente, nos mostrará los datos que
hemos solicitado en el UNION.</p><h3 id=3cambios-realizados-para-que-mi-aplicación-no-sea-vulnerable>3.Cambios realizados para que mi aplicación no sea vulnerable.</h3><p>Para eliminar la vulnerabilidad de tipo SQL Injection introducida en las consultas, he
realizado los siguientes cambios principales:</p><h3 id=1-reemplazar-todas-las-consultas-que-concatenan-directamente-valores-de-entrada>1. Reemplazar todas las consultas que concatenan directamente valores de entrada</h3><p>por consultas parametrizadas usando placeholders ($1, $2, …) y pasando un
array de parámetros al driver “pg”.</p><h3 id=2-usar-un-usuario-de-aplicación-app-user-con-permisos-mínimos-en-la-base-de>2. Usar un usuario de aplicación (app user) con permisos mínimos en la base de</h3><p>datos en lugar de una cuenta con privilegios amplios, usando para el login en
postgreSQL directamente el usuario y contraseña que pasamos parámetros en el
login.</p><h3 id=3-quitar-consolelog-que-imprime-consultas-con-valores-sensibles-en-entornos>3. Quitar “console.log” que imprime consultas con valores sensibles en entornos</h3><p>de producción.
Quedando el “/server/server.js” con el siguiente contenido:</p><h3 id=4comprobación-de-que-mi-aplicación-no-sea-vulnerable>4.Comprobación de que mi aplicación no sea vulnerable.</h3><p>Tras haber modificado las partes del código vulnerable de mi aplicación, para que mi
página web no sea vulnerable, no nos deberá funcionar las siguientes inyecciones
SQL.
Inyección Básica.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-bash data-lang=bash><span style=display:flex><span>usuario: admin
</span></span><span style=display:flex><span>password: <span style=color:#e6db74>&#39; OR &#39;</span>1<span style=color:#e6db74>&#39;=&#39;</span><span style=color:#ae81ff>1</span>
</span></span></code></pre></div><p>Inyección de comentarios.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-bash data-lang=bash><span style=display:flex><span>usuario: usuarioVálido<span style=color:#960050;background-color:#1e0010>&#39;</span> --
</span></span><span style=display:flex><span>password: <span style=color:#e6db74>&#34;cualquierContraseña&#34;</span>
</span></span></code></pre></div><p>Inyección de Unión (UNION Injection).</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-bash data-lang=bash><span style=display:flex><span>usuario: admin<span style=color:#960050;background-color:#1e0010>&#39;</span> UNION SELECT null, usuario,password,null FROM usuarios --
</span></span><span style=display:flex><span>password: <span style=color:#f92672>[</span>cualquiercontraseña<span style=color:#f92672>]</span>
</span></span></code></pre></div><p>Antes de pasar con la ejecución de la inyección SQL, vamos a abrir la herramienta
para desarrolladores, y en mi caso, voy a aplicar un punto de depuración antes de
cambiar de página, para ver si en la respuesta del login, nos muestra todos los usuarios
y sus contraseñas de la tabla usuarios.</p><p>Probamos a loguearnos, ejecutando la inyección SQL.</p><p>Nos vamos a “Red” o “Network” y pulsamos sobre la última respuesta del login. Tras
haber hecho esto, si todo se ha ejecutado correctamente, nos mostrará los datos que
hemos solicitado en el UNION.</p><p>Inyección de Tiempo (Time-Based Blind SQL Injection).</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-bash data-lang=bash><span style=display:flex><span>usuario: admin<span style=color:#960050;background-color:#1e0010>&#39;</span> <span style=color:#f92672>||</span> pg_sleep<span style=color:#f92672>(</span>5<span style=color:#f92672>)</span> --
</span></span><span style=display:flex><span>password: <span style=color:#f92672>[</span>cualquierContraseña<span style=color:#f92672>]</span>
</span></span></code></pre></div><p>Como vemos en la siguiente captura, no se ha retardado la respuesta de nuestra página
web.</p><p>Inyección de Cadenas.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-bash data-lang=bash><span style=display:flex><span>usuario: admin<span style=color:#e6db74>&#39; OR &#39;</span>a<span style=color:#e6db74>&#39;=&#39;</span>a<span style=color:#960050;background-color:#1e0010>&#39;</span> --
</span></span><span style=display:flex><span>contraseña: <span style=color:#f92672>[</span>cualquierContraseña<span style=color:#f92672>]</span>
</span></span></code></pre></div><p>Inyección de Subconsultas.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-bash data-lang=bash><span style=display:flex><span>usuario: admin<span style=color:#960050;background-color:#1e0010>&#39;</span> OR <span style=color:#f92672>(</span>SELECT COUNT<span style=color:#f92672>(</span>*<span style=color:#f92672>)</span> FROM usuarios<span style=color:#f92672>)</span> &gt; <span style=color:#ae81ff>0</span> --
</span></span><span style=display:flex><span>password: <span style=color:#f92672>[</span>cualquierContraseña<span style=color:#f92672>]</span>
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-bash data-lang=bash><span style=display:flex><span>usuario: admin<span style=color:#960050;background-color:#1e0010>&#39;</span> OR <span style=color:#f92672>(</span>SELECT COUNT<span style=color:#f92672>(</span>*<span style=color:#f92672>)</span> FROM usuarios<span style=color:#f92672>)</span> &lt; <span style=color:#ae81ff>0</span> --
</span></span><span style=display:flex><span>password: <span style=color:#f92672>[</span>cualquierContraseña<span style=color:#f92672>]</span>
</span></span></code></pre></div><p>Inyección de Errores.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-bash data-lang=bash><span style=display:flex><span>usuario: admin<span style=color:#e6db74>&#39; AND 1=(CAST((SELECT string_agg(nombre || &#39;</span>:<span style=color:#e6db74>&#39; || primerApellido || &#39;</span>:<span style=color:#e6db74>&#39; || segundoApellido || &#39;</span>:<span style=color:#e6db74>&#39; || telefono || &#39;</span>:<span style=color:#e6db74>&#39; || email, &#39;</span>, <span style=color:#960050;background-color:#1e0010>&#39;</span><span style=color:#f92672>)</span> FROM clientes<span style=color:#f92672>)</span> AS INT<span style=color:#f92672>))</span> --
</span></span><span style=display:flex><span>password: <span style=color:#f92672>[</span>cualquierContraseña<span style=color:#f92672>]</span>
</span></span></code></pre></div><p>Inyección de Datos.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-bash data-lang=bash><span style=display:flex><span>usuario: admin<span style=color:#e6db74>&#39; ; INSERT INTO usuarios (usuario, password) VALUES (&#39;</span>aaa<span style=color:#e6db74>&#39;, &#39;</span>bbb<span style=color:#960050;background-color:#1e0010>&#39;</span><span style=color:#f92672>)</span>; --
</span></span><span style=display:flex><span>password: <span style=color:#f92672>[</span>cualquierContraseña<span style=color:#f92672>]</span>
</span></span></code></pre></div><p>Comprobamos que no se haya insertado el usuario, no pudiendo loguearnos con el
usuario que hemos intentado insertar con la vulnerabilidad.</p><p>Inyección de Funciones.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-bash data-lang=bash><span style=display:flex><span>usuario: admin<span style=color:#960050;background-color:#1e0010>&#39;</span> AND 1<span style=color:#f92672>=(</span>SELECT CAST<span style=color:#f92672>(</span>version<span style=color:#f92672>()</span> AS INT<span style=color:#f92672>))</span> --
</span></span><span style=display:flex><span>contraseña: <span style=color:#f92672>[</span>cualquierContraseña<span style=color:#f92672>]</span>
</span></span></code></pre></div><p>Inyección de Datos Sensibles</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-bash data-lang=bash><span style=display:flex><span>usuario: admin<span style=color:#e6db74>&#39; UNION SELECT 1, json_build_object( &#39;</span>id<span style=color:#e6db74>&#39;, id, &#39;</span>email<span style=color:#e6db74>&#39;, email, &#39;</span>nombre_completo<span style=color:#e6db74>&#39;, nombre || &#39;</span> <span style=color:#e6db74>&#39; || primerApellido || &#39;</span> <span style=color:#e6db74>&#39; || COALESCE(segundoApellido, &#39;&#39;), &#39;</span>telefono<span style=color:#e6db74>&#39;, telefono)::text, &#39;</span>CLIENTE<span style=color:#960050;background-color:#1e0010>&#39;</span>, id FROM clientes --
</span></span><span style=display:flex><span>contraseña: <span style=color:#f92672>[</span>cualquierContraseña<span style=color:#f92672>]</span>
</span></span></code></pre></div><p>Antes de pasar con la ejecución de la inyección SQL, vamos a abrir la herramienta
para desarrolladores, y en mi caso, voy a aplicar un punto de depuración antes de
cambiar de página, para ver si en la respuesta del login, nos muestra todos los usuarios
y sus contraseñas de la tabla usuarios.</p><p>Probamos a loguearnos, ejecutando la inyección SQL.</p><p>Nos vamos a “Red” o “Network” y pulsamos sobre la última respuesta del login. Tras
haber hecho esto, si todo se ha ejecutado correctamente, nos mostrará los datos que
hemos solicitado en el UNION. En este caso, no nos va a mostrar datos ya que mi
página no es vulnerable a este tipo de ataques.</p><h2 id=instalación-servidor-memcached-en-debian-13>Instalación Servidor Memcached en Debian 13</h2><h3 id=1instalación-de-paquetes>1.Instalación de Paquetes</h3><ul><li>En primer lugar, actualizamos los repositorios</li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-bash data-lang=bash><span style=display:flex><span>serjaii@db:~$ sudo apt update
</span></span></code></pre></div><ul><li>Instalamos el servidor memcached con la biblioteca cliente y herramientas</li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-bash data-lang=bash><span style=display:flex><span>serjaii@db:~$ sudo apt install memcached libmemcachedtools
</span></span></code></pre></div><ul><li><p>Comprobamos el estado del servicio</p></li><li><p>Esto ocurre porque en versiones recientes de Memcached, no admite dos
directivas -l en el mismo archivo; eso causa exactamente el error
status=71.Editamos el fichero /etc/memcached.conf y comentamos la segunda
línea que hace referencia a -l</p></li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-bash data-lang=bash><span style=display:flex><span>serjaii@db:~$ sudo nano /etc/memcached.conf
</span></span></code></pre></div><ul><li>Reiniciamos y omprobamos de nuevo el estado del servicio</li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-bash data-lang=bash><span style=display:flex><span>serjaii@db:~$ sudo systemctl restart memcached <span style=color:#f92672>&amp;&amp;</span> sudo systemctl status memcached
</span></span></code></pre></div><h3 id=2memcached-en-un-servidor-web>2.Memcached en un Servidor Web</h3><p>Primero que nada debemos saber que es Memcached,ya que está no es en sí una base
de datos, podemos entenderla como un servicio que funciona de caché de la base de</p><p>datos cuando esta se conecta con una aplicación web. Para probar su funcionalidad
voy a implementarla en un Servidor Web que accede a una base de datos MySQL.</p><ul><li>Como estamos trabajando en un escenario demasiado pequeño como para notar
una diferencia cuando la información llega desde memcached o desde el propio
servidor de base de datos he añadido un aviso en el servidor web para poder
reconocerlo.</li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-html data-lang=html><span style=display:flex><span>{% if cached %}
</span></span><span style=display:flex><span>&lt;<span style=color:#f92672>div</span> <span style=color:#a6e22e>style</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;background:#ffc107;color:#212529;padding:6px 10px;border-radius:6px;font-weight:600;&#34;</span>&gt;
</span></span><span style=display:flex><span>    Servido desde cache
</span></span><span style=display:flex><span>&lt;/<span style=color:#f92672>div</span>&gt;
</span></span><span style=display:flex><span>{% endif %}
</span></span></code></pre></div><h3 id=3implementación-en-flask>3.Implementación en Flask</h3><p>Partiendo del siguiente proyecto repasaré los pasos que he seguido para
implementar memcached en un servidor web,aunque bien hay que decir que este
proceso puede ser diferente dependiendo si se ha realizado con Flask o cualquier
otra aplicacion</p><p>En primer lugar empezaremos añadiendo al entorno virtual pymemcache==4.0.8
esto lo haremos en requirements.txt</p><p>El resto de cambios los haremos sobre el fichero app.py</p><ul><li><p>Importar librería</p></li><li><p>Iniciar el cliente memcached</p></li></ul><p>Instalación, uso básico y explicación del
funcionamiento de CouchDB en Debian 13
Apache CouchDB es una base de datos NoSQL orientada a documentos que almacena
documentos JSON, expone una API HTTP/REST y una vistas MapReduce y un
sistema de replicación eficiente. Está escrita en Erlang y usa un almacenamiento
append-only sobre B-trees, lo que facilita la tolerancia a fallos y lecturas concurrentes.
Fauxton es su interfaz web integrada para administración y pruebas.</p><h3 id=1instalación-de-dependencias-y-servidor-de-couchdb>1.Instalación de dependencias y servidor de CouchDB.</h3><p>El repositorio oficial de CouchDB aún no tiene paquetes específicos para Debian 13,
ya que es una versión muy reciente. Por tanto, usaremos los paquetes de Debian 12</p><p>para la instalación de CouchDB de forma temporal, hasta que CouchDB publique
paquetes específicos para su instalación en Debian 13.</p><ul><li>Actualizamos los paquetes del sistema, asegurando que los paquetes y
metadatos APT estén actualizados y así evitar conflictos.</li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-bash data-lang=bash><span style=display:flex><span>serjaii@db:~$ sudo apt update <span style=color:#f92672>&amp;&amp;</span> sudo apt upgrade -y
</span></span></code></pre></div><ul><li>Instalamos las dependencias necesarias para la instalación de CouchDB, para
poder añadir repositorios HTTPS y gestionar claves GPG.</li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-bash data-lang=bash><span style=display:flex><span>serjaii@db:~$ sudo apt install -y curl gnupg ca-certificates lsb-release apt-transport-https 
</span></span></code></pre></div><ul><li><strong>curl</strong>: para descargar la clave GPG.</li><li><strong>gnupg</strong>: para convertir la clave GPG a formato apt (dearmor).</li><li><strong>lsb-release</strong>: para obtener “VERSION_CODENAME”.</li></ul><pre tabindex=0><code>- Añadimos el repositorio oficial de CouchDB, donde se encuentran los paquetes
oficiales de CouchDB. Además, añadimos también su clave GPG para que apt
confíe en el repo. Para ello, en este paso, descargamos la clave y la guardamos
en formato apt (.gpg).
```bash
serjaii@db:~$ curl -fsSL https://couchdb.apache.org/repo/keys.asc | gpg --dearmor | sudo tee /usr/share/keyrings/couchdb-archive-keyring.gpg &gt;/dev/null
</code></pre><ul><li>Añadimos la entrada al sources list.</li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-bash data-lang=bash><span style=display:flex><span>serjaii@db:~$ echo <span style=color:#e6db74>&#34;deb [signed-by=/usr/share/keyrings/couchdb-archive-keyring.gpg] https://apache.jfrog.io/artifactory/couchdb-deb/ bookworm main&#34;</span> | sudo tee /etc/apt/sources.list.d/couchdb.list
</span></span></code></pre></div><ul><li>Actualizamos los índices APT, para que el sistema reconozca la clave GPG.</li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-bash data-lang=bash><span style=display:flex><span>serjaii@db:~$ sudo apt update
</span></span></code></pre></div><ul><li>Lanzamos la instalación de CouchDB.</li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-bash data-lang=bash><span style=display:flex><span>serjaii@db:~$ sudo apt install couchdb
</span></span></code></pre></div><ul><li>Como vemos, nos ha salido dos errores típicos, debido a que está intentando
instalar CouchDB en Debian 12, usando dependencias que en Debian 13
pueden estar obsoletas. Para que podamos instalar CouchDB, tendremos que
descargarnos e instalar las dependencias “libicu72” y “libmozjs-78-0”
previamente, que son las dependencias que nos están fallando durante la
instalación de CouchDB.</li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-bash data-lang=bash><span style=display:flex><span>serjaii@db:~$ wget http://ftp.debian.org/debian/pool/main/i/icu/libicu72_72.1-3+deb12u1_amd64.deb
</span></span><span style=display:flex><span>serjaii@db:~$ wget http://ftp.debian.org/debian/pool/main/m/mozjs78/libmozjs-78-0_78.15.0-7_amd64.deb
</span></span><span style=display:flex><span>serjaii@db:~$ sudo apt install ./libicu72_72.1-3+deb12u1_amd64.deb ./libmozjs-78-0_78.15.0-7_amd64.deb
</span></span></code></pre></div><p>El ./ delante del nombre del archivo le dice a apt que instale desde un
archivo local, no desde los repositorios.
Esto también resolverá las dependencias automáticamente si falta algo
más.</p><ul><li>Volvemos a actualizar el sistema para actualizar la paquetería y ejecutamos el
comando para instalar “CouchDB”.</li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-bash data-lang=bash><span style=display:flex><span>serjaii@db:~$ sudo apt update
</span></span><span style=display:flex><span>serjaii@db:~$ sudo apt install couchdb
</span></span></code></pre></div><ul><li><p>Seleccionamos “Aceptar”.</p></li><li><p>Seleccionamos la opción “Standalone”, ya que CouchDB funcionará en esta
máquina solamente. Además, es la opción habitual para pruebas y entornos
locales.</p></li><li><p>Ponemos un valor de CouchDB Erlang magic cookie.</p></li><li><p>En la siguiente página, como quiero que mi servidor escuche conexiones
remotas, voy a configurar para que la interfaz de CouchDB sea la interfaz
“0.0.0.0”.</p></li><li><p>Añadimos una contraseña para el usuario admin, en mi caso “admin”.</p></li><li><p>Volvemos a repetir la contraseña.</p></li><li><p>Comprobamos que podemos acceder a CouchDB.</p></li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-bash data-lang=bash><span style=display:flex><span>serjaii@db:~$ curl http://localhost:5984/
</span></span></code></pre></div><h3 id=2-configuración-para-conexión-remota>2. Configuración para conexión remota.</h3><ul><li>Editamos la sección “[httpd]” en el fichero “/etc/couchdb/local.ini”, indicando
con el valor “0.0.0.0”, que CouchDB escuchará en todas las interfaces de red,
no solo en localhost. Además, también le vamos a añadir una contraseña para
cuando nos conectemos al usuario admin desde el remoto.</li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-bash data-lang=bash><span style=display:flex><span>serjaii@db:~$ sudo nano /opt/couchdb/etc/local.ini
</span></span><span style=display:flex><span>serjaii@db:~$ grep -Ev <span style=color:#e6db74>&#34;^;|^</span>$<span style=color:#e6db74>&#34;</span> /opt/couchdb/etc/local.ini
</span></span></code></pre></div><ul><li>Verificamos que CouchDB escucha en todas las interfaces.</li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-bash data-lang=bash><span style=display:flex><span>serjaii@db:~$ ss -tuln | grep <span style=color:#ae81ff>5984</span>
</span></span></code></pre></div><h3 id=3-instalación-del-cliente-de-couchdb>3. Instalación del Cliente de CouchDB.</h3><p>A diferencia de otros sistemas de bases de datos, CouchDB no requiere la instalación
de un cliente independiente. Esto se debe a que CouchDB está diseñado como un
servidor HTTP/REST, lo que significa que todas las operaciones de gestión y
manipulación de datos se realizan mediante peticiones HTTP en formato JSON.
Tenemos las siguientes opciones de clientes disponibles:</p><ul><li>CouchDB incluye un cliente web llamado Fauxton que se ejecuta directamente
en el navegador.
Se requiere el usuario administrador configurado durante la instalación
de CouchDB. Además, no requiere instalación adicional, es multiplataforma y
se accede desde cualquier navegador moderno.
Permite realizar las siguientes acciones:</li><li></li></ul><p>Crear y eliminar bases de datos.</p><ul><li></li></ul><p>Insertar, actualizar y eliminar documentos.
Gestionar usuarios y permisos.
Consultar vistas y realizar replicaciones.
Ejemplo de acceso a Fauxton desde otra máquina:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-bash data-lang=bash><span style=display:flex><span>http://IP_DEL_SERVIDOR:5984/_utils/
</span></span></code></pre></div><ul><li>CouchDB se puede controlar completamente usando curl, una herramienta
estándar para enviar peticiones HTTP.
Funciona en cualquier sistema operativo, no necesita instalación extra y
permite la automatización mediante scripts.
Ejemplo de acceso remoto haciendo uso de curl:</li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-bash data-lang=bash><span style=display:flex><span>serjaii@db:~$ curl -u admin:miContraseña http://IP_DEL_SERVIDOR:5984/_all_dbs
</span></span></code></pre></div><h3 id=4-uso-básico-de-couchdb>4. Uso básico de CouchDB.</h3><ul><li>Después de instalar CouchDB y configurar la conexión remota, lo primero es
verificar que el servidor esté activo.</li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-bash data-lang=bash><span style=display:flex><span>serjaii@db:~$ curl -u admin:miContraseña http://IP_DEL_SERVIDOR:5984/
</span></span></code></pre></div><ul><li>También podemos crear y listar bases de datos. Para ello, primero vamos a
crear una base de datos de prueba y a continuación vamos a listar todas las
bases de datos para comprobar que se ha creado correctamente.</li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-bash data-lang=bash><span style=display:flex><span>serjaii@db:~$ curl -X PUT -u admin:miContraseña http://IP_DEL_SERVIDOR:5984/prueba1
</span></span><span style=display:flex><span>serjaii@db:~$ curl -u admin:miContraseña http://IP_DEL_SERVIDOR:5984/_all_dbs
</span></span></code></pre></div><ul><li>Creación de un documento con ID automático.</li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-bash data-lang=bash><span style=display:flex><span>serjaii@db:~$ curl -X POST -H <span style=color:#e6db74>&#34;Content-Type: application/json&#34;</span> -d <span style=color:#e6db74>&#39;{&#34;tipo&#34;:&#34;persona&#34;,&#34;nombre&#34;:&#34;Ana&#34;,&#34;edad&#34;:29}&#39;</span> -u admin:miContraseña http://IP_DEL_SERVIDOR:5984/prueba1
</span></span></code></pre></div><ul><li>Creación de un documento con ID conocido.</li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-bash data-lang=bash><span style=display:flex><span>serjaii@db:~$ curl -X PUT -H <span style=color:#e6db74>&#34;Content-Type: application/json&#34;</span> -d <span style=color:#e6db74>&#39;{&#34;tipo&#34;:&#34;persona&#34;,&#34;nombre&#34;:&#34;Juan&#34;,&#34;edad&#34;:35}&#39;</span> -u admin:miContraseña http://IP_DEL_SERVIDOR:5984/prueba1/juan
</span></span></code></pre></div><ul><li>Lectura de los documentos creados previamente.</li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-bash data-lang=bash><span style=display:flex><span>serjaii@db:~$ curl -u admin:miContraseña http://IP_DEL_SERVIDOR:5984/prueba1/_all_docs
</span></span><span style=display:flex><span>serjaii@db:~$ curl -u admin:miContraseña http://IP_DEL_SERVIDOR:5984/prueba1/juan
</span></span><span style=display:flex><span>serjaii@db:~$ curl -u admin:miContraseña http://IP_DEL_SERVIDOR:5984/prueba1/4d8a13414adb24b358662682d0000e13
</span></span></code></pre></div><ul><li>Borrado de un documento.</li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-bash data-lang=bash><span style=display:flex><span>serjaii@db:~$ curl -X DELETE <span style=color:#e6db74>&#34;http://IP_DEL_SERVIDOR:5984/prueba1/juan?rev=175f7db8e2f472106529dba1e056feb54&#34;</span> -u admin:miContraseña
</span></span></code></pre></div><ul><li>Creación de un índice sobre los campos “tipo” y “edad”, usando consultas
Mango, para acelerar consultas que filtren por “tipo” y “edad”. Las consultas
Mango son consultas JSON similares a MongoDB.</li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-bash data-lang=bash><span style=display:flex><span>serjaii@db:~$ curl -X POST -H <span style=color:#e6db74>&#34;Content-Type: application/json&#34;</span> -d <span style=color:#e6db74>&#39;{&#34;index&#34;:{&#34;fields&#34;: [&#34;tipo&#34;,&#34;edad&#34;]},&#34;name&#34;:&#34;idx_tipo_edad&#34;,&#34;type&#34;:&#34;json&#34;}&#39;</span> -u admin:miContraseña http://IP_DEL_SERVIDOR/prueba1/_index
</span></span></code></pre></div><ul><li>Ejecución de una consulta Mango. En la siguiente consulta, va a devolver un
JSON con todos los documentos que cumplen los criterios de que sean de tipo
“persona” y con “edad” mayor a 25 años, usando los índices si existen para
acelerar la búsqueda.</li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-bash data-lang=bash><span style=display:flex><span>serjaii@db:~$ curl -X POST -H <span style=color:#e6db74>&#34;Content-Type: application/json&#34;</span> -d <span style=color:#e6db74>&#39;{&#34;selector&#34;:{&#34;tipo&#34;:&#34;persona&#34;,&#34;edad&#34;: {&#34;$gt&#34;:25}},&#34;fields&#34;:[&#34;_id&#34;,&#34;nombre&#34;,&#34;edad&#34;]}&#39;</span> -u admin:miContraseña http://IP_DEL_SERVIDOR:5984/prueba1/_find
</span></span></code></pre></div><ul><li>Creación de vistas con MapReduce.</li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-bash data-lang=bash><span style=display:flex><span>serjaii@db:~$ curl -X PUT -H <span style=color:#e6db74>&#34;Content-Type: application/json&#34;</span> -d <span style=color:#e6db74>&#39;{&#34;views&#34;:{&#34;by_tipo&#34;: {&#34;map&#34;:&#34;function(doc) {if(doc.tipo)emit(doc.tipo,null);}&#34;}},&#34;language&#34;:&#34;javascript&#34;} &#39;</span> -u admin:admin http://192.168.122.79:5984/prueba1/_design/people
</span></span></code></pre></div><ul><li>Listamos la vista o la podemos ejecutar también.</li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-bash data-lang=bash><span style=display:flex><span>serjaii@db:~$ curl -u admin:miContraseña http://IP_DEL_SERVIDOR:5984/prueba1/_design/people
</span></span><span style=display:flex><span>serjaii@db:~$ curl -u admin:miContraseña <span style=color:#e6db74>&#34;http://IP_DEL_SERVIDOR:5984/prueba1/_design/people/_vie w/by_tipo&#34;</span>
</span></span></code></pre></div><ul><li>Replicación local de la base de datos.</li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-bash data-lang=bash><span style=display:flex><span>serjaii@db:~$ curl -X POST -H <span style=color:#e6db74>&#34;Content-Type: application/json&#34;</span> -d <span style=color:#e6db74>&#39;{&#34;source&#34;:&#34;prueba1&#34;,&#34;target&#34;:&#34;prueba1_backup&#34;,&#34;create_target&#34;:true}&#39;</span> -u admin:miContraseña http://IP_DEL_SERVIDOR:5984/_replicate
</span></span></code></pre></div><ul><li>Creación de un usuario en CouchDB.</li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-bash data-lang=bash><span style=display:flex><span>serjaii@db:~$ curl -X POST -H <span style=color:#e6db74>&#34;Content-Type: application/json&#34;</span> -d <span style=color:#e6db74>&#39;{&#34;_id&#34;:&#34;org.couchdb.user:sergio&#34;,&#34;name&#34;:&#34;sergio&#34;,&#34;roles&#34;: [&#34;admin&#34;],&#34;type&#34;:&#34;user&#34;,&#34;password&#34;:&#34;sergio&#34;}&#39;</span> -u admin:admin http://192.168.122.79:5984/_users
</span></span></code></pre></div><ul><li>Asignación de permisos al usuario sobre la base de datos.</li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-bash data-lang=bash><span style=display:flex><span>serjaii@db:~$ curl -X PUT -H <span style=color:#e6db74>&#34;Content-Type: application/json&#34;</span> -d <span style=color:#e6db74>&#39;{&#34;admins&#34;:{&#34;names&#34;: [],&#34;roles&#34;: []},&#34;members&#34;:{&#34;names&#34;:[&#34;sergio&#34;],&#34;roles&#34;:[&#34;admin&#34;]}}&#39;</span> -u admin:miContraseña http://IP_DEL_SERVIDOR:5984/prueba1/_security
</span></span></code></pre></div><ul><li>Comprobación de que podemos acceder a la base de datos y ejecutar acciones
sobre la base de datos de prueba con el nuevo usuario.</li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-bash data-lang=bash><span style=display:flex><span>serjaii@db:~$ curl -u sergio:sergio http://192.168.122.79:5984/prueba1/_all_docs
</span></span></code></pre></div><h3 id=5-funcionamiento-interno-de-couchdb>5. Funcionamiento interno de CouchDB.</h3><p>Arquitectura.</p><ul><li><p>CouchDB está escrito en Erlang/OTP, usando la VM beam.smp.</p></li><li><p>Toda la comunicación es HTTP/REST, usando JSON como formato de
datos.</p></li><li><p>Cada documento tiene un _id único y un _rev (revisión), permitiendo
control de versiones y concurrencia.
Almacenamiento.</p></li><li><p>CouchDB usa B-trees append-only (copy-on-write).</p></li><li><p>Cada modificación crea un nuevo nodo en el B-tree, garantizando
lecturas consistentes sin bloqueos.
MVCC (Multi-Version Concurrency Control).</p></li><li><p>Cada documento tiene varias revisiones (_rev).</p></li><li><p>Permite lecturas concurrentes sin bloqueos y detecta conflictos de
escritura.</p></li><li><p>Los conflictos se resuelven por la aplicación, CouchDB mantiene ambas
versiones.
Replicación.</p></li><li><p>Modelo push/pull: CouchDB compara secuencias (_changes) y replica
solo diferencias.</p></li><li><p>Soporta replicación continua, ideal para bases distribuidas o offline-first.</p></li><li><p>Conflictos se detectan en el destino y la app decide cómo resolverlos.</p></li><li><p>Vistas MapReduce: índices persistentes para consultas predefinidas.</p></li><li><p>Mango: API JSON para consultas más amigables.</p></li><li><p>Sin índice, las consultas requieren full-scan de documentos.
Compaction y mantenimiento.</p></li><li><p>Debido al modelo append-only, los archivos crecen continuamente.</p></li><li><p>Se utiliza compactación periódica de DB y vistas para liberar espacio.</p></li></ul><p>Instalación de SQL Developer como cliente
remoto de ORACLE usando una conexión
TNS.</p><h3 id=1instalación-de-java-17>1.Instalación de Java 17</h3><p>SQL Developer requiere Java 17. Como Debian Trixie no lo tiene en sus repositorios
oficiales, lo instalaremos desde Adoptium:</p><ul><li>Instalamos las dependencias necesarias</li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-bash data-lang=bash><span style=display:flex><span>sudo apt install -y wget apt-transport-https gpg
</span></span></code></pre></div><ul><li>Añadir la clave GPG del repositorio de Adoptium</li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-bash data-lang=bash><span style=display:flex><span>serjaii@db:~$ wget -qO - https://packages.adoptium.net/artifactory/api/gpg/key/public | sudo gpg --dearmor -o /usr/share/keyrings/adoptium.gpg
</span></span></code></pre></div><ul><li>Añadir el repositorio</li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-bash data-lang=bash><span style=display:flex><span>serjaii@db:~$ echo <span style=color:#e6db74>&#34;deb [signed-by=/usr/share/keyrings/adoptium.gpg] https://packages.adoptium.net/artifactory/deb bookworm main&#34;</span> | sudo tee /etc/apt/sources.list.d/adoptium.list
</span></span></code></pre></div><ul><li>Actualizar e instalar Java 17</li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-bash data-lang=bash><span style=display:flex><span>sudo apt update
</span></span><span style=display:flex><span>sudo apt install -y temurin-17-jdk
</span></span></code></pre></div><ul><li>Verificar instalación</li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-bash data-lang=bash><span style=display:flex><span>java -version
</span></span></code></pre></div><h3 id=2descarga-sql-developer-desde-oracle>2.Descarga SQL Developer desde Oracle</h3><ul><li><p>Lo hacemos a través del siguiente enlace SQL Developer</p></li><li><p>Una vez descargada descomprimimos el .zip</p></li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-bash data-lang=bash><span style=display:flex><span>serjaii@db:~$ unzip sqldeveloper-24.3.1.347.1826-no-jre.zip
</span></span></code></pre></div><ul><li>Tendremos una carpeta con todos los archivos que hemos descomprimidos ,
ahora tenemos que darle permisos de ejecución a un .sh que hay en ese
directorio</li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-bash data-lang=bash><span style=display:flex><span>serjaii@db:~$ chmod +x sqldeveloper/sqldeveloper.sh
</span></span><span style=display:flex><span>serjaii@db:~$ ./sqldeveloper.sh
</span></span></code></pre></div><ul><li>Creamos el tnsnames.ora</li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-bash data-lang=bash><span style=display:flex><span>serjaii@db:~$ nano .oracle/tnsnames.ora
</span></span></code></pre></div><ul><li>En mi caso con el siguiente contenido dentro dependiendo de el hostname de el
servidor y la ip tendremos que hacer algún cambio</li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-bash data-lang=bash><span style=display:flex><span>ORCLCDB <span style=color:#f92672>=</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>(</span>DESCRIPTION <span style=color:#f92672>=</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>(</span>ADDRESS <span style=color:#f92672>=</span> <span style=color:#f92672>(</span>PROTOCOL <span style=color:#f92672>=</span> TCP<span style=color:#f92672>)(</span>HOST <span style=color:#f92672>=</span> 192.168.122.78<span style=color:#f92672>)(</span>PORT <span style=color:#f92672>=</span> 1521<span style=color:#f92672>))</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>(</span>CONNECT_DATA <span style=color:#f92672>=</span>
</span></span><span style=display:flex><span>      <span style=color:#f92672>(</span>SERVER <span style=color:#f92672>=</span> DEDICATED<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>      <span style=color:#f92672>(</span>SERVICE_NAME <span style=color:#f92672>=</span> ORCLCDB<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>)</span>
</span></span></code></pre></div><ul><li>Tendremos que introducir algunas variables de entorno de oracle dentro
de .bashrc</li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-bash data-lang=bash><span style=display:flex><span>serjaii@db:~$ nano ~/.bashrc 
</span></span><span style=display:flex><span>export ORACLE_HOME<span style=color:#f92672>=</span>$HOME/oracle/instantclient_21_19 
</span></span><span style=display:flex><span>export TNS_ADMIN<span style=color:#f92672>=</span>$HOME/.oracle 
</span></span><span style=display:flex><span>export PATH<span style=color:#f92672>=</span>$ORACLE_HOME:$PATH 
</span></span><span style=display:flex><span>export LD_LIBRARY_PATH<span style=color:#f92672>=</span>$ORACLE_HOME:$LD_LIBRARY_PATH 
</span></span><span style=display:flex><span>alias sqlplus<span style=color:#f92672>=</span><span style=color:#e6db74>&#39;rlwrap sqlplus&#39;</span>
</span></span></code></pre></div><ul><li><p>Algunas líneas ya las tenía yo en .bashrc por la conexión que hacemos de
normal en oracle la línea importante es :
export TNS_ADMIN=$HOME/.oracle</p></li><li><p>Aplicamos los cambios en bashrc y comprobamos que las variables se han
establecido correctamente</p></li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-bash data-lang=bash><span style=display:flex><span>echo $TNS_ADMIN
</span></span></code></pre></div><ul><li>Debe mostrar algo como lo siguiente</li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-bash data-lang=bash><span style=display:flex><span>serjaii@db:~$ echo $TNS_ADMIN /home/serjaii/SQL-Developer/.oracle
</span></span></code></pre></div><ul><li>Comprobamos también que tnsnames.ora es accesible</li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-bash data-lang=bash><span style=display:flex><span>serjaii@db:~$ cat $TNS_ADMIN/tnsnames.ora 
</span></span><span style=display:flex><span>ORCLCDB <span style=color:#f92672>=</span> 
</span></span><span style=display:flex><span><span style=color:#f92672>(</span>DESCRIPTION <span style=color:#f92672>=</span> 
</span></span><span style=display:flex><span>  <span style=color:#f92672>(</span>ADDRESS <span style=color:#f92672>=</span> <span style=color:#f92672>(</span>PROTOCOL <span style=color:#f92672>=</span> TCP<span style=color:#f92672>)(</span>HOST <span style=color:#f92672>=</span> 192.168.122.78<span style=color:#f92672>)(</span>PORT <span style=color:#f92672>=</span> 1521<span style=color:#f92672>))</span> 
</span></span><span style=display:flex><span>  <span style=color:#f92672>(</span>CONNECT_DATA <span style=color:#f92672>=</span> 
</span></span><span style=display:flex><span>    <span style=color:#f92672>(</span>SERVER <span style=color:#f92672>=</span> DEDICATED<span style=color:#f92672>)</span> 
</span></span><span style=display:flex><span>    <span style=color:#f92672>(</span>SERVICE_NAME <span style=color:#f92672>=</span> ORCLCDB<span style=color:#f92672>)</span> 
</span></span><span style=display:flex><span>  <span style=color:#f92672>)</span> 
</span></span><span style=display:flex><span><span style=color:#f92672>)</span>
</span></span></code></pre></div></section><footer class=article-footer><section class=article-tags><a href=/tags/oracle/>Oracle</a>
<a href=/tags/mysql/>Mysql</a>
<a href=/tags/postgresql/>Postgresql</a>
<a href=/tags/mongodb/>Mongodb</a>
<a href=/tags/neo4j/>Neo4j</a>
<a href=/tags/redis/>Redis</a>
<a href=/tags/cassandra/>Cassandra</a>
<a href=/tags/memcached/>Memcached</a>
<a href=/tags/couchdb/>Couchdb</a></section></footer><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/katex.min.css integrity=sha384-n8MVd4RsNIU0tAv4ct0nTaAbDJwPJzDEaqSD1odI+WdtXRGWt2kTvGFasHpSy3SV crossorigin=anonymous><script src=https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/katex.min.js integrity=sha384-XjKyOOlGwcjNTAIQHIpgOno0Hl1YQqzUOEleOLALmuqehneUG+vnGctmUb0ZY0l8 crossorigin=anonymous defer></script><script src=https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/contrib/auto-render.min.js integrity=sha384-+VBxd3r6XgURycqtZ117nYw44OOcIax56Z4dCRWbxyPt0Koah1uHoK0o4+/RRE05 crossorigin=anonymous defer></script><script>window.addEventListener("DOMContentLoaded",()=>{const e=[".main-article",".widget--toc"];e.forEach(e=>{const t=document.querySelector(e);t&&renderMathInElement(t,{delimiters:[{left:"$$",right:"$$",display:!0},{left:"$",right:"$",display:!1},{left:"\\(",right:"\\)",display:!1},{left:"\\[",right:"\\]",display:!0}],ignoredClasses:["gist"]})})})</script></article><aside class=related-content--wrapper><h2 class=section-title>Contenidos relacionados</h2><div class=related-content><div class="flex article-list--tile"><article class=has-image><a href=/post/interconexion-servidores-bd/><div class=article-image><img src=/post/interconexion-servidores-bd/cover.431f8fdc53739f4db48792e14604e42a_hu_94fbc8f10f59ef5.png width=250 height=150 loading=lazy alt="Featured image of post Interconexión de Servidores de Bases de Datos: Oracle y PostgreSQL" data-hash="md5-Qx+P3FNzn020h5LhRgTkKg=="></div><div class=article-details><h2 class=article-title>Interconexión de Servidores de Bases de Datos: Oracle y PostgreSQL</h2></div></a></article></div></div></aside><footer class=site-footer><section class=copyright>&copy;
2023 -
2026 SerjAii</section><section class=powerby>Creado con <a href=https://gohugo.io/ target=_blank rel=noopener>Hugo</a><br>Tema <b><a href=https://github.com/CaiJimmy/hugo-theme-stack target=_blank rel=noopener data-version=3.32.0>Stack</a></b> diseñado por <a href=https://jimmycai.com target=_blank rel=noopener>Jimmy</a></section></footer><div class=pswp tabindex=-1 role=dialog aria-hidden=true><div class=pswp__bg></div><div class=pswp__scroll-wrap><div class=pswp__container><div class=pswp__item></div><div class=pswp__item></div><div class=pswp__item></div></div><div class="pswp__ui pswp__ui--hidden"><div class=pswp__top-bar><div class=pswp__counter></div><button class="pswp__button pswp__button--close" title="Close (Esc)"></button>
<button class="pswp__button pswp__button--share" title=Share></button>
<button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>
<button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button><div class=pswp__preloader><div class=pswp__preloader__icn><div class=pswp__preloader__cut><div class=pswp__preloader__donut></div></div></div></div></div><div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap"><div class=pswp__share-tooltip></div></div><button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)">
</button>
<button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)"></button><div class=pswp__caption><div class=pswp__caption__center></div></div></div></div></div><script src=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.js integrity="sha256-ePwmChbbvXbsO02lbM3HoHbSHTHFAeChekF1xKJdleo=" crossorigin=anonymous defer></script><script src=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe-ui-default.min.js integrity="sha256-UKkzOn/w1mBxRmLLGrSeyB4e1xbrp4xylgAWb3M42pU=" crossorigin=anonymous defer></script><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/default-skin/default-skin.min.css crossorigin=anonymous><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.css crossorigin=anonymous></main></div><script src=https://cdn.jsdelivr.net/npm/node-vibrant@3.1.6/dist/vibrant.min.js integrity="sha256-awcR2jno4kI5X0zL8ex0vi2z+KMkF24hUW8WePSA9HM=" crossorigin=anonymous></script><script type=text/javascript src=/ts/main.c922af694cc257bf1ecc41c0dd7b0430f9114ec280ccf67cd2c6ad55f5316c4e.js defer></script><script>(function(){const e=document.createElement("link");e.href="https://fonts.googleapis.com/css2?family=Lato:wght@300;400;700&display=swap",e.type="text/css",e.rel="stylesheet",document.head.appendChild(e)})()</script></body></html>